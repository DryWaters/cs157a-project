FUZZY TRELLIS VECTOR QUANTIZATION OF IMAGES Tariq Haddad arid Abbas YonyaCoijlu School of Information Technology and Engincering University of Ottawa Ottawa Ontario KIN 6N5 Canada Fax I 613 562 5175 t,haddad@site uottawa ca ABSTRACT This paper introduces a new codebook search algorithni for trellis vect,or quantization systems TVQ The tlevcl opmerit of the iiew algorithm is based on the symbol-IVlAP c:hanncl decoding algorithni which is modified for data corri prc:ssion to deliver soft tlistort.iori-relatecl reliability infor mation Following a rat,e-tlistortioii theoretic approach the soft information is iiscd to derive a codehook search algo rithm that is capable 
of solving the problems associat,etl with the LBG algoritliin 221l\222he derived algorithm is fuzzy in the sense that it follows a soft associa.tion rule howrvcr it is tlcterrriinistic in 611c descent towards the global tiiiniriiiiin distortion point Altliougli t.he derivation is genrral t ti algoritlirn is test.cd using gray-scale irnagrs which pinvide ii nonco~ivex sqiiarc-rrror disbortion surface As shown in thc sirrnilation sect.ion tlie ricw algorithm providcs lowc energy codebooks  0.8 tlB gain while being significantly less scnsit.ive to initial codebooks using short traiiiiilg irringe scqiiences I INTRODUCTION It lias becri sliowri t.hat trcllis waveform coding pt~ovitlrs tiear 
theorct ical limit distort.ion-rate performance I 121 A t,rellis vector quarit.iztrt.ion 221L\222VQ system is characterizcd by tc rtiid~irie FSM dccotlcr ancl ii trcllis scarch PII coding algorit,lnn The chatniel outpiit scqiierice is fctl inlo thc FSM dec:otler wliich produces the corresponding iiitlcx of a reproduction cotlcwortl The FSM decotlcr is isctl to constriict the associated eiicotling trrllis whose 1 are colored by blit reproduction codewords The encoding process irivolves a search algorit hrri t,liat delivers the propcr cliaiincl inpiit scqiienccT which represrnts thc branc:h ill dices of the miniinurn distortion path iii the trellis The aut,liors 
iri 3 tlescrilx an efficicrit approach for 221rVQ sys tern design rising an LRG-t algorit.lirn to seixrch for an optirnal miniinurn tlist,ortiori part.it,iori However the LEG algorithm is ex trwiely sensit,ive to the initialixatioii pliasc which corit,rols the descent to a locally optimal cotifigiira tion Conscqiiently it is very likely that the rionconvex tlistort.ion surface which is wsociat,cd with irnagcs tricks a poorly iriitialiaetl LI<G algorit,hrn into selt,ling at a locally optiirial soliit,iori The limitations of Ilie LBG-algorithrn callctl for other global codehoolc scarch techriiqnes such as deterrriiriistic anricaling 141 0-7803-6293-4/00/$10.00 02000 IEEE 1883 yorigacogesi te uot t,;Lwa.ca One of t,he 
algorithms used with TVQ is the Viterbi al gorithm The function of tlit Vitrrlji algorithm in searching for t,he minirnuni distortion path is analogoiis to its func tion in delivering tlie most  transmitted sequence in channel dccotling In anticipation of producing an 1111 correlated arid uniforrnly dist~ri1 sequerice of symbols i e a reduridancy free secinerice the Viterhi algorithm is applied wit11 TVQ VTVQ considering indcpericlcnt and ident,ically dis1,ribiited trellis l~rarich indiccs Coriseq~ietitly given a source ontput scqiicric:e of vectors using ari algo rithrri that produces a scqucrice of rniriinium distortion syrn bols is cquivalcnt to using tlic Vitcrbi nlgorithm which pro tliices 
the miriirnurn tlist.ortiori scclueric:e Bascd 011 this fact wc introdiiccd in 5 arid GI it iicw TVQ search algorithrn wliicli represented bhe 223ni~tnral diiill\224 to syiiibol-bIAP trel lis clianirel clecodiiig The ncw scarch algoritlirri in 51 and 6 is I~asctl on t,he ciirly HC.IR aIgorit,hm introdiiced for channel tlecodirig in 7 2211\22211 algorithm performs tlecision dclayetl procrssirig i~ritl delivers for each time instant a set of reliability soft valiies t.liat ire usc:d to decitle on tlic rriinirniirn clistor-t,ion source rticodcr oiit,pt synibol Since the algorit,hm tlt:livers soft inlorrnat.ion in the form of tran sition protxibilitics this c~rirotliiig approach is 
cwllerl 223soft tre 11 is vec t,or qu an t i x at i 01 i 224  In this paper we c~xt,t:nd STVQ by using the rcliabil ity information wliic:h is ii protliict of this conipressiori ap j to provide a robnst I\221uzzy yet tlet,crrriiriist,ic procc tliire for tlit design of trcllis conil systems SI The fiizxy dcsigri approadi alleviates t,he problcrris associated with thc 1,lK ix1goritJriri whcri appIir\(1 t,o TVQ codebook design 221l\222hc dcriviition of the iicw fumy t.rellis search algo rit.1iin is coric:c~ptually t oil tlic tlrve1oprric:rit of the rate 
distortion t,heory and is similar to tlet,cmniiiistic arinralirig for data cliistc:ring in particular vector qna,ritization We will show t,hloitgli several sirrii11;ition c~xarriy iisirig gray i rnages t.lritt t,he iiew fiixzy design approach prodnces lower distort,iori c:orriigiirations while being sigriific:arit,ly less scn silive to initial coclcbooks 2 THE STVQ ALGORITHM In this sectiori we briefly t1tsc:ribc the soft cornpiwsion algo rithm S\221rVQ which is tlcrivctl in G 51 I on titi anal ogy drawn bctwecm a sonrce and a corriiriiinica1,ion chari nel Consider iisirig n labelctl-transitioir trtrllis associa.t,ed with a FSM-clc:cotler of constmitit Ierigth v and k-hit in 


piits Accordingly the TVQ is characterizcd by a trel lis that has M  2k\(v-1 states and 2k branches stern rning out of each state The branches are colored or la hied by the indices that address a reproduct,ion codebook Consider t,liat the outpiit vector of a stationary discrctc time source at time 72 is tlenot,ecl by Y  gnl yTL2    yn 221l\222he derivation of the STVC algorithrn is based on tlie fact t1ia.t we may consider the TVQ proce output of the channel defined by G 51 c  CO c2  Cl where IC  2\224 p\(YnI:cll 9  cxp{-$\(Yn ls 1 where q is a Lagrange multiplier and d\(Y z,lsn is the distortion between the source outpiit vector Y and the codeword associated with state sn and branch index zn lien givcn a source outpnt sequence Y we choose an c,ncotler output symbol according to 2 r zn  argrnaxpr x  il~;Y EA The forwartl-backward procedure described in 7 is iiscd to solvc for the set of probabilities Pr zlL  ilYIN i  0,1    I  1 and I  2k We proceed by defining the joint probability variable AR  r zTL  i srL  7r Y;\224 3 where srL  Tri is t,he encoder st3t.e at time n It follows that It is shown in S 51 that thc joint probability variable de fined in Eq 3 can he writtrn IS Aa\(m  in  Pk\(7n 5 whcre It can be shown that the forward variable is evaluated using I-1 1-0 where Si\(7 is the state at which we arrive if we go back wards from state s  m along the branch z7%-1  j Be sides t hat yk\(7n  exp{-qd\(Y z  ils  m 8 On the ot.her hand we can easily show t,hat the recur sion of t,he hacltwartl variable is givcn by 1-1 8:L-,\(7h c/~a\(\221~:\(7il s;\(?ii 7  N,N-l    O 2213 whcre S;\(h is thc state at which we arrivc if we go for wi~rd from st,atc sn-1  61 along the branch l  j The implementation approach arid the impact of the Lagrange multiplier 77 used in Eq 8 on the algorit.hrn\222s perfor mance is discussed in 5 61 3 FUZZY SOFT TRELLIS VECTOR QUANTIZATION In this section we use the development of the rate distor t,iori theory to cxtend the STVQ algorithm to provide an efficient and robust, fuzzy and detcrministic trellis codebook search approach We will demonstrate in this section that t,hc developed approach is capable of descending to lower distortion points while being highly insensitive to the ini tialization of Llie search process In 8 theorem 6.3.3 in particular Blahut parameterizes the rate distortion func tion R\(D in an equality rather than an inequality using a Lagrange multiplier n In that theorem the author shows that the optimal conditional distribution that achieves the rninimiim valiie of R\(D is 8 with an average distortion D where j and 1 arc used t,o index the input and reproduction alphabcts respectively QllJ is the conditional probability function between 1 and j and Q;,j is the distribution that achieves the point on the n\(D curve Besides that d,l is the distortion between symbols 1 and j pj is the input distribution while ql is the output distribution Theorem 6.3.3 in 8 is significant in the sense that it ciilminated into the famous Blahut\222s algorithm which com putes certain number of points on the rate distortion curve parameterized by the corresponding values of the Lagrange multiplicr K For a particular value of n E  m 01 Blahut\222s algorithm iteratively finds the best distribution of the re production alphabets q which along with QLlj defined in Rq 10 achieves a point on the rate distortion curve In ot.her words Blahlit algorithm characterizes the distribu tion of the optimal reproduction alphabets 41 as well as the transition probabilities QJ which control the encod ing rule for a given value of n We derrionst.rated in the previous section that the deriva lion of the STVQ algorithm is based on the association distribution given by Eq 1 and parameterized by the La grange multiplier  This distribution is clearly identical to the conditional distribution QllJ shown in Eq lo which leads to an optirnal rate-distortion point parameterized by K The two distributions are different in their consideration of the distribution of the output alphabet 41 While it is the goal to search for an optimal output alphabet distribu tion a in tlie development of the rate-distortion theory practical compression systems and the STVQ algorithm in particular adopt a uniform distribution to describe the reproduction alphabets This consideration reduces the de grecs of frecdoni in practical systems and allows for the exact computation of the output alphabets The other point of interest is t,he similarity between the parameters q and n where 7 in Eq 8 is equiva lent to K in Eq 10 It is more perceptive to interpret the independent Lagrange multiplier K as the slope of the tangent at the corresponding point on the rate-distort ion 1884 


curve Accordingly as K i m we approach thr low distortion high-ratc point,s of the R\(D curv while K  0 corresponds to the flat high-distortion low-rilte points of l.hc sanie iirve linlilte I3lahut algorithni which firids ii rate-distortion point given the intlepentlent parameter IC the TVQ problem irivolvrs encoding given a prespccified compression rate value Thcrefore the critical issuc with the STVQ algorit.hm is t,o find the opt.imal 7 given a con pression rate arid an anticipated average distortion value Experirnent.al results showed that t,he values of 7 control the conipiitational rate-distortion curve just like the valiies of IF contxol the theoretical rate-distortion curve 6 Now consider the general problem of data clustering Irrcspective of whether cliistming is rrgiilar or performed over a trellis the systrrn design criterion is to niinimize the average distortion jr sirice we are priictic:ally iritercstecl in tleliveririg a liartl IC cision thc c:ondit,ional distribrii,ion r[lj is defined as j E SI q   b Othc~rwise 13 wlierc Sl rcl the It,h rncotfiiig set I~\\irtlicrniorr sirice wc do riot iisuidly have access t,o the source tlist,ribii t.ion pJ stdiastic iLvcwging in Eq 12 is usually rrplaicetl by t,inie averaging IJnlikc tlic distortion masure tlcfincd in Eq 1 I which iiicludcs tlie soft coritlitional encoding rule QIl3 the practic:iil ineixsitre of E\(1 12 is based on n Iiard association rule TLI In ortlcr to fit i.hc noi.ion of STVQ wc rcclefiiit i.he dis tribittion q LS follows Eq 12 with Eq 14 we propose minimizing the follow ing distortion rneasurc in the process of searching for the optimal codebook  L 1 1 d\(K Cl 16 7L 1-0 NT where NT is the length of the training sequence It follows t,hat to minimize the distortion given by Eq 16 we set t8he gradient of D with respect to Cl to zero which for the squared error distortion produces the centroid update equations According to Eq 17 a source output vector Y con tributes a j of its value to the update of each reproduction cocleword C  Clearly this update equation provides the deterrniriistic relaxation sought for to help the LBG algorithm firids i.he global minimum configuration Eq 17 with the STVQ algorithm defines a new fuzzy search process we refer to as fuzzy-STVQ or FSTVQ The search process with i.lie FSTVQ algorithm is identical to that of the LBG algorithm with t,hc exception of using Eq I 7 and the proper 7-schethile instead of hard clustering 1 he process starts with relatively sniall values ol 7 that cor r\(:spond to very fuzzy association The I\(:vel of randoniness is reduced each time we iricrcrrient 11 towards the optimal TI It is worth rriciitioning that an update equation similar t,o the onc shown by Eq 17 is derived in 9 following a DA approach for the special ca.sc of a labeled-state trel lis coding system In t,liat brief paper the authors use a forward-backward algorit,hni to solve for a set of probabil it,ics similar to 1 1 in association with a dynamic pro gramming algoritlirri to search for the rriiriimurri distortion path r1 wii.11 At,\(~n tIefirird iii b;q 3 we show in e t,hat for n p;~ticuliir cornpression rat and expcctctl ilvt'rage distor tion thrrr is a propcr viihie TI in 1Sq 8 hlow which tlic S'rVC search process wii.li the I,nG iilgorithin corivcrgcs 1 o higher i~vcrage distortion valucs Ihcreforr onsidering that we arc tlc ndirig on tfic corriput.atiorial tiistori ion rate curve from high distortion valucs small 71 to t.hc tlistort,ioii corresponding to t.he opcrat,iorial rat.e at TT wc can pcrforni some sort of detcrmiriistic relaxation 1 rriinirriixing a soft avc~i~gc distortioii while iticrcniciitirig i.tie value of 7 lrorn sinall va1ric.s 1.0 q This intuitivc~ly sug using t,lic soft informai.ion T/J I which is dclivered by the S'IVQ algorithm and defined in Eq Is in place of the hard ixssociat,ion rule IT,~\(/IY of fSq 14 Accord ingly instead of iriinimiaing the average dist,ortion given by 4 PERFORMANCE EVALUATION rllis srctiori shows the advantage of the FSTVQ algorithm iii lie area of irriage conipression The new algorithm is c:oiripared with the I,BG idgorithm using both STVQ and Viterbi-based I'VQ V'.L'VL It is worth meiitionirig that hoth S'VVQ arid V-TVQ exhibit similar prrforrriance when applied to different sources 6 51 Several caSes are con sidered with different trellis stnictrires with a compression ratc of 0.0625 bit,/pixol bpp To show the advantage of FSTVQ wc use a rclativcly short training sequence of 2 irnages with i~ii cxtcrnal tcst image lo The training set consist,s of 256 x 256 gray images represented by bit pixels The test irnagc on thc ot,her hand is the 512 x 512 gray scalc Lema image The search for the optimal codebook is iritlcl,critlc~iitly repeatcd for 15 times each time with a tliffci~ent initial codebook choscii uniforinly at random from Compression at 0.0625 bpp is achieved using a trellis with k  1 and 4 x 4 image blocks producing a vector tiirrierisiori L  16 The performance measure is the peak signal to noise ratio PSNR defined as 0 2553 I885 


Table 1 The rate 0.0625 bpp PSNR coding performance in dB for the Lenna image using 2 training images I  Kenneth Rose 223Deterministic annealing for clust,er  ing, compression, classification, regression arid related E Wh\223O A optimization problems\224 Proceedings of the IEEE 111 x,da 221l\222ariq IIaddad and Abbas Yonga~oghi L\221El~zzy soft  i 1 86\(11 Nov 1998 0 where Yp is the highest intensity value used to represent a pixel and E{d\(Y,Y is the MSE between the original and the reconstructed image The results shown in Figs 1 and 2 clearly emphasize the advantage of FSTVQ in pro viding lower energy configurations while being significantly less sensitive to the initialization process The sensitivity to initial codebooks becomes more pronounced as the com plexity of the trellis structure increases as shown in Fig 2 Nonetheless the fluctuation in performance occiirs within smaller range at higher levels of PSNR as compared to the LBG-based algorithms The lowest distortion codebooks for each value of v which represent the best-case scenarios amongst the 15 trials are used to encode the Lenna im age The PSNR results arc shown in Table 1 wlierc we demonstrate the advantage of using FSTVQ for the tlif ferent constraint lengths Nonetheless the performance of the codebooks generated by the LBG algorithm would have been even worse had we considered higher clistortion cori figurations For example the highest distortion codebooks from Fig l\(b arc those associated with initial codebooks 7 3 and 3 for FSTVQ, VTVQ and STVQ respectively How ever the lowest distortion codebooks for VTVQ arid STVQ in Fig l\(b are those associated witah initial codcboolts 12 2 5 respectively 5 REFERENCES 7 L R Bahl J Cocke F Jelinek and J Raviv 223Op timal decoding of linear codes for minimizing symbol error rate\224 TEEE T7niisaclions on Information The ory IT-20\(2 Mar 1974 8 R E Blahut I\222rin,ciples and practice of infov\224ion tlieonj Addison-Wesley Massachusetts 1987 9 D Miller K Rose arid P Chu 223Determillistic annealing for trellis qiiantixater and HMM design us ing Haiim-Welch rc~-estiiriation\224  In ICASSP\22294 pages V261--V264 Adelaide Australia April 1994 lo P Westerink D Bockce J Biernontl and J Woods 223Subband coding of image using vector quantization\224 IEEE Transactions 071 Cornm~~nications 36\(6 719 June 1988 19 8 19.6 1 4 6 8 10 Initial codebook number D I 12 I _I 14 0 0 0 x P U 6 8 10 lnnial codebook number Figure 1 The ratc 0.0625 bpp PSNR coding performance in dH using 2 training images a v  3 h v  4 1886 


Besides we observed that the GST algorithm is less sensitive to the variance of the minimum support under the environments of more data, such as C10.T10.D6000 and C10.T5.D6000. Finally, we also found that the curves of all three algorithms become smooth for the lower minimum support under the environments of less data, such as C10.T2.D6000 and C5.T5.D6000. The reason is that the number of generated candidate sequences is always not beyond some threshold  0 2000 4000 6000 8000 15 12.5 0 5 5 minimum support ex ecu t i o n t i m e   s ec o n d  Apriori DSG GST Figure 7.\(a\ The environment C10.T10.D6000 0 1000 2000 3000 4000 5000 6000 15 12.5 10 7.5 5 minimum support ex ec u t i o n t i m e  s e c o n d  Apriori DSG GST Figure 7.\(b\ The environment C10.T5.D6000 0 200 400 600 800 1000 1200 1400 1600 1800 15 12.5 0 7.5 5 minimum support execution time \(second Apriori DSG GST Figure 7.\(c\ The environment C10.T2.D6000 0 500 1000 1500 2000 15 12.5 10 7.5 5 minimum support ex ecu t i o n t i m e   s e c o n d  Apriori DSG GST Figure 7.\(d\ The environment C5.T5.D6000 Experiment 2 In the experiment, we explore the scalability of the GST algorithm under different simulation environments as shown in Figure 8. Here the number of transactions is varied from 60000 to 350000 and the minimum support = 10%. When the number of transactions \(or the average number of items per transaction\reases, the execution time increases as well 0 100 200 300 400 500 600 700 6 0000 100000 125000 250000 350000 number of transactions execution time \(minute C 10.T 5 C 10.T 2 C5.T5 Figure 8. The scalability of the GST algorithm Experiment 3 In the experiment, we explore the execution time of the same GST algorithm under different scanning methods since the database was increased, as shown in Figure 9; i.e., scanning only new transactions and the entire database Here the experiment is under the environment C10.T5.D6000 and the minimum support = 5%. As shown in Figure 9.\(a\, the rates of the items purchased in the new transactions \(i.e., total items purchased in the new tran sactions over total items ever purchased in the original datab ase\re varied with 0%, 20 40%, 60%, 80%, and 100%. Here we found as long as the ratio is not close to 100%, scanning only new transactions is always much better than scanning the entire database. Besides, as shown in Figure 9.\(b\e rate of the items purchased in the new transactions is fixed at 50% and the growth rates of the transactions are varied with 25%, 50%, 75%, and 100%. We found that scanning only new transactions is still better than scanning the entire database Proceedings of the 27th Annual International Computer Software and Applications Conference \(COMPSAC\22203 0730-3157/03 $ 17.00 \251 2003 IEEE 


 0 200 400 600 800 0 20 40 0 80 100 s of purchased items execution time \(second the entire database new transactions Figure 9.\(a\ Postprocessing with the rates of purchased items 0 500 1000 1500 25 50 75 100 growth rates of transactions e x e c ut i on t i m e  s e c ond  e entire database sactions Figure 9.\(b\ Postprocessing with the growth rates of transactions 5. Conclusions and future works In the paper, we propose the GST algorithm to find sequential patterns from a transaction database. Through the experiments, we find that the GST algorithm is superior to the Apriori-like algorithms. The advantage of the GST algorithm over the Apriori-like algorithms is th at it can 1\generate large sequences without constructing candidate sequences and 2 generate large k sequences without following from large  k-1 quences step-by-step. Besides, we consider time constraints as well when finding sequential patterns, and this makes the found sequence patterns more useful. Finally, we also propose the method to fi nd new sequential patterns by scanning only new transactions since the database was increased, and compare it with the rough method of scanning the entire database In the GST algorithm, we search the IRG to find the large sequences rooted from each node. Since some redundant paths might be generated, the GST algorithm can be tried to avoid the sub-path generation when a path is found. Besides, in the future, we shall extend our algorithm to Web usage mining to mine the Web access logs [4 ich can b e  u s ed t o  pred ict user visit patterns and then help in targeting the advertisements at groups of users based on these patterns 6. References  R Agrawal and R. Srik ant, \215Fast algorithms f o r mining association rules,\216 Proc. 20 th International Conference on Very Large Data Bases, 1994, pp. 487-499  R. Agr a wal and  R. Srik ant, \215Mining sequen tial patterns,\216 Proc 11 th International Conference on Data Engineering, 1995, pp. 3-14  Ming-S y a n Chen Jong-Soo Park  and P  S Y u 215Ef f icien t d a ta  mining for path traversal patterns,\216 IEEE Transactions on Knowledge and Data Engineering, Vol. 10, No. 2, 1998, pp. 209-221  R. Cooley B  Mo basher and J  Srivastava, \215Grouping web p a ge references into transactions for mining world wide web browsing patterns,\216 Proc. IEEE Knowledge and Data Engineering Exchange Workshop, 1997, pp. 2-9  Jian-lin Feng and Y u cai Feng 215Binar y  par tition based  algorithms for mining association rules,\216 Proc. IEEE Forum on Research and Technology Advances in Digital Libraries, 1998, pp 30-34  Jia-W ei H a n, Ji an Pei and Y i W en Y i n, \215Mining frequen t  patterns without candidate generation,\216 Proc. ACM International Conference on Management of Data, 2000, pp. 1-12  Tzung-pei Hon g, Chan-Sheng  Kuo, and Shen g-chai Chi 215Mining fuzzy sequential patterns from quantitative data,\216 Proc IEEE International Conference on System, Man, and Cybernetics 1999, pp. 962-966  J. S. Park, M  S. C h en and P  S. Y u  215Using a hash-based method with transaction trimming for mining association rules,\216 IEEE ansactions on Knowledge and Data Engineering, Vol. 9, No. 5 1997, pp. 813-825  R Srik a nt and Y  Y a ng 215Mining web logs to improve website organization,\216 Proc. ACM World Wide Web 10, 2001, pp. 430-437  Suh-Y ing W ur and Y ung-ho Leus, \215An ef fective boo lean algorithm for mining association rules in large databases,\216 Proc. 6 th IEEE International Conference on Database Systems for Advanced Applications, 1999, pp. 179-186  Show-Jane Y e n and Arbee L. P  C h en, \215An ef fici en t approac h  for discovering knowledge from large databases,\216 Proc. 4 th IEEE International Conference on Parallel and Distributed Information Systems, 1996, pp. 8-18  M. J Zaki, \215Scalable algor ithm s for association m i n ing,\216 IEEE Transactions on Knowledge and Data Engineering, Vol. 12, No 3 2000, pp. 372-390 Proceedings of the 27th Annual International Computer Software and Applications Conference \(COMPSAC\22203 0730-3157/03 $ 17.00 \251 2003 IEEE 


pro cedure optConfNaiv e\(curSet curLo c 1 for i  curLo c to n do f 2 S  curSet f instArra y[i g 3 if sup S 025 minSup and conf S  conf optSet 4 optSet  S 5 if numI nst S k 6 optConfNaiv e\(S i 1 7 g Figure 1 Naiv e Alg for Optimized Con\014dence Set 4.2 Naiv e Algorithm Optimized Con\014dence Set W e b egin b y presen ting a naiv e algorithm for determining the optimized con\014dence set of instan tiations see Figure 1 In a n utshell the algorithm emplo ys depth 014rst se ar ch to en umerate all p ossible sets con taining k or less instantiations and returns the set with the maxim um con\014dence and supp ort at least mi nSup  The algorithm assumes that instan tiations are stored in the arra y instArra y  The n um b er of instantiations is n  n 1 003 n 2 003 001\001\001\003 n m  where n i is the n umber of v alues in the domain of A i  The algorithm is initially in v ok ed with argumen ts curSet   and curLo c=1 The v ariable optSet is used to k eep trac k of the optimized set of instan tiations encoun tered during the execution of the algorithm The algorithm en umerates all p ossible subsets of size k or less b y recursiv ely in v oking itself Step 6 and sets optSet to a set with a greater con\014dence than the curren t optimized set steps 3 and 4 Eac hin v o cation accepts as input curSet the set of instan tiations to b e further extended and curLo c the index of the 014rst instan tiation in instArra ytobe considered for extending curSet all instan tiations b et w een curLo c and n are considered The extended state is stored in S and if the n um b er of instan tiations in S is less than k  the algorithm calls itself recursiv ely to further extend S with instan tiations whose index is greater than the index of all the instan tiations in S The complexit y of the naiv e algorithm is 006 k i 1 nC i  When k 034 n  the complexit y of the algorithm b ecomes O  n k  Ho w ev er as w e sho w ed earlier if there is no restriction on the size of the optimized set that is k  n  the problem is NP-hard Optimized Supp ort Set The naiv e algorithm for computing the optimized supp ort set is similar to optConfNaiv e except that the condition in Step 3 whic h tries to maxim ize con\014dence is replaced with the follo wing condition if conf S 025 minCo nf and sup S  sup optSet 4.3 Pruning Using the Curren t Optimized Set The naiv e algorithm exhaustiv ely en umerates all p ossible sets with at most k instan tiations  this results in high complexit y Ho w ev er in the naiv e algorithm illustrated in Figure 1 if w e kno w that the con\014dence of an y set satisfying minim um supp ort and obtained as a result of extending curSet cannot exceed the con\014dence of the curren t optimized set that is optSet then w e can stop extending curSet immedia tely and reduce the searc h space signi\014can tly  In this section w e dev elop br anch and b ound pruning tec hniques that with the aid of the curren t optimized set considerably reduce the o v erhead of exploring the en tire searc h space F or our pruning tec hniques to b e e\013ectiv e it is imp erativ e that w e 014nd a set close to the optimized set early  since it can then b e used to eliminate a larger n um b er of sub-optimal sets It ma y seem logical that for the optimized con\014dence problem since w e are trying to maxim ize con\014dence considering instan tiations with high con\014dences 014rst ma y cause the searc h to conv erge on the optimized set more rapidly Ho w ev er this ma y not b e the case since the supp ort of the optimized con\014dence set has to b e at least minSup F or a high minim um supp ort it ma y b e b etter to explore instan tiations in the decreasing order of their supp orts Th us the order in whic h instan tiations m ust b e considered b y the searc h algorithm is a non-trivial problem In order to in v estigate this idea of pruning curSet early w e in tro duce the notion of the w eigh t of an instan tiation I denoted b y w  I  and de\014ne it b elo w w  I  w 1 003 conf  I  w 2 003 sup  I  In the de\014nition w 1 and w 2 are p ositiv e real constan ts Th us the w eigh t of an instan tiation is the w eigh ted sum of b oth its con\014dence and supp ort Our searc h algorithms can then consider instan tiations with higher w eigh ts 014rst and b y using di\013eren tv alues of w 1 and w 2 v ary the strategy for en umerating sets In the remainder of this section w e prop ose algorithms that store instan tiations in instArra y in the decreasing order of their w eigh ts and explore instan tiations with higher w eigh ts 014rst W e also presen t tec hniques that exploit the sort order of instan tiations to prune the searc h space The v ariables maxC onf and maxSup are used to store the maxim um con\014dence and maxim um supp ort of all the instan tiations in instArra y  resp ectiv ely  Optimized Con\014dence Set Supp ose the curren t set of instan tiations curSet is only extended with instan tiations b elonging to the set comprising of instArra y i  for some i  and instan tiations follo wing it in instArra y  The k ey idea is that w e can stop extending curSet if among instan tiations b eing considered to extend curSet there do es not exist a set of instan tiations S suc h that 1 sup curSet  S  025 minSup  and 2 conf curSet  S  025 conf optSet In order to determine whether a set S satisfying the ab o v e conditions 1 and 2 exists w e 014rst deriv e the constrain ts that suc h a set S m ust satisfy If the constrain ts are unsatis\014able with the remaining instan tiations that are candidates for extension a set S satisfying the conditions 1 and 2 do es not exist and w e can stop extending curSet immediately  Let v ariables s and c denote sup  S  and conf  S  resp ectiv ely  and l  k 000 numI nst curSet In the follo wing w e deriv e the constrain ts on s that m ust b e satis\014ed b yan y 


A tomic conditions can b e com bined using op erators  or _ to yield more complex conditions Instan tiated asso ciation rules that w e study in this pap er ha v e the form C 1  C 2  where C 1 and C 2 are arbitrary instan tiated conditions Let the supp ort for an instan tiated condition C  denoted b y sup  C  b e the ratio of the n um b er of tuples satisfying the condition C and the total n um b er of tuples in the relation Then for the asso ciation rule R  C 1  C 2  sup  R  is de\014ned as sup  C 1  and conf  R  is de\014ned as sup  C 1  C 2  sup  C 1   Note that our de\014nition of sup  R  is di\013eren t from the de\014nition in 1  where sup  R  as de\014ned to b e sup  C 1  C 2  Instead w eha v e adopted the de\014nition used in 5  and 4 Also let minSup and minConf denote the user-sp eci\014ed minim um supp ort and minim um con\014dence resp ectiv ely  The optimized asso ciation rule problem requires optimal instan tiations to b e computed for an uninstan tiated asso ciation rule whic h has the form U  C 1  C 2  where U is a conjunction of m uninstan tiated atomic conditions o v er m distinct attributes and C 1 and C 2 are arbitrary instan tiated conditions Let U i denote an instantiation of U th us U i is obtained b y replacing v ariables in U with v alues An instan tiation U i can b e mapp ed to a rectangle in m dimensional space  there is a dimension for eac h attribute and the co-ordinates for the rectangle in a dimension are iden tical to the v alues for the corresp onding attribute in U i Tw o instan tiations U 1 and U 2 are said to b e non-overlapping if the t w o m dimensional rectangles de\014ned b y them do not o v erlap that is the in tersection of the t w o rectangles is empt y Ha ving de\014ned the ab o v e notation for asso ciation rules w e presen t b elo w the form ulations of the optimized asso ciation rule problems 017 Optimized Con\014dence Problem Giv en k and an uninstan tiated rule U  C 1  C 2  determine non-o v erlapping instan tiations U 1 U l of U with l 024 k suc h that sup  R  025 minSup and conf  R  is maximi zed  where R is the rule  U 1 _ 001\001\001 _ U l   C 1  C 2  017 Optimized Supp ort Problem Giv en k and an uninstan tiated rule U  C 1  C 2  determine non-o v erlapping instan tiations U 1 U l of U with l 024 k suc h that conf  R  025 minConf and sup  R  is maxim ized  where R is the rule  U 1 _ 001\001\001 _ U l   C 1  C 2  The problem of computing optimized asso ciation rules required instan tiations U 1 U l to b e determined suc h that the rule R  U 1 _\001\001\001_ U l   C 1  C 2 satis\014es user-sp eci\014ed constrain ts Supp ose for an instan tiation U i of U  I i is the instan tiated rule U i  C 1  C 2  and for a set S  f I 1 I j g of instan tiated rules sup  S  and conf  S  are de\014ned as follo ws sup  S   sup  I 1  001\001\001  sup  I j  conf  S   sup  I 1  001 conf  I 1  001\001\001  sup  I j  001 conf  I j  sup  I 1  001\001\001  sup  I j  Then w eha v e sup  S  sup  R  and conf  S  conf  R  Th us since 1 for ev ery instan tiated rule or alternativ ely  instan tiation I i  sup  I i  and conf  I i  can b e computed b y p erforming a single pass o v er the relation and 2 these in turn can b e used to compute supp orts and con\014dences for sets of instan tiations the optimized asso ciation rule problem reduces to the follo wing 017 Optimized Con\014dence Problem Giv en k  and sup  I i  and conf  I i  for ev ery instantiation I i  determine a set S con taining at most k non-o v erlapping instan tiations suc h that sup  S  025 minSup and conf  S  is maxim ized 017 Optimized Supp ort Problem Giv en k  and sup  I i  and conf  I i  for ev ery instan tiation I i  determine a set S con taining at most k nono v erlapping instan tiations suc h that conf  S  025 minConf and sup  S  is maximi zed In the remainder of the pap er w e use the ab o v e form ulations instead to dev elop algorithms for the optimized asso ciation rule problems 4 Categorical A ttributes In this section w e presen t algorithms for computing optimized supp ort and con\014dence sets when rules con tain only uninstan tiated conditions of the form A i  v  Th us the results of this section are only applicable to categorical attributes and n umeric attributes restricted to A i  v 1 conditions of the form A i 2  l i u i  where A i is a n umeric attribute are dealt with in the next section An example of suc h a rule is  date  v   src cit y  NY  dst country  F rance in the rule date isan umeric attribute while src cit y is categorical Due to the ab o v e restriction an yt w o arbitrary instan tiations are alw a ys non-o v erlapping This prop ert y is essen tial for the correctness of the pruning tec hnique used b y the graph searc h algorithm presen ted in Section 4.4 4.1 NP-Hardness Result The problem of computing optimized sets giv en sup  I i  and conf  I i  for ev ery instan tiation I i  can b e sho wn to b e in tractable and follo ws from the follo wing theorem Theorem 4.1  Given sup  I i  and conf  I i  for every instantiation I i  determining if ther eisa set S c ontaining an arbitr ary numb er of instantiations such that conf  S  025 mi nConf and sup  S  025 minSup is NP-har d In the follo wing subsections w e presen tsc hemes for computing optimized sets that emplo y tec hniques for pruning the searc h space in order to o v ercome the complexit y of the problem In eac h subsection w e 014rst presen t the sc heme for computing optimized con\014dence sets and then brie\015y describ e the mo di\014cations to the sc heme in order to compute optimized supp ort sets 1 Note that if the domain of the n umeric attribute A i is large then it can b e partitioned in to a sequence of n i in terv als and successiv ein terv als can b e mapp ed to consecutiv ein tegers in the in terv al b et w een 1 and n i  


a minim um supp ort of 0.03 the optimized con\014dence rule results in the p erio d for whic h calls from NY in the p erio d are at least 3 of the total n um b er of calls and the p ercen tage of calls from NY that are directed to F rance is maxim um  With a minim um con\014dence of 0.5 the optimized supp ort rule results in the p erio d during whic h at least 50 of the calls from NY are to F rance  and the n um b er of calls originating in NY is maxim um  A limitatio n of the optimized asso ciation rules dealt with in is that only a single optimal in terv al for a single n umeric attribute can b e determined Ho wev er in a n um b er of applications a single in terv al ma y b e an inadequate description of lo cal trends in the underlying data F or example supp ose the telecom service pro vider is in terested in doing upto k promotions for customers in NY calling F rance F or this purp ose w e need a mec hanism to iden tify upto k p erio ds during whic h a sizable n um b er of calls from NY to F rance are made If asso ciation rules w ere p ermitted to con tain disjunctions of uninstan tiated conditions then w e could determine the optimal k or few er p erio ds b y 014nding optimal instan tiations for the rule  date 2  l 1 u 1  _\001\001\001 _  date 2  l k u k   src cit y  NY  dst country  F rance  The ab o v e framew ork can b e further strengthened b y enric hing asso ciation rules to con tain more than one uninstan tiated attribute and p ermitting attributes to b e b oth n umeric e.g date and duration sw ell as categorical e.g src cit y  dst country  Th us optimal instan tiations for the rule  src cit y  v 1  date 2  l 1 u 1  _ 001\001\001 _  src cit y  v k  date 2  l k u k   dst country  F rance w ould yield v aluable information ab out cities and p erio ds with a fairly high out w ard call v olume a substan tial p ortion of whic h is directed to F rance  Alternately  information ab out cities and sp e ci\014c dates can b e obtained from the rule  src cit y  v 1  date  u 1  _ 001\001\001 _  src cit y  v k  date  u k   dst country  F rance  This information can b e used b y the telecom service pro vider to determine the most suitable geographical regions and dates for o\013ering discoun ts on in ternational long distance calls to F rance  In this pap er w e generalize the optimized asso ciation rules problem describ ed in 5  in three w a ys{1 asso ciation rules are p ermitted to con tain disjunctions o v er uninstan tiated attributes 2 asso ciation rules are allo w ed to con tain an arbitrary n um b er of uninstan tiated attributes and 3 uninstan tiated attributes can b e either categorical or n umeric W e 014rst sho w that the problem of computing optimized supp ort and optimized con\014dence asso ciation rules in our framew ork is NP-hard W e then presen t a general depth 014rst se ar ch algorithm for exploring the searc h space The algorithm searc hes through the space of instan tiated rules in the decreasing order of the w eigh ted sums of their con\014dences and supp orts and uses br anch and b ound tec hniques to prune the searc h space e\013ectiv ely F or categorical attributes w e also presen ta gr aph se ar ch algorithm that in addition uses in termediate results to reduce the searc h Finally  for n umeric attributes w e dev elop tec hniques to eliminate certain instan tiated rules prior to searc hing through them Exp erimental results indicate that our sc hemes p erform w ell for a large n um b er of uninstan tiated attributes disjunctions and v alues in the domain of the uninstan tiated attributes Pro ofs of theorems presen ted in the pap er can b e found in 9  2 Related W ork Asso ciation rules for a set of transactions in whic h eac h transaction is a set of items b ough tb y a customer w ere 014rst studied in 1  These asso ciation rules for sales transaction data ha v e the form X  Y  where X and Y are disjoin t sets of items E\016cien t algorithms for computing them can b e found in 2 7  6 10 11 In 10 6  the generalization of asso ciation rules to m ultiple lev els of taxonomies o v er items is studied Asso ciation rules con taining quantitative and c ate goric al attributes are studied in and 11  The w ork in 8  restricts asso ciation rules to b e of the form A 1  v 1  A 2  v 2 only  They suggest w a ys to extend their framew ork to ha v e a range that is A 1 2  l 1 u 1  rather than a single v alue in the left hand side of a rule T oac hiev e this they partition n umeric attributes in to in terv als Ho w ev er they do not consider merging neigh b oring in terv als to generate a larger in terv al In 11  the authors use a p artial c ompleteness measure in order to determine the partitioning of n umeric attributes in to in terv als The optimized asso ciation rule problem w as in troduced in 5  The authors p ermit asso ciation rules to con tain a single uninstan tiated condition A 1 2  l 1 u 1  on the left hand side and prop ose sc hemes to determine v alues for v ariables l 1 and u 1 suc h that the con\014dence or supp ort of the rule is maximi zed In the authors extend the results in 5  t o the case in whic h rules con tain t w o uninstan tiated n umeric attributes on the left hand side They prop ose algorithms that disco v er optimized gain supp ort and con\014dence asso ciation rules for t w o classes of regions  rectangles and admissible regions for admissible regions the algorithms compute appro ximate not optimized supp ort and con\014dence rules Ho w ev er their sc hemes only compute a single optimal region In con trast our algorithms are general enough to handle more than t w o uninstan tiated attributes whic h could b e either categorical or n umeric F urthermore our algorithms can generate an optimal set of rectangles rather than just a single optimal rectangle note that w e do not consider admissible regions or the notion of gain in this pap er This enables us to 014nd more in teresting patterns 3 Preliminaries In this section w e de\014ne the optimized asso ciation rule problem addressed in the pap er The data is assumed to b e stored in a relation de\014ned o v er categorical and n umeric attributes Asso ciation rules are built from atomic conditions eac h of whic h has the form A i  v i  A i could b e either categorical or n umeric and A i 2  l i u i  only if A i is n umeric F or the atomic condition A i  v i if v i isav alue from the domain of A i  the condition is referred to as instantiate d  else if v i isav ariable w e refer to the condition as uninstantiate d  Lik ewise the condition A i 2  l i u i  s referred to as instan tiated or uninstan tiated dep ending on whether l i and u i are v alues or v ariables 


Mining Optimize d Asso ciation Rules with Categorical and Numeric A ttributes Ra jeev Rastogi Kyuseok Shim Bell Lab oratories Bell Lab oratories Murra y Hill NJ 07974 Murra y Hill NJ 07974 rastogi@researc h.b ell-labs.com shim@researc h.b ell-labs.com Abstract Asso ciation rules ar e useful for determining c orr elations b etwe en attributes of a r elation and have applic ations in marketing 014nancial and r etail se ctors F urthermor e optimized asso ciation rules ar e an e\013e ctive way to fo cus on the most inter esting char acteristics involving c ertain attributes Optimize d asso ciation rules ar ep ermitte dto c ontain uninstantiate d attributes and the pr oblem is to determine instantiations such that either the supp ort or c on\014denc e of the rule is maximize d In this p ap er we gener alize the optimize d asso ciation rules pr oblem in thr e e ways  1 asso ciation rules ar e al lowe dtoc ontain disjunctions over uninstantiate d attributes 2 asso ciation rules ar ep ermitte dtoc ontain an arbitr ary numb er of uninstantiate d attributes and 3 uninstantiate d attributes c an b e either c ate goric al or numeric Our gener alize d asso ciation rules enable us to extr act mor e useful information ab out se asonal and lo c al p atterns involving multiple attributes We pr esent e\013e ctive te chniques for pruning the se ar ch sp ac e when c omputing optimize d asso ciation rules for b oth c ate goric al and numeric attributes Final ly we r ep ort the r esults of our exp eriments that indic ate that our pruning algorithms ar e e\016cient for a lar ge numb er of uninstantiate d attributes disjunctions and values in the domain of the attributes 1 In tro duction Asso ciation rules in tro duced in 1  pro vide a useful mec hanism for disco v ering correlations among the underlying data In its most general form an asso ciation rule can b e view ed as b eing de\014ned o v er attributes of a relation and has the form C 1  C 2  where C 1 and C 2 are conjunctions of conditions and eac h condition is either A i  v i or A i 2  l i u i  v i  l i and u i are v alues from the domain of the attribute A i  Eac h rule has an asso ciated supp ort and c on\014denc e  Let the supp ort of a condition C i b e the ratio of the n um b er of tuples satisfying C i and the n um b er of tuples in the relation The supp ort of a rule of the form C 1  C 2 is then the same as the supp ort of C 1  C 2  while its con\014dence is the ratio of the supp orts of conditions C 1  C 2 and C 1  The asso ciation rules problem is that of computing all asso ciation rules that satisfy user-sp eci\014ed minim um supp ort and minim um con\014dence constrain ts and sc hemes for this can b e found in 1  2 6 10 11  F or example consider a relation in a telecom service pro vider database that con tains call detail information The attributes of the relation are date  time  src cit y  src country  dst cit y  dst country and duration  A single tuple in the relation th us captures information ab out the t w o endp oin ts of eac h call as w ell as the temp oral elemen ts of the call The asso ciation rule  src cit y  NY    dst country  F rance  ould satisfy the user-sp eci\014ed minim um supp ort and minim um con\014dence of 0.05 and 0.3 resp ectiv ely  if at least 5 of total calls are from NY to F rance  and at least 30 of the calls that originated from NY are to F rance  The optimize d asso ciation rules problem motiv ated b y applications in mark eting and adv ertising w as intro duced in 5  An asso ciation rule R has the form  A 1 2  l 1 u 1   C 1  C 2  where A 1 is a n umeric attribute l 1 and u 1 are uninstan tiated v ariables and C 1 and C 2 con tain only instan tiated conditions that is the conditions do not con tain uninstan tiated v ariables The authors prop ose algorithms for determining v alues for the uninstan tiated v ariables l 1 and u 1 for eac h of the follo wing cases 017 Con\014dence of R is maxim ized and supp ort of the condition  A 1 2  l 1 u 1   C 1 is at least the usersp eci\014ed supp ort referred to as the optimize dc on\014denc e rule 017 Supp ort of the condition  A 1 2  l 1 u 1   C 1 is maximi zed and con\014dence of R is at least the usersp eci\014ed con\014dence referred to as the optimize d supp ort rule Optimized asso ciation rules are useful for unra v eling ranges for n umeric attributes where certain trends or correlations are strong that is ha v e high supp ort or con\014dence F or example supp ose the telecom service pro vider men tioned earlier w as in terested in offering a promotion to NY customers who mak e calls to F rance  In this case the timing of the promotion ma y b e critical  for its success it w ould b e adv an tageous to o\013er it close to a p erio d of consecutiv eda ys in whic h at least a certain minim um n um b er of calls from NY are made and the p ercen tage of calls from NY to F rance is maxim um  The framew ork dev elop ed in 5  can b e used to determine suc h p erio ds Consider for example the asso ciation rule  date 2  l 1 u 1   src cit y  NY  dst country  F rance  With 


It can also be added to cell CrossSales.3\(PC, printer one_year,\205 5  Distributed and Incremental Rule Mining There exist two ways to deal with association rules 267  Static that is, to extract a group of rules from a snapshot, or a history, of data and use "as is 267  Dynamic that is, to evolve rules from time to time using newly available data We mine association rules from an e-commerce data warehouse holding transaction data. The data flows in continuously and is processed daily Mining association rules dynamically has the following benefits 267  223Real-time\224 data mining, that is, the rules are drawn from the latest transactions for reflecting the current commercial trends 267  Multilevel knowledge abstraction, which requires summarizing multiple partial results. For example association rules on the month or year basis cannot be concluded from daily mining results. In fact multilevel mining is incremental in nature 267  For scalability, incremental and distributed mining has become a practical choice Figure 3: Distributed rule mining Incremental association rule mining requires combining partial results. It is easy to see that the confidence and support of multiple rules may not be combined directly. This is why we treat them as \223views\224 and only maintain the association cube, the population cube and the base cube that can be updated from each new copy of volume cube. Below, we discuss several cases to show how a GDOS can mine association rules by incorporating the partial results computed at LDOSs 267  The first case is to sum up volume-cubes generated at multiple LDOSs. Let C v,i be the volume-cube generated at LDOS i The volume-cube generated at the GDOS by combining the volume-cubes fed from these LDOSs is 345   n i i v v C C 1  The association rules are then generated at the GDOS from the centralized C v  214  The second case is to mine local rules with distinct bases at participating LDOSs, resulting in a local association cube C a,I a local population cube C p,I  and a local base cube C b,i at each LDOS. At the GDOS, multiple association cubes, population cubes and base cubes sent from the LDOSs are simply combined, resulting in a summarized association cube and a summarized population cube, as 345   n i i a a C C 1   345   n i i p p C C 1  and 345   n i i b b C C 1  The corresponding confidence cube and support cube can then be derived as described earlier. Cross-sale association rules generated from distinct customers belong to this case In general, it is inappropriate to directly combine association cubes that cover areas a 1 205, a k to cover a larger area a In the given example, this is because association cubes record counts of customers that satisfy   customer product merchant time area Doe TV Dept Store 98Q1 California Doe VCR Dept Store 98Q1 California customer product merchant time area Doe VCR Sears 5-Feb-98 San Francisco Joe PC OfficeMax 7-Feb-98 San Francisco customer product merchant time area Doe TV Fry's 3-Jan-98 San Jose Smith Radio Kmart 14-Jan-98 San Jose Association   population      base          confidence      support cube               cube                cube         cube                cube LDOS LDOS GDOS 


the association condition, and the sets of customers contained in a 1 205, a k are not mutually disjoint. This can be seen in the following examples 214  A customer who bought A and B in both San Jose and San Francisco which are covered by different LDOSs , contributes a count to the rule covering each city, but has only one count, not two, for the rule A  336  B covering California 214  A customer \(e.g. Doe in Figure 3\who bought a TV in San Jose, but a VCR in San Francisco, is not countable for the cross-sale association rule TV  336 VCR covering any of these cities, but countable for the rule covering California. This is illustrated in Figure 3 6  Conclusions In order to scale-up association rule mining in ecommerce, we have developed a distributed and cooperative data-warehouse/OLAP infrastructure. This infrastructure allows us to generate association rules with enhanced expressive power, by combining information of discrete commercial activities from different geographic areas, different merchants and over different time periods. In this paper we have introduced scoped association rules  association rules with conjoint items and functional association rules as useful extensions to association rules The proposed infrastructure has been designed and prototyped at HP Labs to support business intelligence applications in e-commerce. Our preliminary results validate the scalability and maintainability of this infrastructure, and the power of the enhanced multilevel and multidimensional association rules. In this paper we did not discuss privacy control in customer profiling However, we did address this issue in our design by incorporating support for the P3P protocol [1 i n  ou r data warehouse. We plan to integrate this framework with a commercial e-commerce system References 1  Sameet Agarwal, Rakesh Agrawal, Prasad Deshpande Ashish Gupta, Jeffrey F. Naughton, Raghu Ramakrishnan, Sunita Sarawagi, "On the Computation of Multidimensional Aggregates", 506-521, Proc. VLDB'96 1996 2  Surajit Chaudhuri and Umesh Dayal, \223An Overview of Data Warehousing and OLAP Technology\224, SIGMOD Record Vol \(26\ No \(1\ 1996 3  Qiming Chen, Umesh Dayal, Meichun Hsu 223 OLAPbased Scalable Profiling of Customer Behavior\224, Proc. Of 1 st International Conference on Data Warehousing and Knowledge Discovery \(DAWAK99\, 1999, Italy 4  Hector Garcia-Molina, Wilburt Labio, Jun Yang Expiring Data in a Warehouse", Proc. VLDB'98, 1998 5  J. Han, S. Chee, and J. Y. Chiang, "Issues for On-Line Analytical Mining of Data Warehouses", SIGMOD'98 Workshop on Research Issues on Data Mining and Knowledge Discovery \(DMKD'98\ , USA, 1998 6  J. Han, "OLAP Mining: An Integration of OLAP with Data Mining", Proc. IFIP Conference on Data Semantics DS-7\, Switzerland, 1997 7  Raymond T. Ng, Laks V.S. Lakshmanan, Jiawei Han Alex Pang, "Exploratory Mining and Pruning Optimizations of Constrained Associations Rules", Proc ACM-SIGMOD'98, 1998 8  Torben Bach Pedersen, Christian S. Jensen Multidimensional Data Modeling for Complex Data Proc. ICDE'99, 1999 9  Sunita Sarawagi, Shiby Thomas, Rakesh Agrawal Integrating Association Rule Mining with Relational Database Systems: Alternatives and Implications", Proc ACM-SIGMOD'98, 1998   Hannu Toivonen, "Sampling Large Databases for Association Rules", 134-145, Proc. VLDB'96, 1996   Dick Tsur, Jeffrey D. Ullman, Serge Abiteboul, Chris Clifton, Rajeev Motwani, Svetlozar Nestorov, Arnon Rosenthal, "Query Flocks: A Generalization of Association-Rule Mining" Proc. ACM-SIGMOD'98 1998   P3P Architecture Working Group, \223General Overview of the P3P Architecture\224, P3P-arch-971022 http://www.w3.org/TR/WD-P3P.arch.html 1997 


Plenary Panel Session 30 XML Databases   Moderator: Michael Carey, IBM Almaden Research Center USA Panelists Adam Bosworth, Microsoft Corporation USA David De Witt University of Wisconsin-Madison, USA Alon Levy University of Washington USA Bruce Lindsay IBM Almaden Research Center USA Jennifer Widom Stanford University USA Demo Session 1 Web Query Optimizer  661 V Zadorozhny L Bright L Raschid T Urhan and M Vidal ReQueSS: Relational Querying of Semi-structured Data  664 R Sunderraman The IDEAL Approach to Internet-Based Negotiation for E-Business  666 J Hammer C Huang Y Huang C Pluempitiwiriyawej M Lee H Li L Wang Y Liu and S Su READY A High Performance Event Notification Service  668 R Gruber B Krishnamurthy, and E Panagos A Multimedia Information Server with Mixed Workload Scheduling  670 G Nerjes DISIMA An Object-Oriented Approach to Developing an Image Database System  672 V Oria T Ozsu P Iglinski B Xu and L Cheng Demo Session 2 The Collaboration Management Infrastructure  677 H Schuster D Baker A Cichocki D Georgakopoulos and M Rusinkiewicz Assisting the Integration of Taxonomic Data The LITCHI Toolkit  679 I Sutherland J Robinson S Brandt A Jones S Embury W Gray R White and F Bisby TheaterLoc: Using Information Integration Technology to Rapidly Build Virtual Applications  681 G. Barish Y.4 Chen D Dipasquo, C Knoblock S Minton I Muslea and C Shahabi Lineage Tracing in a Data Warehousing System  683 Y Cui and J Widom xiii 


The Mentor-Lite Prototype A Light-Weight Workflow Management System  685 J Weissenfels M Gillmann 0 Roth, G Shegalov and W Wonner Location Prediction and Queries for Tracking Moving Objects  687 0 Wolfson B Xu and S Chamberlain Semiorder Database for Complex Activity Recognition in Multi-Sensory Environments  689 S Bhonsle A Gupta S Santini and R Jain Tutorial 1 Web Information Retrieval  693 M Henzinger Tutorial 2 Mobile and Wireless Database Access for Pervasive Computing  694 P Chrysanthis and E Pitoura Tutorial 3 Data Mining with Decision Trees  696 J Gehrke Tutorial 4 Directories Managing Data for Networked Applications  697 D Srivastava Tutorial 5 Indexing High-Dimensional Spaces Database Support for Next Decade\222s Applications  698 S Berchtold and D Keim xiv 


 T5.I2.D100K T10.I4.D100K T15.I4.D100K T10.I6.D400K T10.I6.D800K T10.I6.D1600K Optimizations across Databases 5 0 5 10 15 20 25 30 35 40 45 Improvement COMP TREE COMP-TREE 1 2 4 8 1 2 4 8 1 2 4 8 2 4 8 2 4 8 1 2 4 8 Processors Databases Figure 5 Effect of Computation and Hash Tree Balancing good as the COMP optimization The reason that the hash tree balancing is not suf\336cient to offset inherent load imbalance in the candidate generation in this case The most effective approach is to apply both optimizations at the same time COMP-TREE The combined effect is suf\336cient to push the improvements in the 40 range in the multiple-processor case On 1 processor only hash tree balancing is bene\336cial since computation balancing only adds extra cost 5.4 Short-circuited Subset Checking Figure 6 shows the improvement due to the short-circuited subset checking optimization with respect to the unoptimized version The unoptimized version is the Apriori algorithm due to Agrawal et al 5 The results are presented for dif ferent number of processors across dif ferent databases The results indicate that while there is some improvement for databases with small transaction sizes the optimization is most effective when the transaction size is large In this case we get improvements of around 25 r the unoptimized version To gain further insight into this optimization consider 336gure 7 It shows the percentage improvement obtained per iteration on applying this optimization on the T20.I6.D100K database It shows results only for the uni-processor case r similar results were obtained on more processors We observe that as the iteration k increases there is more opportunity for shortcircuiting the subset checking and we get increasing bene\336ts of up to 60 The improvements start to fall off t the high end where the number of candidates becomes small resulting in a small hash tree and less opportunity for short-circuiting It becomes clear that is an extremely effective 15 Proceedings of the 1996 ACM/IEEE Conference on Supercomputing \(SC\22296 0-89791-854-1/96 $ 10.00 ACM 


 T5.I2.D100K T10.I6.D800K T15.I4.D100K T20.I6.D100K procs across Databases 0 5 10 15 20 25 Improvement 1 2 4 8 Figure 6 Effect of Short-circuited Subset Checking 23456789101112 Iterations 0 10 20 30 40 50 60 improvement T20.I6.D100K Figure 7  Improvement per Iteration  proc   16 Proceedings of the 1996 ACM/IEEE Conference on Supercomputing \(SC\22296 0-89791-854-1/96 $ 10.00 ACM 


optimization for larger transaction sizes and in cases where there are large number of candidate k itemsets 6 Conclusions In this paper e presented a parallel implementation of the Apriori algorithm on the SGI Power Challenge shared memory multi-processor We also discussed a set of optimizations which include optimized join and pruning computation balancing for candidate generation hash tree balancing and short-circuited subset checking We then presented experimental results on each of these Improvements of more than 40 were obtained for the computation and hash tree balancing The short-circuiting optimization was found to be extremely effective for databases with large transaction sizes Finally we reported the parallel performance of the algorithm While we d good speed-up we observed a need for parallel I/O techniques for further performance gains References  R Agra wal T  Imielinski and A Swami Database mining A performance perspecti v e  I n IEEE Trans on Knowledge and Data Engg  pages 5\(6 1993  R Agra wal T  Imielinski and A Swami Mining association rules between sets of items in lar ge databases In Proc M SIGMOD Intl Conf Management of Data  May 1993  R Agra wal H Mannila R Srikant H T o i v onen and A I V erkamo F ast disco v ery of association rules In U F et al editor Advances in Knowledge Discovery and Data Mining  MIT Press 1996  R Agra wal and J Shafer  P arallel mining of association rules design implementation and e xperience Technical Report RJ10004 IBM Almaden Research Center San Jose CA 95120 Jan 1996  R Agra wal and R Srikant F ast algorithms for mining association rules In Proc 20th VLDB Conf  Sept 1994  M Cierniak W  Li and M J Zaki Loop scheduling for heterogeneity  I n 4th IEEE Intl Symposium on High-Performance Distributed Computing also as URCS-TR 540 CS Dept Univ f Rochester  Aug 1995  M Holsheimer  M  K ersten H Mannila and H T o i v onen A perspecti v e on databases and data mining In 1st Intl Conf Knowledge Discovery and Data Mining  Aug 1995  M Houtsma and A Swami Set-oriented mining of association rules In RJ 9567  IBM Almaden Oct 1993  H Mannila H T o i v onen and I V erkamo Ef 336cient algorithms for disco v ering association rules In AAAI Wkshp Knowledge Discovery in Databases  July 1994  J S P ark M Chen and P  S Y u  A n e f fecti v e hash based algorithm for mining association rules In Proc M SIGMOD Intl Conf Management of Data  May 1995 17 Proceedings of the 1996 ACM/IEEE Conference on Supercomputing \(SC\22296 0-89791-854-1/96 $ 10.00 ACM 


 J S P ark M Chen and P  S Y u  E f 336cient parallel data mining for association rules T echnical Report RC20156 IBM T J Watson Research Center Aug 1995  G Piatetsk y-Shapiro Disco v ery  presentation and analysis of strong rules In G P S et al editor  KDD  AAAI Press 1991  A Sa v asere E Omiecinski and S Na v athe An ef 336cient algorithm for mining association rules in large databases In Proc 21st VLDB Conf  1995  M J Zaki M Ogihara S P arthasarathy  and W  Li P arallel data mining for association rules on shared-memory multi-processors Technical Report 618 Department of Computer Science University of Rochester 618 1996 18 Proceedings of the 1996 ACM/IEEE Conference on Supercomputing \(SC\22296 0-89791-854-1/96 $ 10.00 ACM 


