 1 New Methodology for Reducing Sensor and Readout Electronics Circuitry Noise in Digital Domain 1,2  Semion Kizhner National Aeronautics and Space Administration Goddard Space Flight Center Greenbelt Road, Greenbelt MD, 20771 301-286-1294 Semion.Kizhner-1@nasa.gov  Katherine Heinzen University of Notre Dame      1  
U.S. Government work not protected by U.S. copyright 2  IEEEAC paper # 1542, Version 8 Updated November 17, 2008   Abstract 227Upcoming NASA cosmology science missions such as Joint Dark Energy Mission \(JDEM instruments with multiple focal planes populated with many large sensor detector arrays. These sensors are passively cooled to low temperatures for low-level light \(L3 near-infrared \(NIR\signal detecti and t h e sensor 
readout electronics circuitry  must perform at extremely low noise levels to enable new required science measurements Because we are at the tec hnological edge of enhanced performance for sensors and readout electronics circuitry, as determined by thermal noise level at given temperature in analog domain, we must find new ways of further compensating for the noise in the signal digital domain. To facilitate this new approach, state-of-the-art sensors are augmented at their array hardware boundaries by nonilluminated 
reference pixels which can be used to reduce noise attributed to sensor and readout electronics. There are a few proposed methodologies of processing in the digital domain the information carried by reference pixels, as employed, for example, by the James Webb Space Telescope Project \(JWST\ethods involve using spatial and temporal statistical parameters derived from boundary reference pixel information to enhance the active pixels\222 signals. To make a step beyond this heritage methodology, we apply the NASA-developed technology 
known as the Hilbert-Huang Transform Data Processing System \(HHT-DPS\to some component of reference pixel information. The new methodology applies digital signal processing for a 2-D domain. The high-variance components of the thermal noise, carried by both active and reference pixels, facilitate subtraction of a correction matrix from active pixels array in digital domain in addition to subtraction of a single analog reference pixel from all active pixels on the sensor. Heritage methods using the statistical parameters in the digital domain \(such as statistical 
averaging of the reference pixels\ the high-variance components, and the counterpart components in the active pixels remain uncorrected. This paper describes how the new methodology was demonstrated through analysis of fast varying noise components using the HHT-DPS and makes the case for re-implementation of HHT-DPS in reconfigurable hardware on-boa rd a spaceflight instrument as a real-time processing system \(RT-HHT-DPS  T ABLE OF C ONTENTS   1.0  
I NTRODUCTION  2.0  S OLUTION M ETHODOLOGY  3.0  O UTLINE OF S OLUTION A LGORITHMS  4.0  S OLUTION A LGORITHMS  C ONCLUSIONS  A CKNOWLEDGEMENTS 
 R EFERENCES  B IOGRAPHY   1  I NTRODUCTION   For the vast majority of its existence, humanity has based its viewing knowledge on what can be seen with the naked eye with perhaps some added magnification\hus relying on the visible portion of the electromagnetic spectrum.  This band of radiation includes emissions with wavelengths 


 2 ranging from 0.4 to 0.7 micrometers   However scientists have relatively  recently discovered that many objects in nature \226 particularly distant, cosmic ones do not emit visible light \226 but can be \223seen\224 or imaged through other portions of the electromagnetic spectrum.  Hence engineers have developed n ear-infrared sensors, which capture radiation with wavelengths varying from a little less than 1 micrometer to up to 5 micromet NIR sensors allow scientists to image objects billions of light-years away that are emitting only faint radiation signals. The particular NIR sensor studied in this paper is manufactured by Teledyne Image Sensor Technologies Inc. \(TIS\and is called the HAWAII-2RG \(or H2RG\where the name stands for \223HgCdTe Astronomy Wide Area Infrared Imager with 2Kx2K resolution, Reference pixels and Guide Mode\224 The H2R G sensor \226 m a de of a m e rcury cadmium-telluride \(HgCdTe\rate \226 is bonded to a multiplexer, which is connected to an application-specific integrated circuit \(ASIC\ecifically Teledyne\222s SIDECAR ASIC \(where SIDECAR stands for \223system image, digitizing, enhancing, controlling, and retrieving\224  The m u ltiplexer condenses the m a ssive analog readout from the four million sensor array pixels into a much more manageable number of output channels \(ranging from 1 to 32\lows readout at different time rates.  The ASIC controls the sensor, reads out the analog signals from the sensor multiplexer, and it digitizes these signals. This data is then transmitted to a Field Programmable Gate Array\(s FPGA\a processing and storage under the control of an FPGA-imbedded or general-purpose on-board instrument computer\(s\lenge in signal-to-noise ratio \(SNR control arises when sensor measurements are read out on the maximum number of the sensor channels \(32 for H2RG\o 4 channels used by heritage projects  1.1 Reference Pixels In keeping with the cutting-edge nature of these sensors NIR detector arrays are furnished with reference pixels Figure 1 that are read-out in the same way as the measuring \(\223hot\224\ pixels   Figure 1. Sensor with reference pixels   The reference pixels, built into the sensors, do not actually register the radiation that is illuminating the arrays.  Instead reference pixels measure the noise incurred on the arrays due to a variety of sources.  These reference pixels are a type of noise-correction technology for the digital domain in addition to a single analog reference pixel subtracted from all hot pixels on the sensor.  That is, rather than try to prevent noise from occurring by improving the quality of sensor components \226 an approach limited by costs and physics \226 scientists and engineers frequently seek to correct data after it has been recorded and converted from analog to digital signals, i.e. when it is in the digital domain  One key type of noise measured by reference pixels is thermal noise, or the random motion of electrons inherent in all objects at temperatures above absolute zero \(0 Kelvin While most other types of noise can be minimized in the analog domain at component fabrication, thermal noise is extremely difficult to take out without engaging in expensive cryogenic procedures.  Thus, noise of thermal variety is best dealt with in the digital domain Furthermore, in the course of heritage-method averaging in the digital domain, the fast-varying noise components which can be modeled by sinusoids varying around zero drop out from noise reduction calculations and remain hidden in the readout data.  Thus, enhanced digital domain noise reduction techniques could be of great benefit to the scientific community.  An incr ease in the accuracy of sensor readouts by even a few percent would greatly improve scientists\222 ability to qualify NI R sensors for use in space  Through a series of algorithms run from MATLAB Trademark of MathWorks Inc.\anguage scripts, we have tested the hypothesis that heritage methods fail to compensate for fast-varying noise components present in the data.  After these evaluations, HHT-DPS was used to analyze the noise components in an actual data file, and experiments were run to determine the impact, if any, of the fast-varying noise components.  Finally, programs were written, testing the improve d noise-reduction proposition on both simulated and actual sensor data   1.2 Science Signal Sources Heritage methods of noise re duction using reference pixels such as subtraction of global statistics, overlook fast varying noise components present in the data.  An improved method using the HHT-DPS tool, which breaks down vector functions into their data-derived basis functions called Intrinsic Mode Functions \(IMF\help identify and eliminate this fast-varying noise using an algorithm based on the propagation of heat in a thermal model.  Following this, the heritage subtraction method can evaluate and compensate for statistical tr ends in slower-varying noise components. This pre-processing of reference pixels digitized data would be most beneficial on-board the instrument data system. New instruments handle large volume of science phenomenon signal measurements and Se n sor  Co ntr o l El ec tr o ni cs  Reference p ixels 


 3 digitization at high rates Because of the downlink limitations from deep space \(Lagra nge 2 Point, for example digital data must be pre-processed on-board the instrument to reduce downlink volume, which involves processing of a set of consecutive image frames to generate an output frame, and resulting in fewer output frames for storage and downlink. In such pre-processing the reference pixels of individual sensor frames become unusable. Because of this pre-processing of reference pixels digital data on-board the instruments is also a necessity and this makes the case for the HHT-DPS implementation as RT-HHT-DPS system enabling reference pixel processing in real time  1.3 Fundamentals of Thermodynamics 223Thermodynamics is the study of the effects of work, heat and energy on a system Di scussi on of thermodynamics in this paper focuses on noise sources particularly the thermal variety \(the noise due to random particle motion within sensors and their accompanying electronics\al noise is attributable to heat, or thermal energy. \223Heat IS therma l energy.  It is the energy associated with molecular mo tion, including translation vibration, and rotati Heat i s al so oft e n descri bed as 223the transfer or flow of energy from a hot object to one that is cooler\224 [4].  In the vac uum of outer space, heat is transferred primarily through radiation, where electromagnetic waves carry thermal energy without needing a medium through which to travel.  In space, heat can also occasionally be tran sferred through conduction, in which molecules that are touchi ng, transfer thermal energy to and through each other.  The sensors studied in this paper experience thermal noise through radiation from control and readout electronics, and through conduction  Accompanying the study of thermal energy and heat transfer are the laws of thermodynamics.  This paper is focused on thermal noise phenomena due to the first and third laws of thermodynamics.  The first law states that energy is neither created nor destroyed but merely changes form; i.e. some electrical energy from the sensor and its boundary hardware components contribute to the overall heat \(thermal energy\he sensor, some of which is recorded as thermal noise in the reference pixels.  In a closed system the internal energy is a state variable, just like pressure and other state variables. The first law of thermodynamics defines the inte rnal energy \(E the difference of the heat transfer \(Q\ and the work \(W\ the system. The third law describes the state of absolute zero as being the absence of kinetic energy also called thermal motion\ in the molecules of a given body Any object s not i n t h i s st at e \226 t h at i s at a temperature above absolute zero \226 experience thermal noise It states that "it is impossible by any procedure, no matter how idealized, to reduce any syst em to the absolute zero of temperature in a finite number of operations". Improved digital domain noise reduction techniques will help account for this ubiquitous type of noise   2  M ETHODOLOGY   We first attempted to use the heritage methods for reducing noise in MATLAB-simulated images by directly taking out the fast-varying component.  Although several programs were written and tested, only a few of the most significant programs are described here.  These programs were critical in verifying the hypothesis.  In addition, the solution methodology is described in detail.  This includes using HHT-DPS to identify the fast-varying noise component creating a correction-value matrix based on that component subtracting this matrix from the active pixel data, and using the heritage method to subtract the average of the remaining noise components from the sensor data.  Note that terms 223fast-varying noise component,\224 \223first IMF,\224 and \223IMF1\224 all refer to the same entity.  This is an important distinction for the remainder of the paper. For this analysis we used the H2RG sensor data provided by the Goddard Space Flight Center Detector Characteriza tion Laboratory \(DCL   2.1 Fast-Varying IMFs Early attempts at subtracting the first, fast-varying IMF in various configurations \226 such as across columns or down rows \226 from noise matrices proved ineffective.  These programs were meant to observe if using the first IMF obtained from HHT-DPS, in a data-correction technique made any substantial impact on noise reduction, since a key facet of the hypothesis is th at the fast-varying IMF causes problems that heritage methods cannot fix.  However, the poor results of these MATLAB scripts demonstrated that simplistic subtraction of IMF1 from matrices was not a beneficial approach  Based on the unsatisfactory outcomes from previous programs using two-dimensional matrices we turned to a more straight forward approach: the image is a constant-value vector, and sinusoidal noise is applied to it Then, this entire vector is analyzed using HHT-DPS Figure 8\he first IMF is read back into MATLAB and subtracted from the noise vector.  The images below Figures 2 through 8\splay the HHT-DPS analysis results Although the final image is not linear, its sinusoidal variations have amplitude of only about 0.0004 units In Figures 2-8 the horizontal axis is the number of samples and the vertical axis is the signal amplitude              Figure 2. Original Vector Plot 


 4                Figure 3. Noise Plot        Figure 4. Final Plot after Noise Reduction               Figure 5. Final Plot Zoomed Out   Note the small amplitude  Another successful attempt resulted from a simple correction using the first IMF.  This program employs the same ideas as the previous program of a vector-oriented original image to which sinusoidal noise is added; however the key change in this program is that the original image is more complex, but also known This modification models the analog data that sensors receive in space.  When the noise vector was broken down in HHT-DPS \(Figure 6 the fast-varying IMF was subtr acted from the noise vector the plot of the final vector was the same as that of the original image, with the exception of a slight vertical compression of 0.1 units \(Figures 6 and 7               Figure 6. Original Plot  Figure 7. Final Plot                Figure 8. HHT-DPS Analysis of Noise Vector  


 5  While the successes were encouraging, both of these programs subtracted the fast-varying noise component from all the vector data, since there was no segment analogous to reference pixels.  In practice, the first IMF would only be subtracted from the active pixel data.  However, if one were to view the programs\222 noise vectors as simulations of reference pixel data pervaded by noise, then the results would represent a returning of the reference pixel vector to its pre-noise state \(which in r eality is hoped to be near zero  2.2 Hypothesis Testing Based on the programs described above \226 which show the probable impact of the first, fast-varying IMF \226 and on the following analysis, we have demonstrated the hypothesis to be valid for the sensor data under test.  The hypothesis states that a significant section of sensor readout noise is comprised of at least one fast-varying component.  This portion of noise is averaged out and thus ignored using heritage global statistic subtractions, but it is still physically present in the signal and continues to disrupt the clarity of the image.  In order to test this proposition, we wrote a MATLAB program that examines one of the sensor data DCL files in flexible image transfer protocol \(FITS\format The file consists of 2Kx2K da ta in four layers, with each layer corresponding to a pixel array on the sensor.  The program, which only examined the second layer, revealed that the global mean of all the reference pixel data was a value on an order of magnitude of 10 5 Then, each reference pixel row and column in the layer was isolated and analyzed using the HHT-D PS software, after which the IMF files were read back in to MATLAB.  For each row and column analyzed in HHT-DPS, th e mean of the first, fastvarying IMF was taken, as was the mean of the absolute value of the first IMF.  In every case, the mean of the absolute value was at least one order of magnitude higher than the simple mean.  These re sults demonstrate that, if the absolute value were not taken into account, the mean of the fast-varying IMF would nearly average out to zero Therefore, this finding reveals that heritage methods are indeed ignoring a component of noise that could have a significant effect on the overall noise.  Equation Set 1 shows the generic formulas for the means calculated in MATLAB, and Table 1 and Table 2 present the above analysis numerically  Signal 1 \(Reference Pixel Vector 1 s 2 205,s n  Mean: \265 0  s i   1 <= i <= n Signal 2 \(IMF1 1 r 2 205,r n  Mean: \265 1  r i  265 1ABS  r i   1 <= i <= n  Equation Set 1. General Formula for    MATLAB Calculation of Averages   Table 1. Reference Pixel Row 4 IMF Mean Analysis    Table 2. Reference Pixel Column 4 IMF Mean Analysis  It is important to note, however, that while most of these evaluations examined the effect of using the absolute value of sinusoidal like functions, absolute value is just one example of a method to account for the effects of fastvarying noise components.  Other methods of determining and accounting for the impact of fast-varying noise components should also be investigated  2.3 The Thermal Model Methodology  Once the hypothesis was demonstrated to be valid, it was necessary to determine how to proceed with the information gleaned from the verification of the hypothesis; namely, that there is a fast-varying noise component, this component does contribute significantly to the overall noise, and heritage noise reduction met hods overlook this component First we investigated a model for diffusion of heat across a small, thin square plate on the NetLogo Models Library website.  The purpose of investigating this heat diffusion model was to see if it would provide a suitable algorithm for propagation of noise across an NIR sensor, in large part because the small, thin square plate typifies modern sensors The model allows the user to select boundary temperatures and the initial plate temperature.  The user may also select the plate material, since this affects the plate\222s thermal diffusivity \(the speed with which heat propagates through a substance, represented by the \223alpha\224 sliding bar on the lefthand side of the screen captures below\ After examining the model in operation in several different temperature scenarios, the heat distributi on technique appeared to be applicable to this project.  Below are the algorithm provided by the website and pi ct ori a l exam pl es of t h e m odel  i n  operation \(Figures 9a, 9b and 9c    Reference Pixel Column 4 Electron counts of 0  0 Mean of Column 4 20289 100.00 Mean of Absolute Value of Column 4 20289 100.00 1 Mean of IMF1 40.9726 0.20 Mean of Absolute Value of IMF1 703.8634 3.47 Reference Pixel Row 4 Electron counts of 0  0 Mean of Row 4 10881 100.00 Mean of Absolute Value of Row 4 10881 100.00 1 Mean of IMF1 2.7708 0.03 Mean of Absolute Value of IMF1 798.4533 7.34 


 6 3  O UTLINE O F S OLUTION A LGORITHMS   We initialize the plate and edges to have temperatures that equal their respective slider values. Each time through the GO procedure, diffuse the heat on each patch in the following way. Have each patch set its current temperature to the sum of the 4 neighbors' old temperature times a constant based on alpha plus a weighted version of the patch's old temperature. The updated temperature is calculated by using a Forward Euler Method. Then the edges are set back to the sp ecified values and the old temperature is updated to the current temperature. Then the plate is redrawn [3  The NetLogo thermal model was a key  ai d i n  determining how noise recorded on the reference pixels propagates across the active pixels.  This NetLogo model may or may not be the best option for simulating noise propagation, but it nonetheless gave us an established reference point from which to develop a propagation technique. Screen capture w ith initial value of 100 on all edges and 0 inside the plate and heat propagation process are depicted in the following Figures 9a-9c   Figure 9a   Figure 9b       Figure 9c  4  S OLUTION A LGORITHMS   After we determined that the model would be useful, we developed the general solution methodology 1  use HHT-DPS to find the IMFs of a reference pixel  vector 2  apply 265 1 226 the correction value matrix for fastvarying IMF1 \226 using the thermal model for a square and subtracting this matrix from the active pixels 3  find 265 2 226 a single value \226 by averaging all the IMFs, with the exception of IMF1 4  apply 265 2 in the heritage way \(subtraction from the active pixels To elaborate, this approach to noise reduction uses HHTDPS to identify the first, fast-varying IMFs of the innermost rows and columns of reference pixels; that is, the rows and columns adjacent to the active pixels, numbered 4 and 2045 Note: the first several IM Fs may be fast-varying and should eventually be accounted for, but for the sake of simplicity this project\222s methodology only considered the first IMF.\ean of the absolute value of each first IMF was taken, and these IMF1 mean values formed the corresponding row and column boundaries of the correction-value matrix that was ultimately subtracted from the active pixel data. Two different techniques were used to distribute the reference pixel noise values across the remainder of the correction-value matrix.  Our program MATLAB script\ThermalMode lVerification.m \(hereafter TMV oach, as outlined above, for the solution methodology.  TMV uses fabricated reference pixel data for the edges of the correction matrix, and it propagates this data in a four-quadrant pattern: across the rows and up or down the columns, as necessary, so that the numbers decrease from all directions as they reach the middle of the matrix. The following surface plot \(Figure 10 is the result of executing the program 


 7                 Figure 10. Surface of TMV correction matrix   The upside-down cone shape was expected, and it thus indicates that the program co rrectly executed the desired algorithm. Then, the remain ing IMFs from each of the innermost reference pixel vectors  are added up, the means of the groups of remaining row/column IMFs are determined, and the overall mean is calculated by taking the mean of the IMF averages.  Finally, this global statistic is subtracted from each of the activ e pixels.  The result is the final data, with the noise newly reduced                Figure 11. Surface plot of the central portion of the final TMV correction-value matrix  The final noise reduction program uses the first, fastvarying IMFs from each of th e innermost reference pixel columns and rows from a HAWAII-2RG sensor sample file These IMFs form the boundaries of a correction-value matrix the size of the active pixel region of the data sample Some modifications were made to the propagation algorithm to account for undesi rable effects resulting from the use of the TMV algorithm.  When that method was implemented in this new program, the inner values of the matrix moved to zero so quickly that much of the center of the matrix held the value of zero.  This seemed to be at odds with the purpose of subtracting IMF1 noise from the active pixel data, so we applied another approach.  The IMF1 data now propagates across the inner region of the correctionvalue matrix through a pattern of embedded squares beginning with the boundary square of IMF1 data and moving inward toward the center of the matrix.  Once established, this matrix \(Figure 10\ is subtracted from the active pixel data   C ONCLUSIONS   Based on the research outlined a bove, this paper presents an enhanced method for reducing noise in sensors equipped with reference pixels.  The thermal model inspired the quadrant and embedded square s propagation techniques which can compensate for fast-varying noise components while the heritage methods provide a global mean for subtracting slower-varying noise components from the data However, as with any new finding, the methodology needs more thorough testing on a wider variety of sensors and data than was allowed for by the limited research time.  For example, though the above graphic \(Figure 11\shows the algorithm to be operating correctly, the solution methodology should be tested on sample data where the initial image is known.  This would allow to determine if the image returned after using this noise reduction technique is similar to the original image, and therefore whether the technique is effective.  In addition, a process must be found that allows more than the first fast-varying IMF to be accounted for, since most reference pixel vectors will contain multiple fast-varying IMFs  Furthermore, the MATLAB script solution is only one approach for incorporating the thermal model and heritage techniques into a single program for noise reduction.  Additional research should be performed to investigate other ways of integrating this methodology into a computer program.  For wider applicability, the ultimate program intended for scientific and commercial use should be written in a language compatible with more computing systems, such as C++ or any other suitable platform. The NASA Hubble Space Telescope data post-processing, as well as future deep-space cosmology projects\222 on-board instrument data processing from all the sensor channels, would benefit from this effort  A CKNOWLEDGEMENTS   The authors would like to acknowledge Dr. Tod R. Lauer of NOAO - the DESTINY Project Principal Investigator and Dr. Dominic J. Benford of Goddard Space Flight Center Co-Principal Investigator for sponsoring this work.  We would also like to thank the following members of the Goddard Space Flight Center Robert Kasa, Code 564 Branch Head and Karin Blank, Code 587, provider of the HHT-DPS software 


 8  R EFERENCES    Ki zhner, Sem i on, Kari n B l ank, Thom as Fl at l e y Norden E. Huang, David Petrick, and Phyllis Hestnes. \223On Certain Theoretical Developments Underlying the Hilbert-Huang Transform.\224 IEEE-2006 Aerospace Conference Proceedings, Big Sky Montana, March 4-11, 2006 2  Hermans-Killam, Linda. "Near, Mid and Far-Infrared Cool Cosmos: Infrared Astronomy IPAC. July 2008 http://www.ipac.caltech.edu/out reach/edu/regions/irregion s.html  223HAW AII-2RG Technical Documentation, v. 1.1a 224 Rockwell Scientific. 2003 4 y n e Scien tific & Im ag in g  LLC. "Teled yn e Imaging Sensors - SIDECAR\231 ASIC." Products Services 1 Aug. 2008 http://www.rsc.rockwell.com imaging/sidecar.html  B e nson, Tom ed. "W hat i s Therm ody nam i cs  NASA Glenn Research Center: Beginner's Guide to Propulsion Propulsion Index 11 July 2008. 21 July 2008 http://www.grc.nasa.gov/www/k12/airplane/thermo.html  a l Energy NEWTON Ask a Scientist\251: General Science Archive 21 July 2008 http://www.newton.dep.anl.gov/askasci/gen99/gen99829.h tm  W i l e nsky U. \(1998 L ogo Heat Di ffusi on m odel   Center for Connected Learning and Computer-Based Modeling, Northwestern University, Evanston, IL. 1 July 2008 http://ccl.northwestern.edu/netlogo/models/HeatDiffusion  8] Detector Characterization Lab \(DCL\at 2Kx2K sample data files from HAWAII-2RG near-infrared sensor. Raw data. 14 Sept. 2007  Biography  Semion Kizhner is an aerospace engineer with the National Aeronautics and Space Admini stration at the Goddard Space Flight Center. He proposed the development of the Hilbert-Huang Transform Data Processing System and has been leading the HHT-DPS development team. He participated recently in evaluation of the NASA Advanced Space Technology proposals. He published a dozen of technical papers and mentored numerous undergraduate graduate and doctoral students in the NASA Education Programs. He graduated from Johns Hopkins University with an MS degree in computer science  Katherine Heinzen is a sophomore student at the Electrical Engineering Department of the University of Notre Dame and participant in The Summer 2008 Undergraduate Student Research Program \(USRP Center  


Contour/Density plot for the mean and variance as determined from Set 3 data o o o o o g ro C\\I o o o o co o o o o o o o o o o o o o o g o o o to 8 Contour/Density plot for the mean and variance as determined from Set 4 data 9 v o o o C\\I o o o CX o o o o CO o o v o Q  o c ro  250 300 350 400 450 500 550 250 300 350 400 450 500 550 Mean Mean  I 250 300 I 350 o o o o o o C\\I o o o to o o o v o o o o o 5 Contour/Density plot for the mean and variance as determined from Set 1 data Figure Figure 7 Figure 250 300 350 400 450 500 550 Mean Mean CX o CX o 6 Contour/Density plot for the mean and variance as determined from Set 2 data 400 450 500 I 550 Figure g o g v o g C\\I 


an attribute specified for each transport channel TrCH and depending one limitation This limitation is that only one symbol In the special blocks description we also focused our attention parameters case where ensure the suitable end frame size which corresponds to the specified bit rate and the spreading factor After this Rate Matching RM is applied This process plays the key role in further procedures The matching ensure the right way for physical channels mapping and data processing After multiplexing all TrCHs into can be mapped onto we choose the size of transport block equal to 1280 bits Hence this step we can be eliminated from the system Next step in signal processing is presented by Frame segmentation element Figure 11 Example of pseudo code for radio frame segmentation module Frame segmentation should be done to we can avoid the presence of this procedure PhCH mapping process includes few items Data mapping Channelization and Scrambling As shown in the Figure 1 on SDR blocks work The step-by-step data exchange between one or more Coded Composite Transport Channels CCTrCH one or several PhCHs If one PhCH is used common and special blocks is presented in Figure 12 vi r fIJMT 4ooo o Figure 12 Data processing block scheme 10 READ module rfsegmentation DETERMINE number of frames SET input signal to particular input port IF number of frame more than 1 THEN EXTRACT first data bits of input bits sequence SET framel equals to input data bits PRINT length of framel EXTRACT next data bits of input bits sequence SET frame2 equals to next part PRINT length of frame2 EXTRACT last data bits of input data bits SET frameN equals to last data bits PRINT length of frameN SET output sequence equals to framel frame2 frameN ENDIF SET output port equals to output on two different modules for both chains spreading module for UMTS and IFFT256 for WiMAX Spread spectrum mechanism is the most important thing in whole signal processing chain of WCDMA PHY It is based on the Direct Sequence which provides the expending of one PhCH hence are calculated As ensures equality of the total bit rate after transport channel TrCH multiplexing to the total channel bit rate of the allocated dedicated physical channels PhCH The main parameter of the rate matching is on the upper layers During this step the determination of the spreading factor and the number of physical channels needed for the given number of TrCH we can map CCTrCH into Physical Channel but there is one CCTrCH we have we have to apply PhCH segmentation block In our system implementation we consider a QPSK mapping is used for Data Mapping in Physical channel mapping processing This scheme maps every two bits into signal END 1 E a result of fulfilling this step the correct form of TrCH multiplexing is selected that a bandwidth by unique channelization code This code should be generated by code-tree of orthogonal variable spreading factor OVSF codes Thus it guarantees the orthogonality between different channels during signal transmission 1 In OFDM chain the main role is played by IFFT256 that converts time domain presentation into frequency domain and provides orthogonal independency between adjacent subcarriers 4.3 Main Procedures between SDR blocks There are a set of inherent procedures in the system work which must be done during the signal transmission between SDR blocks 1 Verification the signal nature 2 Switching to particular signal path 3 Reconfiguration of the system according to required protocol scheme 4 Stepby-step signal processing 5 Signal transmission in the chosen mode These procedures present only basic process The BB processing which this paper is presented based more than 


This figure presents the data flow through main blocks that can be used a few times and special blocks that must execute only particular functions Here also Configurator of chain and Sequences library for WiMAX/UMTS modules are equipped First one is responsible for right construction of next processing path and second one stores necessary number of elements After signal verification system is reconfigured according to input data and with using the chosen protocol type The OUTPUT connects to radio link and then signal must be transmitted over one of six channel types And at the reception side we configure the receiver in relation to transmitted mode 5 HARDWARE PLATFORM SELECTION Current technologies in a hardware environment allow to test our system in real-time implementation There are a couple of DSP based platforms that can be selected for validation from Lyrtech Inc the Small Form Factor SFF Software Communication Architecture SCA Development the Small Form Factor SFF Softwaredefined Radio SDR Development Platform the Small Form Factor SFF Software-defined Radio SDR Evaluation Module 20 All these platforms are based on TMS320DM6446 DMP SoC from Texas Instruments 21 For the proposed SDR based system we chose the SFFSDR Evaluation board see Figure 13 as far as this platform supports WiMAX technology model based design tools accelerating prototyping implementation of all protocols layers for complete radio stacking extra boards operates with 297MHz ARM926EJ-s RISC CPU and 594MHz C64x DSP in sense of power management this module has MSP430 MCU Due to an availability of Virtex-4 SX35 FPGA from Xilinx 22 this module can perform implementation of full modem processing functions that is very important feature in meaning of multi-protocol architecture of our system We are able to vary our requirements to each protocol inside the same hardware structure Figure 13 SFF SDR development platform by Lyrtech 6 PROTOTYPING THE WiMAX/UMTS SYSTEM The WiMAX/UMTS system is implemented in high-level language as C with the class library The main accent was done on the correct form of the signal processing sequence The path for WiMAX or UMTS signal is determined in the beginning and system should verify its entity leads the system in a relevant direction The main goal of this software implementation is to check how our system can handle the input signal sequence The simulation was carried out for following parameters for each subsystem For UMTS we consider transport block with 1280 bits size frame size is 2400 bits channelization code with 16 chips sequence For WiMAX we generate the bit block is equal to 1280 bits however during channel coding operation this block is divided on turbo coding block that include 384 bits The size of turbo coding block forms from the block determination corresponding modulation type and number of subchannels During software verification we obtained that our proposed model can separate different paths subject to a type of an inter sequence in the software environment The framework of our WiMAX/UMTS system went through one scenario step and now we are directed to an extension of this model For the more detailed system visualization we integrate our C code modules into MATLAB library by means of proper dynamic linking libraries dll compiled by using the MATLAB C compiler Each block can be formed with extended parameters Modules with C code configurate the system work in a host This host implementation will present a prototype This prototype will help to analyze future real-time hardware implementation MATLAB prototype can also provide debugging of real system the result of real system must be equal to our MATLAB prototype Next step of the work development and verification is to implement it into the hardware platform based on DSP DSP based platform allows to organize signal processing in a digital presentation that serves SDR based part of our general system 7 CONCLUSIONS AND FUTURE WORK In this paper we considered the framework of WiMAX/UMTS baseband level system for mobile device in UL transmission direction We presented the different signal processing structures based on OFDM and WCDMA physical layer procedures Our research work is mainly devoted to developing the approach of seamless switching between different subsystems that can be realized by SDR technology implementation To this end we proposed a possible solution to allow coexistence of different data transmission technologies 11 


The position of SDR blocks in common UMTS/WiMAX architecture for mobile terminal was shown in this paper We presented the different blocks of each subsystem and have identified three blocks which can be implemented as common SDR blocks These blocks include channel coding module interleaver module and data mapping module We also demonstrated the work of our system in the software environment Next steps of the UMTS/WiMAX system development are preparation of the specification and implementation of all possible scenarios Each scenario will include particular blocks parameters and common description of main blocks But we have to be carefully in case of main blocks description because there are a plenty of features 8 ACKNOWLEDGMENTS We gratefully acknowledge the company Arslogica that kindly provided us the hardware support for our experimental studies 9 REFERENCES 1 A Samukic UMTS Universal Mobile Telecommunications System development of standards for the third generation Proc of 1998 IEEE GLOBECOM Conf Sydney AUS Nov 8-12 1998 vol.4 pp.19761983 2 N Fourty T Val P Fraisse and J.-J Mercier Comparative analysis of new high data rate wireless communication technologies From Wi-Fi to WiMAX Proc of the IEEE Autonomic and Autonomous Systems and International Conf on Networking and Services ICAS-ICNS 05 Oct 23-28 2005 pp.66-66 3 M Komara SDR Architecture Ideally Suited for Evolving 802.16 WiMAX AirNet Communications SDR Forum Exhibition 2004 4 I Held 0 Klein A Chen C.-Y Huang and V Ma Receiver Architecture and Performance of WLAN Cellular Multi-Mode and Multi-Standard Mobile Terminals Proc of 2004 IEEE VTC Fall Conf Los Angeles CA Sept 26-29 2004 vol 3 pp 2248 2253 5 IEEE Standard for Local and Metropolitan Area Networks Part 16 Air Interface for Fixed Broadband Wireless Access Systems 2004 6 R Weigel and L Maurer  D Pimingsdorfer A Springer RF Transceiver Architectures for W-CDMA Systems Like UMTS State of the Art and Future Trends Proc of the Intern Symp on Acoustic Wave Devices for Future Mobile Communication Systems Chiba JP March 5-7 2001 pp 25-34 7 P-W Fu and K.C Chen A Programmable Transceiver Structure of Multi-rate OFDM-CDMA for Wireless Multimedia Communications Proc of 2001 IEEE Vehicular Technology Conf VTC-Fall 2001 Atlantic City NJ Oct.7-11 2001 vol 3 pp 1942-1946 8 L Zhigang L Wei Z Yan G Wei A Multi-standard SDR Base Band Platform Proc of 2003 International Conference on Computer Networks and Mobile Computing Shanghai PRC Oct 20-23 2003 pp 461 464 9 C Moy A A Kountouris L Rambaud and P Le Corre  Full Digital IF UMTS Transceiver for Future Software Radio Systems  Proc of ERSA 01 Conf Las Vegas NV June 25-28 2001 10 3GPP TS 25.201 Physical layer general description 11 K.R Santhi and G.S Kumaran Migration to 4 G Mobile IP based Solutions Proc of International Conference on Internet and Web Applications and Services/Advanced International Conference Feb 2006 pp 76 76 12 S Zhu M Song Y Li J Song and F Ren Simulation platform of WCDMA based on software defined radio Proc of 2nd ACM International Conference on Mobile Technology Applications and Systems Nov 2005 pp 1-5 13 L Ma and D Jia The Competition and Cooperation of WiMAX WLAN and 3G Proc of 2nd International Conference on Mobile Technology Applications and Systems Nov 2005 pp 15 14 J Mitola III Software Radio Architecture ObjectOriented Approaches to Wireless Systems new ed Wiley New York 2004 15 R Seungwan 0 Donsung S Gyungchul and K Han Perspective of the next generation mobile communications and services Proc of IEEE 2004 Int Symp on Personal Indoor and Mobile Radio Communications PIMRC 2004 Barcelona SP 5-8 Sept 2004 vol.1 pp 643-647 16 E Biglieri Coding for Wireless Channels  Springer New York 2005 12 


17 3GPP TS 25.212 Multiplexing and channel coding FDD 18 IEEE Standard for Local and metropolitan area networks Part 16 Air Interface for Fixed and Mobile Broadband Wireless Access Systems Amendment 2 Physical and Medium Access Control Layers for Combined Fixed and Mobile Operation in Licensed Bands and Corrigendum 1 2006 pp 0_1 822 19 3GPP TS 25.211 Physical channels and mapping of transport channels onto physical channels FDD 20 Data sheet from Lyrtech Inc http available at htp c hwwkneopusff _.l/p.s/lrtehs _sr d21]D ateforomTdf 21 Data sheet from Texas Instruments http available at 22 Data sheet from Xilinx http available at httll/www.xilinx.com 23 L Hanzo W Webb and T Keller Singleand Multicarrier Quadrature Amplitude Modulation  Wiley New York 2000 titled Wireless and Satellite Communications  The research interests of Dr Sacchi are mainly focused on wideband mobile and satellite transmission systems based on space time andfrequency diversity multi-user receivers based on non conventional techniques neural networks genetic algorithms higher-order statistics-based receivers etc cross-layer PHY-MAC design and high-frequency broadband satellite communications He is currently local coordinator for University of Trento of research projects dealing with reconfigurable communication platforms based on MIMO techniques and space-time signal processing ICONA project funded by MIUR and with exploitation of W-band for broadband satellite communications WA VE programs funded by ASI Claudio Sacchi is author and co-author of more than 50 papers published in international journals and conferences and reviewer for international journals and magazines IEEE Transactions on Communications IEEE Transactions on Wireless Communications IEEE Communications Letters IEEE Transactions on Aerospace and Electronic Systems Electronics Letters Wireless Networks IEEE Communications Magazine etc Dr Sacchi is member of the Organizing Committees and Technical Program Committees of international conferences like ICIP ICC GLOBECOM ACM-MOBIMEDIA etc Claudio Sacchi is member of IEEE M'01 SM'07 BIOGRAPHIES Olga Zlydareva is a PhD student of the University of Trento Italy She obtained her Master degree in Design Electronics Systems with specialization in High Radio Frequency Devices from MATI Moscow State Aviation Technological University named after KE Tsiolkovsky Moscow Russia Her research interests have oriented on the Software Defined Radio Technology Wireless Technologies Cellular Technologies Tunable devices Multi-standard systems Multi-protocol systems Physical layer of mobile devices Reconfigurability and Reprogramming of mobile devices The recent research focuses on the development of the baseband level of multistandard mobile devices based on SDR technology Claudio Sacchi was born in Genoa Italy in 1965 He obtained the Laurea degree in Electronic Engineering and the Ph.D in Space Science and Engineering at the University of Genoa Italy Since August 2002 Dr Sacchi has been holding aposition as assistant professor at the Faculty of Engineering of the University of Trento Italy In 2004 he was appointed by the Department of Information and Communication Technology of the University of Trento as leader of the Research Program 13 


  14  Figure 5:  Site B1 Terrain horizon ma sk with 1 degree azimuth spacing  Figure 6:  Site B1 Terrain horizon mask with 1 de gree azimuth spacing, in e quatorial coordinates 


  15  Figure 7: Lunar South Pole Solar Illumination Yearly Average  Figure 8:  Lunar South Pole DTE Visibility Yearly Average 


  16  Figure 9: Lunar North Pole Sola r Illumination Yearly Average  Figure 10:  Lunar North Pole D TE Visibility Yearly Average 


  17  Figure 11: Site A1 Elevation Topography  Figure 12: Site A1 Yearly Average Solar Illumination and DTE visibility, Medium Resolution 


  18   Figure 13:  Site LB Te rrain Horizon Mask  Figure 14:  Theory and Computed values of Average Yearly Solar Illumination 


  19  Figure 15:  Theory and Computed values of Average Yearly DTE Communication  Figure 16:  Heliostat Mirror Design to Eliminate Cable Wrap 


  20 Angeles, where he also received a B.S. in Applied Mathematics  Eric Fetzer is a Senior Member of the Technical Staff at the Jet Propulsion Laboratory, Pasadena, California specializing in satellite observations of the atmosphere.  His scientific interests include planetary boundary layer processes, tropical phenomena, upper tropospheric variability, and climatologies of temperature, water vapor and clouds.  His technical interests include analysis of large data sets, and of multi-sensor observations. He has over 20 peer-reviewed publications and given numerous scientific presentations, public lectures and media interviews about climate science. Eric received a B.A. in Physics from the University of California Berkeley, and a Ph.D. in Astrophysical, Planetary and Atmospheric Sciences from the University of Colorado, Boulder   Amy Braverman is a Senior Statistician at the Jet Propulsion Laboratory, California Institute of Technology She holds a B.A. in Economics from Swarthmore College an M.A. in Mathematics from UCLA, and a Ph.D. in Statistics also from UCLA. Prior to her current position in JPL's Science Data Understanding Group, she was a Caltech Post-doctoral Scholar at the Jet Propulsion Laboratory, and a Scientist in the Flight Sciences Experiments Section of the Science Division. Dr Braverman conducts research on information-theoretic methods for the analysis of massive data sets and streams statistical data fusion, high-dimensional data analysis, and statistical analysis for climate model evaluation and diagnosis. She has published in both the statistics and geoscience literature, and is active in both communities She is a member of the Multi-angle Imaging SpectroRadiometer Science Team, and serves as a member of the Atmospheric Infrared Sounder Science Integration Team. Her responsibilities on both missions include designing data reduction algorithms for massive, remote sensing data sets. Dr. Braverman also holds an appointment in the Department of Statistics at UCLA as Adjunct Associate Professor, and is active in UCLA\222s Center for Environmental Statistics. She is member of the Committee on Applied and Theoretical Statistics of the US National Academy of Science. She has refereed for the Journal of the American Statistical Association, the Journal of Computational and Gr aphical Statistics, IEEE Transactions on Geoscience and Remote Sensing, and the Journal of Applied Meteorology and Climatology Seungwon Lee is a senior member of the High Capability Computing and Modeling Group at Jet Propulsion Laboratory. She is conducti ng research on comet gas dynamics, nonlinear dynamics control, climate model parameterization, Earth science data analysis, parallel computing, and advanced numerical algorithms. She received her Ph.D in Physics fr om the Ohio State University and her M.S. and B.S. in Physics from the Seoul National University, Korea  Matthew Henderson is software engineer in the High Capability Computing and Mode ling group at JPL. His current work includes Web Services and Instrument Data Level 2 subsetting. He received a B.S. Computer Science from CSU Pomona, and is currently pursuing M.S Computer Science  Steven J. Lewis is a member of the Information System and Computer Science staff member at the Jet Propulsion Laboratory.  He received a BS in Mathematics from the University of California, Los Angeles in June 2001, and the MS and Ph.D. Degree from Claremont Graduate University in May 2004 and May 2007, respectively.  He worked as a post doctoral fellow at Keck Graduate Institute from June 2007 until he joined JPL in March of 2008.  During his graduate and post doctoral work, his studies focused on applications of Bayesian methods to hidden Markov models with particular interest and application to protein sequencing.  His work at JPL has focused on integrating web services into various programming platforms for the purposes of accessing NASA satellite data, as well as developing object tracking so ftware and contributing to image enhancement and restoration efforts Van Dang is a member of the Science Data Understanding Group at the Jet Propulsion Laboratory. She was responsible for the NEWS Level 2 processing that generated the formal merged Level 2 data from multiple A-Train instruments  Manuel de la Torre is a Physicist from the Universidad Complutense at Madrid \(Spain\. After finishing his Ph.D work at the University of Bayreuth \(Germany\ on pattern formation in turbulent flows and a 7 1/2 year stunt as Ass and Assoc. Prof. at the Escuela T\351cnica Superior de Ingenieros Aeron\341uticos in Madrid \(Spain\, he came to the Jet Propulsion Laboratory on a 1-year Sabatical leave in 1997 wanting to apply fundamental concepts of nonlinear systems and geophysical fluid dynamics to something that might be directly useful to soci ety. He discovered the JPL as a great place to achieve that goal and extende d his stay a bit longer, becoming Technical staff and working on different aspects of remote sensing, validation of satellite instruments, and data analysis of atmospheric processes and climate  


