Proceedings of the 2003 IEEE Workshop on Information Assurance United States Military Academy, West Point NY June 2003 Factor Analysis Based Anomaly Detection Ningning Wu Member, IEEE and Jing Zhang Member IEEE Abstract  This paper proposes a novel anomaly detection algorithm based on factor analysis and Mahalanobis distance Factor analysis is used to uncover the latent structure dimensions of a set of variables. It reduces attribute space from a larger number of variables to a smaller number of factors The Mahalanobis distance 
is used to determine the 223simi1arity\224of a set of values from an 223unknown\224samp1e to a set of values measured from a collection of 223known\224 samples Combined with factor analysis Mahalanobis distance is extended to examine whether a given vector is an outlier from a model identified by 221ffactors\224 based on factor analysis In this paper we present a factor analysis based network anomaly detection algorithm and apply it to DARPA Inirusion Detection Evaluation Data The experimental results show that the proposed algorithm is able to detect network intrusions with relatively low false alarms 
Index terms  anomaly detection, intrusion detection factor analysis I INTRODUCTION Intrusion detection can be categorized into two broad categories signature based and profile based The signature-based approach \(also called misuse detection performs detection by searching network audit data for the matches of the 223signatures\224 of known attacks Profile based approach also called anomaly detection performs detection by searching the network audit data for deviations from the established profiles of normal behaviors of users and systems Profiles of normal behavior can be built with a variety of techniques including statistical methods 2,3,4,5 association rules 7,8 neural networks l computer immunology 
Y and specification based methods  141 As network attacks usually do something different from normal network activity they should not comply with profiles Usually the profile-based approach uses a collection of 223normal\224 measures on a set of statistics 3,4 Dr Wu and Dr. Zhang are with University of Arkansas at Little Rock Dr Wu works for Information Science Department Dr Zhang works for Applied Science Department. Email nxwu ixzhangl I@.ualr.edu This work was partially supported by Acxiom Corp under the contract 024-02 
ISBN 0-7803-7808-3/03/$17.00 0 2003 IEEE or features 7,8 to represent profiles To determine whether an observed event is normal or not the system examines its values on the statistics to see if they are different from those in the profile If this is the case the event is flagged as abnormal otherwise it is considered as normal Techniques that used for judging the normality of an event include eBayes lo sequence analysis[9 expert system association rules and classification 8 and pseudoBayes estimators 7 The profile can also be represented 
by a set of observations on a group of statistics thus it is natural to view the profile as a multivariate data set The task of examining the 223normality\224 of an observed event is equivalent to the one of examining whether the event is an outlier of the profile Therefore we can employ multivariate statistical methods to build the profile model and to detect events .that do not fit the profile model These events should correspond to the potential attacks In this paper we propose a network anomaly detection algorithm based on factor analysis Factor analysis is a statistical approach that can be used 
to analyze interre lationships among a large number of variables and to explain these variables in terms of their common underlying dimensions factors It involves finding a way of condensing the information contained in a number of original variables into a smaller set of dimensions with a minimum loss of information 12 As a measurement the Mahalanobis distance is sed in cluster analysis where scale independence is required The proposed algorithm employs factor analysis to reduce the dimensionality of a training data by capturing and retaining the important factors of data. The Mahalanobis distance is 
used to examine whether a sample vector fits the model of the training data We apply the algorithm to network traffic data to detect intrusions The algorithm has been evaluated based on the DARPA Intrusion Detection Evaluation Data The results demonstrate that the algorithm is effective in capturing network attacks with relatively low false alarms and high detection rate The remainder of this paper is organized as follows section 2 and 3 give a brief introduction to factor analysis and Mahalanobis distance Section 4 presents an outlier detection algorithm based on factor analysis and Mahalanobis distance Section 5 discusses the application 108 


Proceedings of the 2003 IEEE Workshop on Information Assurance United States Military Academy West Point NY June 2003 of the algorithm to the network traffic analysis along with the experimental results Section 6 contains related work and section 7 concludes the paper with open problems and future work 11 FACTOR ANALYSIS A Introduction Factor analysis is used to uncover the latent structure dimensions of a set of variables It reduces attribute space from a larger number of variables to a smaller number of factors Factor analysis has a variety of applications such as an assessment of underlying relationships or dimensions in the data and the replacement of original variables with fewer new variables Let x be the observable random vector with m variables Xl,X X that have mean U and covariance matrix  The factor model postulates that X is linearly dependent on a few unobservable random variables Fl F2  Fp called common factors and m additional sources of variation el e2  G called errors or specific factors The factor analysis model is 13 X p,=I,,F tZ12F2  l,,,,F E X,-,LL 12,F tl,,F t...+I,F E Xi pm I lm2F2  lmPFp E or in matrix notation X-p=LF e 1  The coefficient 1 is called the loading of the ith variable on the jth factor so the matrix L is the matrix of factor loadings.~The ith specific factor Ei is associated only with the ith responsexi The p deviations XI p X p2;",Xm pm are expressed in terms of m+p random variables FI F2  Fp el e2   e which are unobservable If assume the unobservable random vectors F and e satisfy the following conditions E[F]=O Cov\(F   I E[e  0 Cov\(e  E[ee    0 0  v Cov\(e F  E[eF   0 These conditions and the relation in 1 constitute the orthogonal factor model The orthogonal factor model implies a covariance structure for X From the model x-p X-p LF e LF e  LF e LF er  LF\(LF  e\(LF  We  ee7 so that c Cov\(X  E\(X-p X-p  LE\(FF   E\(eFr  LE\(Fe  E\(ee  LL  By 1 and 2 X p  LF  e  LFF   eFr  so Cov\(X,F X-p LE\(FF eF Thus we can get covariance structure for the orthogonal factor model 1 Cov\(X U  or Var\(X  I,L+Iy Cov\(X A  1Jkl    lJlm COV\(X F 1  lo 3 2 CovKF  L or The portion of the variance of the ith variable contributed by the m common factors is called the ith communality B Methods ofparameter estimation The principal component factor analysis of the sample covariance matrix S is specified in terms of its eigenvalue-eigenvector pairs    where A A2 2il Let p<m be the number of common factors Then the matrix of estimated factor loadings lij is given by The estimated specific variance are provided by the diagonal elements of the matrix S  LL  so LA p 0  0 1 10 0  J Communalities are estimated as ip i  ti ISBN 0-7803-7808-3/03/$17.00 0 2003 IEEE 109 


Proceedings of the 2003 IEEE Workshop on Information Assurance United States Military Academy West Point NY June 2003 The principal component factor analysis can also be applied to the sample correlation matrix R For the principal component solution the estimated loadings for a given factor do not change as the number of factors is   increased For example if p=l i  fi e and if p=2 i=[fi1.&-6 where K,6 and  the first two eigenvalue-eigenvector pairs for S or R The principal component method satisfies z  LL~+O LL C Factor scores Factor scores are estimates of values for the unobserved random factor vector Fj,j l,...,n That is, factor scores f  estimate of the values fj attained by Since the unobserved quantities fj and e outnumber the observed x j some approaches to estimating factor values have been proposed including the weighted least squares method and the regression method Both approaches have two elements in common h case They treat the estimated factor loadings liiand specific variances  as if they were the true values 0 They involve linear transformation of the For simplicity we only give the result of factor scores estimated by the principal component using least squares method Factor scores estimated by the principal component are generated using an un-weighted least squares procedure original data 1 n  where SZ zx is the sample mean 111 MAHALANOBIS DISTANCE The Mahalanobis distance is a useful way of determining the similarity of a set of values from an unknown sample to a set of values measured from a collection of known samples Mahalanobis squared distance is a measure of statistical distance in multidimensional space This statistic measures the distance from the centroid  multidimensional equivalent of a mean for a set of vector for each of the independent variables included in the analysis Let XI x2  x be a random sample from a population with mean vector p and covariance matrix X The sample mean x and sample covariance matrix are  t\(X Z x QT  1 1 x=-zx s n  n-l~=t Given an rn-dimensional vector v the Mahalanobis distance between v and X is defined as d  V qTS-'\(v-B The larger the value of the Mahalanobis distance for a vector v is the more likely the vector is to be a multivariate outlier One can think of the independent variables as defining a multidimensional space in which each observation can be plotted Also one can plot a point representing the means for all independent variables This mean point in the multidimensional space is also called the centroid The Mahalanobis distance is the distance of a vector from the centroid in the multidimensional space defined by the correlated independent variables If the independent variables are uncorrelated it is the same i6 the simple Euclidean distance Thus this measure provides an indication of whether or not an observation is an outlier with respect to the independent variable values The Mahalanobis distance takes the sample variability into account Instead of treating all values equally when calculating the distance from the centroid it weights the differences by the range of variability in the direction of the sample point There fore the Mahalanobis distance constructs a space that weights the variation in the sample along the axis of elongation less than in the shorter axis of the group ellipse Refer to the Mahalanobis boundary that has been superimposed on Figure 1 and this concept becomes much clearer In terms of Mahalanobi measurements sample 02 will have a substantially small distance to the mean than sample 01 since it lies along the axis of the group that has the largest variability Thus sample 01 is more likely to be an outlier Mahalanobis distances are calculated in units of standard deviation from the group mean. Therefore, the calculated circumscribing ellipse formed around the training data actually defines the one standard deviation boundary of that group This allows the designing of a statistical probability to that measurement In theory samples that have a Mahalanobis distance of 3 or greater have a  Mahalanobis distance is distributed as a chi-square statistic with degrees of freedom equal to the number of independent variables in the analysis ISBN 0-7803-7808-3/03/$17.00 0 2003 IEEE 110 


Proceedings of the 2003 IEEE Workshop on Information Assurance United States Military Academy West Point NY June 2003 probability of 0.01 or less and can be classified as non members of the group Samples that have distances less than 3 are then classified as members The determination of the cutoff value depends on the application and the type of samples F Figure I Mahalanobis distancc vs Euclidean distance Iv FACTOR ANALYSIS BASED ANOMALY DETECTION ALGORITHM Factor analysis combined with Mahalanobis distance can be used to identify outliers from a model specified by the factors For a given set of n observations on m observed variables we use a vector to represent the m observed variables of the i-th observation The n observations form an n-by-m matrix X x,T XR'X,Z'...'X,ml The sample covariance matrix is given as s  SEC  3\(x  qr where X T,,TZ  X is the sample mean vector and X the mean of column j The factor scores of X estimated by principal component are given by AA iTL  X.L\(LTL where i fil,fi62,-.-,K6p]and p is the number of common factors retrained In the proposed algorithm the factor analysis is used to uncover the latent variables It reduces attribute space from a larger number of variables X,,X2   to a smaller number of common factors F,,F2  F The common structure of the given dataset can be better captured by the factor scores Factor Eased anomaly detection algorithm is shown as Figure 2 activities output the covariance matrix S factor loadings L and factor scores of X I Compute covariance matrix of X s  x x X  where X  x Y,xZ 51  xn qT Do principal component decomposition of S to get its eigenvectors  S V  VT Pick the p common factors An ad hoc rule to choose p 2 3 AAA I 4 Compute the factor scores of X  F  XZL\(L'L I a\Algorithm for model construction input a sample vector v representing a test event threshold for Mahalanobis distance d output decision on v 1 Compute the factor scores of v f  LrL V s where SZ is the column mean of x 2 Computer Mahalanobis distance of v d v SI  X 1 n 3 if d  d  v is an abnormal event, otherwise v is an normal event b Algorithm for anomaly detection Figure 2 factor based anomaly detection algorithm ISBN 0-7803-7808-3/03/$17.00 Q 2003 IEEE 111 


Proceedings of the 2003 IEEE Workshop on Information Assurance United States Military Academy West Point NY June 2003 V EXPERIMENTS The proposed algorithm was applied to network intrusion detection Given a dataset so-called reference data containing only normal TCP/IP connections and a test dataset containing some attacks in it the algorithm is employed to learn the property of the normal activities in the training data by factor analysis and then to detect abnormal activities in the test data The performance of the algorithm is evaluated based on the detection rate missed attack rate, and false alarm rate The detection rate is measure as the percentage of attacks detected by the algorithm as abnormal events the missed attack rate as the percentage of attacks missed by the algorithm and the false alarm rate as the percentage of normal activity mistaken as abnormal ones by the algorithm The experiments are based on DARPA Intrusion Detection Evaluation Data A DARPA intrusion detection evaluation data DARPA Intrusion Detection Systems IDS Evaluation project is the first effort to provide data and methodology for off-line evaluation of intrusion detection systems It was conducted by the Information System Technology Group of MIT Lincoln Laboratory under DARPA IT0 and Air Force Research Laboratory sponsorship Details information can be found in 6 The project started from 1998 and continued in 1999 Today DARPA data sets are widely used as the benchmark for IDS evaluation 1998 DARPA evaluation data contains seven weeks of training data and two weeks of test data 1999 DARPA evaluation data contains three weeks of training data and two weeks of test data Attacks in all training data are labeled The test datasets of 1999 Evaluation contains of two parts collected at a gateway inside the mimic subnet and one outside the subnet respectively. Both training and test data are provided in several forms: UNIX BSM tcpdump and NT Data We use tcpdump data for analysis B Detecting abnormal activities of network traffic 1 Experiment Setup Configuration of the experiments is shown as following  Selection of the training data We construct an attack-free dataset from 1998 training data by removing all the labeled attacks We use it as the reference data of normal activity, and then apply the algorithm on 1999 test data to detect abnormal activities that do not comply with the property of the reference data ISBN 0-7803-7808-3/03/$17.00 0 2003 IEEE Preprocess of data For a network traffic dataset a connection record is generated for each TCPAP connection based on a predefined schema R={Ts src.ip, src.port, dst.ip, dst.port, service flag Ts gives the starting time of a connection src.ip and src.port are source IP and port of a connection, and dst.ip and dst.port are destination IP and port service gives the protocol type used in a connection such as ftp smtp etc flag gives the status of a connection which can be open close reset etc A connection record is obtained only from the header of a TCP/IP connection We then apply association rules on the connection records The obtained association rule set contains the frequently occurred patterns in the dataset All the following discussion is based on the association rule sets The reason we use the association rules instead of raw connection records is that the behavior patters in the dataset are better represented by the association rule set because the occurrence of an individual connection is often casual and can tell little about the property of other connections, while an association rule usually describes a common property shared by a set of connections For instance a connection record of the form src.ip 129.174.1 11.3 src.port:3167 dst.ip:73.8.19.5 dst.port 23 service telnet time: 15:23:12 tells a fact that there is a telnet connection from 129.174.1 1 l.3:3167 to 73.8.19.5:23 at the time 15:23 12 However an association rule of the form src.ip 129.174.1 1 1.3 dst.ip:73.8.19.5, dst.port 23 service telnet duration 15:20:49 15:29:03 support  10001 reveals an interesting pattern worthy of further investigation Three data mining algorithms are used including single-level association mining multi-level association mining and feature selection The rule set obtained by each mining algorithm captures the different characteristics of the data Each rule set is then translated into a set of vectors which is represented by a matrix Total three matrixes are generated one from each mining algorithm The factor scores and associated factor loadings are then computed for each matrix Details of the mining algorithms and the way to translate rules into vectors can be found in 7,8 For instance the association rule of the above example is translated into the vector 23 telnet 494 IOOO each field of which in order corresponds to the dstport service duration, support 112 


Proceedings of the 2003 IEEE Workshop on Information Assurance United States Military Academy, West Point NY June 2003 Name Apache2 Back Dict Guessftp Guesspop Mailbomb Neptune Pod Portsweep Process Satan Smurf Teardrop telnet udpstorm Total a Attack respectively For convenience each service type is designated with a unique numeric service index The service type telnet in the vector will be replaced wlth its index instead For the attack-free reference data the factor loadings are computed and used as a model of normal activity patterns in the reference data For the test data the factor scores of each matrix are computed and for each test vector v the mahalanobis distance between v and the centroid of the training data is computed. If the distance exceeds a predefined threshold then the test vector is considered as abnormal Only abnormal test vectors are output 2 Experimental Results We partition the detection results into three parts 223true\224 attacks false alarms, and missed attacks A 223true\224 attack represents the alarm generated by the algorithm that is corresponding to a true network attack A false alarm represents the one that is actually corresponding to normal network activity A missed attack refers to a real attack in the test data that is missed because it is treated as normal activity by the algorithm Table 1 shows the detection result on 1999 DARPA inside test data and outside data The significance level is chosen as d=lO Each table contains the results of the test matrixes generated from the mining algonthms singleLevel refers to the matrix generated from the single level association rule algorithm multilevel refers to one generated from the multi-level association rule algorithm featureSelect referes to one generated from the feature selection algorithm Size gives the total number of test vectors in a matrix trueNo gives the number of 223true\224 attacks detected by the algorithm dRate gives the attack detection rate defined as dRate/\(trueNo+missedNo falseNo gives the number of false alarms flute gives the false alarm rate defined as falseNo/\(size-trueNo missedNo missedNo gives the number of attacks in the test data are missed by the algorithm mRute gives the missed attack rate defined as I-dRate The sum of trueNo and falseNo is the total number of alarms generated by the algorithm The sum of trueNo and missedNo is the total number of real attacks in the test data attackNo 4 2 1 1 1 2 3 3 3 3 1 4 1 1 2 32 distribution o ISBN 0-7803-7808-31036 17.00 0 2003 IEEE a Experimental results on 1999 inside data b Experimental results on 1999 inside data Table 1 Detection results on 1999 DARPA test data From Table 1 we can see that detection results on multilevel and featureSelection matrixes are better than that on singleLeve1 matrix The latter has a higher rate of false detection and missed attacks and contributes most part of false detection and missed attacks to the overall result One reason is that the entire anomaly detection process is based on connection records which contains information only from headers of TCP/IP connections When abnormality of an attack activity is not shown in the header but in the payload the mining algorithms cannot capture them Using only header information of a connection makes data preprocess faster and easy to handle the high-speed network traffic however, at the risk of losing information of the payload Another reason is that patterns extracted from the mining algorithms are not able to distinguish some attacks from normal activity detectedNo 3 1 1 0 0 2 3 2 3 3 1 4 1 1 2 27 he inside data 113 


Proceedings of the 2003 IEEE Workshop on Information Assurance United States Military Academy West Point NY June 2003 Name Apache2 Back crashiis Guessftp Guesspop ipsweep mailbomb neptune Portsweep process satan Smurf Teardrop telnet Total Pod AttackNo 2 3 1 1 1 1 3 4 3 3 1 1 2 1 3 30 detectedNo 1 2 0 0 0 1 3 4 3 3 1 1 2 1 3 25 b Attack distribution of the outside data Table 2 Attack distribution of 1999 test data Table 2 gives attack distribution in both inside and outside data along with the names and number of detected attacks2 The first two columns Name and attackNo give the name and number of an attack in a test data, and detectedNo gives the number of a specific kind of attacks detected by the algorithm w RELATED WORK In this section we only present the related research work that applies statistical approach to anomaly detection Both and  employ a statistical method to measure the user and system behavior by a number of variables sampled over time and then build profiles based on the variables of normal behavior Then the real variables will be compared against profiles Deviations are considered as abnormal Cabrera et al examined the application of statistical modeling for detecting novel attacks against computer networks 5 By using Kolmogorov-Smirnov Test they kmonstrate the difference between normal Telnet connections and attack embedded Telnet connections Valdes et al proposed eBayes technique to detect anomaly in network traffic IO Defining a session as temporally contiguous bursts of TCP/IP traffic from a given IP eBayes applied  Here we only list the attacks in the test data that should be detected from header information ISBN 0-7803-7808-3/03/$17.00 0 2003 IEEE 114 Bayesian inference on observed and derived variables of the session to obtain a belief for the session over the states of hypothesis. Barbara et al proposed a method based on pseudo-Bayes estimators to detect network anomaly that differs from normal network activity 7 Pseudo-Bayes is effective in detecting network anomaly however the parameter selection is an open problem Ye et al presented a multivariate quality control technique, based on HotellingT2 and chi-square distance test to detect intrusions by building a long-term profile of normal activities and using the norm profile to detect anomalies l151 VII CONCLUSION This paper proposes a novel anomaly detection algorithm based on factor analysis and Mahalanobis distance Factor analysis is used to characterize the normal network activities by uncovering the latent structure of them It also reduces attribute space to a smaller number of factors The Mahalanobis distance is used to determine the 223similarity\224 of network activities to the profiles We applied the algorithm to the DARPA Intrusion Detection System Evaluation data and showed that the algorithm is effective in detecting network intrusions with tolerable false detection rate I Ghosh and A Schartzbard A study in using neural networks for anomaly and misuse detection In Proc. USENIX Security Symposium 1999 2 D Anderson T F Lunt H.Javits A Tamaru and A Valdes Detecting unusual program behavior using the statistical component of the next generation intrusion detection system NIDES Technical Report SRI-CSL 95-06 SRI International Menlo Park CA May 1995 3 P Neumann and P Porras Experience with Emerald to Date In First USENIX Workshop on Intrusion Detection and Network Monitoring, Santa Clara California April 1999 4 P Porras and P.G Neumann Emerald Event Monitoring Enabling Responses to Anomalous Live Disturbances In the 1 gth National Information Systems Security Conference Pages 353-365 Baltimore MD October 1997 5 Joao B D Cabrera B Ravichandran and Raman K Mehra Statistical traffic modeling for network intrusion detection In gh International Symposium on Modeling Analysis and Simulation of Computer and TelecommunicatIon systems pages 466-473 2000 


6 Joshua W Haines Richard P Lippmann David J Fried Eushiuan Tran Steve Boswell Marc A Zissman 1999 DARPA Intrusion Detection System Evaluation Design and Procedures MIT Lincoln Laboratory Technical Report  Daniel Barbara Ningning Wu Sushil Jajodia Detecting Novel Network Intrusions using Bayes Estimators In the 1 First SIAM Conference on Data Mining 8 Daniel Barbara Julia Couto Ningning Wu Sushil Jajodia ADAM Detecting Intrusion by Data Mining Proceedings of the 2nd Annual IEEE Informtion Assurance Workshop West Point NY, 200 1 9 S Forrest S Hofmeyr A Somayaji and T Longstaff A sense of self for Unix Processes In Proc of IEEE symp Security and Privacy 1996 IO A Valdes and K Skinner Adaptive model based monitoring for cyber attack detection In 3rd International Workshop on Recent Advances in Intrusion Detection RAID 2000 pages 83-90 October 2000 Ill P.C Mahalanobis On Tests and Meassures of Groups Divergence I Journal of the Asiatic Society of Benagal 26:541 1930 12 Hair R Anderson R Tatham and W Black Multivariate data analysis with readings New York Macmillan 3'd edition 1992  R J Johnson D W Wichern Applied multivariate statistical analysis 4'h ed New Jersey Prentice Hall 14 R Sekar A Gupta J Frullo T Shanbhag A Tiwari H Yang and S Zhou Specification-based anomaly detection: A new approach for detecting network intrusions in 4h ACM Conference on Computer and Communication Security pages 265-274 Washington D C Nov 2002 I51 N Ye S Emran Q Chen and S Vilbert Multivariate Statistical Analysis of Audit Trails for Host Based Intrusion Detection IEEE Transaction on Computer, 51\(7 2002 ISBN 0-7803-7808-3/03/$17.00 0 2003 IEEE 115 Proceedings of the 2003 IEEE Workshop on Information Assurance United States Military Academy West Point NY June 2003 


 A A A A A A A A B B B B B B B A B A B A B A B AB A B A A A A B B B A B A B A A B B B B A B A B A B A B A B A B A disjoint B A inside B A contains B A equals B A meets B A covered by B A covers B A overlaps B A B A B A B A B A B AB Figure 4 Topology and resolution increase with minimum bounding circles 64Mb of main memory Since the Apriori algorithm uses the number of transactions as support and we wanted to compare our algorithm with Apriori we have implemented MaxOccur and the na\250 021ve with transaction based support MaxOccur1 The second version of MaxOccur MaxOccur2 used the object-based support as presented in Algorithm 3.1 Table 9 shows the average execution times for the four algorithms with different image set sizes and 033 0 0  05 for Apriori 223Na\250 021ve\224 and MaxOccur1 and 0  0035 for MaxOccur2 The results are graphically illustrated in Figure 5 Clearly MaxOccur scales well with both versions treating one thousand images in 1.3 seconds on average regardless of the size of the data set The running time for 002ltering the frequent item-sets with 033 0  the maximum support threshold line 16 of Algorithm 3.1 is negligible since it is done in main memory once the frequent item-sets are determined Moreover the calculation of the total number of items line 4 of Algorithm 3.1 is done during the 002rst scan of the data set and has limited repercussion on the algorithms execution time The major difference between Apriori and MaxOccur is in ascertaining the candidate item-sets and counting their repeated occurrences in the images Obviously MaxOccur discovers more frequent item-sets The na\250 021ve algorithm also 002nds the same frequent item-sets but is visibly capable of less performance in execution time The left graphic in Figure 6 shows the average number of frequent item-sets discovered with the three algorithms Apriori found on average 109 different frequent k-item-sets while MaxOccur1 and Na\250 021ve found 148 on the same data sets and MaxOccur2 found 145 on average The discrepancy between MaxOccur1 and MaxOccur2 is basically due to the different de\002nition of support The price we pay in performance loss with MaxOccur is gained by more frequent item-sets and thus more potentially useful association rules with recurrent items discovered ofimages Apriori Na\250 021ve MaxOccur1 MaxOccur2 10K 6.43 70.91 13.62 13.68 25K 15.66 176.69 32.35 34.11 50K 30.54 359.38 66.07 67.44 75K 44.93 514.33 97.27 101.23 100K 60.75 716.01 130.12 137.81 Table 9 Average execution times in seconds with different number of images 0 100 200 300 400 500 600 700 800 10K 25K 50K 75K 100K Apriori MaxOccur1 MaxOccur2 Na\357ve time images Figure 5 Scale up of the algorithms 6 Discussion and conclusion We have introduced in this paper multimedia association rules based on image content and spatial relationships between visual features in images using coarse to 002ne resolution approach and we have demonstrated the preservation and changes in topological features during resolution re\002nement We have put forth a Progressive Resolution Re\002nement approach for mining visual media at different resolution levels and have presented two algorithms for the discovery of content-based multimedia association rules These rules would be meaningful only in a homogeneous image collection a collection of semantically similar images or received from the same source channel Many improvements could still be added to the multimedia mining process to speed up the discovery or to re\002ne or generalize the discovered results 017 One major enhancement in the performance of the multimedia association rule discovery algorithms is the addition of some restrictions on the rules to be discovered Such restrictions could be given in a metarule form Meta-rule guided mining consists of dis#ofimages 033 0 0  25 0  20 0  15 0  10 0  05 10K 1.43 2.20 2.70 5.06 13.51 25K 2.80 4.78 6.31 11.20 32.35 50K 6.27 9.28 11.59 22.74 66.07 75K 8.24 13.57 17.69 33.94 97.27 100K 11.32 17.63 23.13 46.74 130.12 Table 10 Average execution time in seconds of MaxOccur with different thresholds 


 0 20 40 60 80 100 120 140 160 MaxOccur2 MaxOccur1 Na\357ve Apriori Apriori MaxOccur1 MaxOccur2 Na\357ve F k  Figure 6 Frequent item\255sets found by the dif\255 ferent algorithms covering rules that not only are frequent and con\002dent but also comply with the meta-rule template For example with a meta-rule such as 223 H-Next-to X Y   Colour x red  Overlap Y Z   P  Y Z  224 one need only to 002nd frequent 3-item-sets of the form f HNext-to\(red Y  Overlap Y 003  P  Y 003  g where Y is an attribute value and P a visual descriptor or spatial relationship predicate Obviously such a 002lter would greatly reduce the complexity of the search problem A method for exploiting meta-rules for mining multilevel association rules is given in  017 We have approximated an object in an image to a locale which is an area with a consistent visual feature such as colour Objects in images and videos are obviously more complex In a recent paper 9 re gions and their signatures are used as objects in a similarity retrieval system A computationally ef\002cient way to identify distinct objects in images is however still to be proposed Automatically identifying real objects and using spatial relationships between real objects would reduce the number of rules discovered and make them more signi\002cant for some multimedia applications 017 Object recognition or identi\002cation in image processing and computer vision is a very active research 002eld Accurately identifying an object in a video for example as being an object in itself is a very dif\002cult task We believe that data mining techniques can help in this perspective Multimedia association rules with spatial relationships using the motion vector of locales as a conditional 002lter can be used to discover whether locales moving together in a video sequence are part of the same object with a high con\002dence 017 There are many application domains where multimedia association rules could be applied and should be tested such as global weather analysis and weather forecast medical imaging solar surface activity understanding etc We are investigating the application with Magnetic Resonance Imaging MRI to discover associations between lesioned structures in the brain or between lesions and pathological characteristics Further development and experiments with mining multimedia data will be reported in the future References 1 R  A gr a w al and R  S r i kant  F ast a l gor i t h ms f o r m i n i n g a ssociation rules In Proc VLDB  pages 487\226499 1994 2 M  J  E genhof er  Spatial Query Languages  PhD thesis University of Maine 1989 3 M  J  E genhof er and J  S har ma T opol ogi cal r e l a t i ons between regions in r 2 and z 2 In Advances in Spatial Databases SSD'93  Singapore 1993 4 U  M  F ayyad S  G  D j or go vski  a nd N  W e i r  A ut omat i n g the analysis and cataloging of sky surveys In U Fayyad G Piatetsky-Shapiro P Smyth and R Uthurusamy editors Advances in Knowledge Discovery and Data Mining  pages 471\226493 AAAI/MIT Press 1996 5 Y  F u a n d J Han  M e ta-ru le-g u i d e d m in in g o f a sso ciatio n rules in relational databases In Proc 1st Int Workshop Integration of Knowledge Discovery with Deductive and ObjectOriented Databases  pages 39\22646 Singapore Dec 1995 6 J  H an an d Y  F u  Disco v e ry o f mu ltip le-le v el asso ciatio n r u l es from large databases In Proc VLDB  pages 420\226431 1995 7 Z  N  L i  O R Z a 250 021ane and Z Tauber Illumination invariance and object model in content-based image and video retrieval Journal of Visual Communication and Image Representation  10\(3\:219\226244 September 1999 8 R  M iller a n d Y  Y a n g  Asso ciatio n r u l es o v e r i n t erv a l d ata In Proc ACM-SIGMOD  pages 452\226461 Tucson 1997 9 A  N atse v  R Rasto g i  a n d K Sh im W ALR U S A s imilar ity retrieval algorithm for image databases In Proc ACMSIGMOD  pages 395\226406 Philadelphia 1999  R Ng L  V  S  L akshmanan J  H an a nd A Pang E x ploratory mining and pruning optimizations of constrained associations rules In Proc ACM-SIGMOD  Seattle 1998 11 R Srik an t a n d R Ag ra w a l M i n i n g q u a n titati v e asso ciatio n rules in large relational tables In Proc ACM-SIGMOD  pages 1\22612 Montreal 1996  P  S t ol or z H  N a kamur a  E  M esr obi an R  M unt z E  S h ek J Santos J Yi K Ng S Chien C Mechoso and J Farrara Fast spatio-temporal data mining of large geophysical datasets In Proc Int Conf on KDD  pages 300\226305 1995  O  R  Z a 250 021ane Resource and Knowledge Discovery from the Internet and Multimedia Repositories  PhD thesis School of Computing Science Simon Fraser University March 1999  O  R  Z a 250 021ane,J.Han,Z.-N.Li,J.Y.Chiang,andS.Chee MultiMediaMiner A system prototype for multimedia data mining In Proc ACM-SIGMOD  Seattle 1998  O  R  Z a 250 021ane J Han Z.-N Li and J Hou Mining multimedia data In CASCON'98 Meeting of Minds  Toronto 1998 


18001  balancing mechanism which requires further investi gation 4.5 Speedup Figure 12 shows the speedup ratio for pass 2 vary ing the number of processors used, 16 32 48 and 64 where the curve is normalized with the 16 processor execution time The minimum support value was set to 0.4 4.5 0.5 1 1 0 I 10 20 30 40 50 60 70 number of mxessors Figure 12 Speedup curve NPA HPA and HPA-ELD attain much higher lin earity than SPA HPA-ELD an extension of HPA for extremely large itemset decomposition further in creases the linearity HPA-ELD attains satisfactory speed up ratio This algorithm just focuses on the item distribution of the transaction file and picks up the extremely frequently occurring items Transferring such items could result in network hot spots HPA-ELD tries not to send such items but to process them locally. Such a small mod ification to the original HPA algorithm could improve the linearity substantially 4.6 Effect of increasing transaction Figure 13 shows the effect of increasing transac tion database sue as the number of transactions is increased from 256,000 to 2 million transactions We used the data set t15.14 The behavior of the results does not change with increased database size The minimum support value was set to 0.4 The num ber of processors is kept at 16 As shown each of the parallel algorithms attains linearity 5 Summary and related work In this paper we proposed four parallel algorithms for mining association rules A summary of the four database size Sizeup 0 I 0 500 loo0 1500 uxw amount of transaction thousands Figure 13 Sizeup curve algorithms is shown in Table 5 In NPA the candi date itemsets are just copied amongst all the proces sors Each processor works on the entire candidate itemsets NPA requires no data transfer when the supports are counted However in the case where the entire candidate itemsets do not fit within the mem ory of a single processor the candidate itemsets are divided and the supports are counted by scanning the transaction database repeatedly Thus Disk 1/0 cost of NPA is high PDM, proposed in 6 is the same as NPA which copies the candidate itemsets among all the processors Disk 1/0 for PDM should be also high The remaining three algorithms SPA HPA and HPA-ELD partition the candidate itemsets over the memory space of all the processors Because it better exploits the total system's memory, disk 1/0 cost is low SPA arbitrarily partitions the candidate itemsets equally among the processors Since each processor broadcasts its local transaction data to all other pro cessors the communication cost is high HPA and HPA-ELD partition the candidate itemsets using a hash function which eliminates the need for transac tion data broadcasting and can reduce the comparison workload significantly HPA-ELD detects frequently occurring itemsets and handles them separately which can reduce the influence of the workload skew 6 Conclusions Since mining association rules requires several scans of the transaction file its computational requirements are too large for a single processor to have a reasonable response time This motivates our research In this paper we proposed four different parallel algorithms for mining association rules on a shared nothing parallel machine and examined their viabil 29 


Table 5 characteristics of algorithms ity through implementation on a 64 node parallel ma chine the Fujitsu AP1000DDV If a single processor can hold all the candidate item sets parallelization is straightforward It is just suf ficient to partition the transaction over the proces sors and for each processor to process the allocated transaction data in parallel We named this algo rithm NPA However when we try to do large scale data mining against a very large transaction file the candidate itemsets become too large to fit within the main memory of a single processor In addition to the size of a transaction file a small minimum support also increases the size of the candidate itemsets As we decrease the minimum support computation time grows rapidly but in many cases we can discover more interesting association rules SPA HPA and HPA-ELD not only partition the transaction file but partition the candidate itemsets among all the processors We implemented these al gorithms on a shard-nothing parallel machine Per formance evaluations show that the best algorithm HPA-ELD attains good linearity on speedup by fully utilizing all the available memory space which is also effective for skew handling At present we are doing the parallelization of mining generalized association rules described in 9 which includes the taxonomy is-a hierarchy Each item belongs to its own class hierarchy In such mining associations between the higher class and the lower class are also examined Thus the candidate itemset space becomes much larger and its computation time also takes even longer than the naive single level association mining Parallel pro cessing is essential for such heavy mining processing Acknowledgments This research is partially supported as a priority research program by ministry of education We would like to thank the F\221ujitsu Parallel Computing Research Center for allowing us to use their APlOOODDV sys tems References l R.Agrawal T.Imielinski and ASwami 223Min ing Association Rules between Sets of Items in Large Databases\224 In Proc of the 1993 ACM SIGMOD International Conference on Manage ment of Data pp207-216 May 1993 2 R.Agrawal and RSrikant 223Fast Algorithms for Mining Association Rules\224 In Proc of the 20th International Conference on Very Large Data Bases pp.487-499 September 1994 3 J.S.Park M.-S.Chen and P.S.Yu 223An Effec tive Hash-Based Algorithm for Mining Associ ation Rules\224 In Proc of the 1995 ACM SIG MOD International Conference on the Manage ment of Data SIGMOD Record Vo1.24 pp.175 186 June 1995 4 H.Mannila H.Toivonen and A.I.Verkamo 223Ef ficient Algorithms for Discovering Association Rules\224 In KDD-94:AAAI Workshop on Knowl edge Discovery in Databases pp.181-192 July 1994 5 A.Savasere, E.Omiecinski and S.Navathe 223An Effective Algorithm for Mining Association Rules in Large Databases\224 In Proc of the 21th International Conference on Very Large Data Bases pp.432-444 September 1995 6 J.S.Park M.-S.Chen and P.S.Yu 223Efficient Parallel Data Mining for Association Rules\224 In Proc of the 4th International Conference on In formation and Knowledge Management pp.31 36 November 1995 7 T.Shintani and M.Kitsuregawa 223Considera tion on Parallelization of Database Mining\224 In Institute of Electronics Information and Com munication Engineering Japan SIG CPS Y95 88 Technical Report Vo1.95 No.47 pp.57-62 December 1995 8 T.Shimizu T.Horie and H.Ishihata 223Perfor mance Evaluation of the APlOOO Effects of message handling broadcast and barrier syn chronization on benchmark performance-\224  In S WO PP 22292 9.2 ARC 95 Information Processing Society of Japan Vo1.92 No.64 1992 9 R.Srikant and R.Agrawal 223Mining Generalized Association Rules\224 In Proc of the 21th Inter national Conference on Very Large Data Bases pp.407-419 September 1995 30 


Plenary Panel Session 30 XML Databases   Moderator: Michael Carey, IBM Almaden Research Center USA Panelists Adam Bosworth, Microsoft Corporation USA David De Witt University of Wisconsin-Madison, USA Alon Levy University of Washington USA Bruce Lindsay IBM Almaden Research Center USA Jennifer Widom Stanford University USA Demo Session 1 Web Query Optimizer  661 V Zadorozhny L Bright L Raschid T Urhan and M Vidal ReQueSS: Relational Querying of Semi-structured Data  664 R Sunderraman The IDEAL Approach to Internet-Based Negotiation for E-Business  666 J Hammer C Huang Y Huang C Pluempitiwiriyawej M Lee H Li L Wang Y Liu and S Su READY A High Performance Event Notification Service  668 R Gruber B Krishnamurthy, and E Panagos A Multimedia Information Server with Mixed Workload Scheduling  670 G Nerjes DISIMA An Object-Oriented Approach to Developing an Image Database System  672 V Oria T Ozsu P Iglinski B Xu and L Cheng Demo Session 2 The Collaboration Management Infrastructure  677 H Schuster D Baker A Cichocki D Georgakopoulos and M Rusinkiewicz Assisting the Integration of Taxonomic Data The LITCHI Toolkit  679 I Sutherland J Robinson S Brandt A Jones S Embury W Gray R White and F Bisby TheaterLoc: Using Information Integration Technology to Rapidly Build Virtual Applications  681 G. Barish Y.4 Chen D Dipasquo, C Knoblock S Minton I Muslea and C Shahabi Lineage Tracing in a Data Warehousing System  683 Y Cui and J Widom xiii 


The Mentor-Lite Prototype A Light-Weight Workflow Management System  685 J Weissenfels M Gillmann 0 Roth, G Shegalov and W Wonner Location Prediction and Queries for Tracking Moving Objects  687 0 Wolfson B Xu and S Chamberlain Semiorder Database for Complex Activity Recognition in Multi-Sensory Environments  689 S Bhonsle A Gupta S Santini and R Jain Tutorial 1 Web Information Retrieval  693 M Henzinger Tutorial 2 Mobile and Wireless Database Access for Pervasive Computing  694 P Chrysanthis and E Pitoura Tutorial 3 Data Mining with Decision Trees  696 J Gehrke Tutorial 4 Directories Managing Data for Networked Applications  697 D Srivastava Tutorial 5 Indexing High-Dimensional Spaces Database Support for Next Decade\222s Applications  698 S Berchtold and D Keim xiv 


 T5.I2.D100K T10.I4.D100K T15.I4.D100K T10.I6.D400K T10.I6.D800K T10.I6.D1600K Optimizations across Databases 5 0 5 10 15 20 25 30 35 40 45 Improvement COMP TREE COMP-TREE 1 2 4 8 1 2 4 8 1 2 4 8 2 4 8 2 4 8 1 2 4 8 Processors Databases Figure 5 Effect of Computation and Hash Tree Balancing good as the COMP optimization The reason that the hash tree balancing is not suf\336cient to offset inherent load imbalance in the candidate generation in this case The most effective approach is to apply both optimizations at the same time COMP-TREE The combined effect is suf\336cient to push the improvements in the 40 range in the multiple-processor case On 1 processor only hash tree balancing is bene\336cial since computation balancing only adds extra cost 5.4 Short-circuited Subset Checking Figure 6 shows the improvement due to the short-circuited subset checking optimization with respect to the unoptimized version The unoptimized version is the Apriori algorithm due to Agrawal et al 5 The results are presented for dif ferent number of processors across dif ferent databases The results indicate that while there is some improvement for databases with small transaction sizes the optimization is most effective when the transaction size is large In this case we get improvements of around 25 r the unoptimized version To gain further insight into this optimization consider 336gure 7 It shows the percentage improvement obtained per iteration on applying this optimization on the T20.I6.D100K database It shows results only for the uni-processor case r similar results were obtained on more processors We observe that as the iteration k increases there is more opportunity for shortcircuiting the subset checking and we get increasing bene\336ts of up to 60 The improvements start to fall off t the high end where the number of candidates becomes small resulting in a small hash tree and less opportunity for short-circuiting It becomes clear that is an extremely effective 15 Proceedings of the 1996 ACM/IEEE Conference on Supercomputing \(SC\22296 0-89791-854-1/96 $ 10.00 ACM 


 T5.I2.D100K T10.I6.D800K T15.I4.D100K T20.I6.D100K procs across Databases 0 5 10 15 20 25 Improvement 1 2 4 8 Figure 6 Effect of Short-circuited Subset Checking 23456789101112 Iterations 0 10 20 30 40 50 60 improvement T20.I6.D100K Figure 7  Improvement per Iteration  proc   16 Proceedings of the 1996 ACM/IEEE Conference on Supercomputing \(SC\22296 0-89791-854-1/96 $ 10.00 ACM 


optimization for larger transaction sizes and in cases where there are large number of candidate k itemsets 6 Conclusions In this paper e presented a parallel implementation of the Apriori algorithm on the SGI Power Challenge shared memory multi-processor We also discussed a set of optimizations which include optimized join and pruning computation balancing for candidate generation hash tree balancing and short-circuited subset checking We then presented experimental results on each of these Improvements of more than 40 were obtained for the computation and hash tree balancing The short-circuiting optimization was found to be extremely effective for databases with large transaction sizes Finally we reported the parallel performance of the algorithm While we d good speed-up we observed a need for parallel I/O techniques for further performance gains References  R Agra wal T  Imielinski and A Swami Database mining A performance perspecti v e  I n IEEE Trans on Knowledge and Data Engg  pages 5\(6 1993  R Agra wal T  Imielinski and A Swami Mining association rules between sets of items in lar ge databases In Proc M SIGMOD Intl Conf Management of Data  May 1993  R Agra wal H Mannila R Srikant H T o i v onen and A I V erkamo F ast disco v ery of association rules In U F et al editor Advances in Knowledge Discovery and Data Mining  MIT Press 1996  R Agra wal and J Shafer  P arallel mining of association rules design implementation and e xperience Technical Report RJ10004 IBM Almaden Research Center San Jose CA 95120 Jan 1996  R Agra wal and R Srikant F ast algorithms for mining association rules In Proc 20th VLDB Conf  Sept 1994  M Cierniak W  Li and M J Zaki Loop scheduling for heterogeneity  I n 4th IEEE Intl Symposium on High-Performance Distributed Computing also as URCS-TR 540 CS Dept Univ f Rochester  Aug 1995  M Holsheimer  M  K ersten H Mannila and H T o i v onen A perspecti v e on databases and data mining In 1st Intl Conf Knowledge Discovery and Data Mining  Aug 1995  M Houtsma and A Swami Set-oriented mining of association rules In RJ 9567  IBM Almaden Oct 1993  H Mannila H T o i v onen and I V erkamo Ef 336cient algorithms for disco v ering association rules In AAAI Wkshp Knowledge Discovery in Databases  July 1994  J S P ark M Chen and P  S Y u  A n e f fecti v e hash based algorithm for mining association rules In Proc M SIGMOD Intl Conf Management of Data  May 1995 17 Proceedings of the 1996 ACM/IEEE Conference on Supercomputing \(SC\22296 0-89791-854-1/96 $ 10.00 ACM 


 J S P ark M Chen and P  S Y u  E f 336cient parallel data mining for association rules T echnical Report RC20156 IBM T J Watson Research Center Aug 1995  G Piatetsk y-Shapiro Disco v ery  presentation and analysis of strong rules In G P S et al editor  KDD  AAAI Press 1991  A Sa v asere E Omiecinski and S Na v athe An ef 336cient algorithm for mining association rules in large databases In Proc 21st VLDB Conf  1995  M J Zaki M Ogihara S P arthasarathy  and W  Li P arallel data mining for association rules on shared-memory multi-processors Technical Report 618 Department of Computer Science University of Rochester 618 1996 18 Proceedings of the 1996 ACM/IEEE Conference on Supercomputing \(SC\22296 0-89791-854-1/96 $ 10.00 ACM 


