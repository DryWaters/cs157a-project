Detection based on per-\003ow Packet Count and Entropy Xuyang Zhu Network center Southern Medical University GuangZhou China zhuxu@smu.edu.cn Hai Zhang Network center Southern Medical University GuangZhou China zhangh@139.com Abstract Portscanning is a common activity of considerable importance It is often used by computer attackers to characterize hosts or networks which they are considering hostile activity against Thus it is useful for system administrators and other network defenders to detect portscans as possible preliminaries to a more serious attack Thus it is of considerable interest to attackers to determine whether or not the defenders of a network are portscanning it regularly A major dif\002culty with detecting these portscans on a high-speed monitoring point is that the traf\002c volume on high speed links can be tens of gigabits per second and can contain millions of 003ow and high volume of traf\002c This data set is sometimes too large for us Fortunately sampling is a typical solution for this problem So it is usually to employ a sampling method to reduce the data set 002rst There have been many alternative sampling methods In this paper we use a simple and appropriate sampling technique for portscan detection which we call threshold sampling It can select large prior to small ones Meanwhile it can control the resources consumed by adjusting the threshold When portscans happen in a network the attacker always sends 003ows with only one packet We hope to pick out these 003ows applying threshold sampling We need to select the small prior to big ones we compute the reciprocal of each attribute as the new attribute In a word we employ a mapping from the old attribute to the new one Then we can employ the sampling With the reduced data set we can detect ports scanners more easily and quickly This is a good preparation for detecting portscan What's more we introduce a new way to identify ports scanners As the host which scan large number of different destination IP addresses and ports is probably a ports scanners we can compute the entropy of each host which re\003ect the distribution of its destination IP addresses and ports The experimental results show that datum from the sample also can tell which hosts are port scanners accurately We will see that the attackers entropy for destination IP address is bigger than others clearly 1 Introduction Portscanning is a common activity of considerable importance It is often used by computer attackers to characterize hosts or networks which they are considering hostile activity against Thus it is useful for system administrators and other network defenders to detect portscans as possible preliminaries to a more serious attack It is also widely used by network defenders to understand and 002nd vulnerabilities in their own networks Thus it is of considerable interest to attackers to determine whether or not the defenders of a network are portscanning it regularly A portscan is de\002ned as more than N distinct probes within M seconds from a single source Portscans is a common class of non-volume based anomalies which are associated with worm/virus propagation In order to detect portscan there exist several algorithms which fall into two general approaches target-speci\002c and traf\002c pro\002ling In detail there are a Threshold Random Walk TRW b T ime Access P attern Scheme T APS  and c Entrop y-based beha vior modeling proposed recently These algorithms are e v aluated in 14 and we will see that all of the three algorithms are somewhat complicated What's more they require large memory and CPU processing although not each destination IP address and destination port are recorded for analyzing All of the algorithms above employ a simple random sampling as a preprocessing procedure In some degree the sample can not represent the whole effectively In this paper we use a simple and appropriate sampling technique for detecting portscan which we call threshold sampling In other words we employ a sampling approach as a preprocessing procedure for further analyses A port scan is a series of messages sent by someone attempting to break into a computer to learn which computer network services each associated with a 223well-known\224 port number the computer provides Port scanning a favorite approach of computer cracker gives the assailant an idea where to probe for weaknesses Essentially a port scan consists of sending a message to each port one at a time The kind of response received indicates whether the port is used and can therefore be probed for weakness Ports scans include several types such as vanilla Strobe Stealth scan 
2009 International Conference on Electronic Computer Technology 978-0-7695-3559-3/09 $25.00 © 2009 IEEE DOI 10.1109/ICECT.2009.97 524 


and so on The most common type of portscan footprint at present is a horizontal scan By this we mean that an attacker has an exploit for a particular service and is interested in 002nding any hosts that expose that service Thus she scans the port of interest on all IP addresses in some range of interest Another type is vertical scans This is where an attacker scans some or all ports on a single host Here the rationale is that the attacker is interested in this particular host and wishes to characterize the services on it perhaps with a view to 002nd which exploit to attempt or to 002nd a suitable exploit via her network of contacts and resources A wide variety of heuristics for portscan detection have been proposed all involving some combination of sampling hashing and counting\(see and section 2 for a surv e y However only several solutions have clean bounds on the amount of space necessary to produce good approximate lists of the most frequent items Xenofontas Dimitropoulos et al proposed to focus 003o w accounting on hea vyhitter 003ows in order to deal with the scalability problems of accounting for all 003ows Keys et al described algorithms that compute at streaming rates sources or destinations of many 003ows The algorithms mentioned above focus on 003ows In this paper we will present a new approach for detecting portscan In detail we will 002nd the hosts with the least packets As ports scanners usually send one or two packets to form a 003ow Unfortunately we did not 002nd any sampling method which focus on the small ones but not the big ones On the contrary we know that threshold sampling is a method which addressed big objects and pay less attention to small ones Obviously the effect is contrary So we compute the reciprocal of each attribute as the new attribute In a word we employ a mapping from the old attribute to the new one Then the following procedures are the same with that of threshold sampling That's 002rst select the targets above the threshold and then perform an aggregate function over an attribute Ultimately sort the aggregate result on disk In other words we 002lter the data set with a threshold On the basis of this reduced data set we still can aggregate the targets and 002nally 002nd the N IP addresses with largest entropy And the ports scanners are included in these IP addresses The 002rst step can be called threshold sampling by which we only have to analyze less data but can learn more information about the data set Threshold sampling is suitable for a huge set which has a large number of variances Firstly we need to compute the value of threshold Secondly we can get the probability according to the threshold Finally we can sample according to the probability Threshold sampling is a biased sampling the main advantage of which is that it addressed big objects but never neglect small ones Therefore if we want to distinguish the IP address that makes an unusually high number of distinct connections within a given time we can use threshold sampling to get the more important targets Further more we can get ports scanners 002nally The rest of the paper is organized as follows Section 2 discusses some related approaches about portscanning and sampling Section 3 presents two algorithms of threshold sampling for portscan detection and the meaning of sampling and renormalization Section 4 presents our experimental results and section 5 presents conclusion 2 Related Work A number of papers have proposed algorithms for related problems in network traf\002c analysis The goal of these researches is to develop approaches that extract essential characteristics of network traf\002c streams passing through routers especially estimates of the heaviest users which may represent portscanners subject to a limited amount of memory about previously seen 003ows Several portscan detection techniques have been proposed in literature Snort is a 003e xible rule language that issues alerts based on user-de\002ned connection patterns and rates Hence we view Snort as more of a system rather than technique SPICE is a comple x of f-line technique based on Bayesian analysis that can detect stealthy portscans The focus of this paper however is on two 224on-line\224 portscan detection techniques TRW Threshold Random W alk and TAPS T ime Access P attern Scheme which can process traf\002c in real-time to identify portscans and have been shown to be highly effective In addition in an evaluation of an entropy-based portscan detection technique are proposed There are many alternative sampling methods A selfadaptive packet sampling method is presented in which can adjust the sampling rate according to the required error range In there are detailed introductions about the control Sample and Hold has already been discussed in  Although it is not possible to construct an unbiased usage estimator from the measurements produced by this method its accuracy is similar to that of the present method However unlike the present work this method would require modi\002cation of routers A review of these and other sampling methods used or proposed for passive Internet measurement can be found in In this paper for detecting portscan we will use a sampling method which controls the sampling rate is to dynamically adjust the sampling threshold z in order to match the rate of selection of 003ow reports to a target In section 3 we will introduce this sampling in detail When z is increased fewer reports are sampled while when z is decreases more reports are sampled A multiplicative control scheme to adjust z has been considered in also shows that the number and average length of 003ows 
525 


may be inferred even when some 003ows are not sampled and compute the distribution of 003ow lengths 3 Algorithms of Threshold Sampling for portscan detection Our goal is to 002nd ports scanners As the data set is too large we reduce data volume by threshold sampling We expect that heavy hitters in the reduced data are that of the original data So we 002rst have to understand what threshold sampling is It can be described as follows Consider a set of n sizes f x i g i 1 n prior to sampling Initially we can think of this set either as the sizes of all objects or as the set sizes of objects of a particular key P  x  is the probability of the object with the size of x  z is the threshold Then p  x   275 1  if x 270 z 0  if x  z  How to compute the threshold is the key point Only one threshold can make us estimate some statistics unbiased Consider the case the target mean sample volume M is less than n  the total number of objects from which to be sampled  N  P i  i is the total number of samples obtained using the sampling function p z  Now the expected number of samples N z  E  N z  P i p z  x i  clearly is a non-increasing function of z  and indeed we show below that there exists a unique z 244 for which N z 244  M  So the z 244 is the right threshold We now propose two ef\002cient algorithms to 002nd a threshold for sampling After the execution of the sampling heavy hitters can be found on the basis of the sampling result The two algorithms both are based on sampling from the set of source-destination pairs We 002rst propose a Conservative Algorithm based on the basic iteration de\002ned in the 003owing Theorem We then present a more complex algorithm called Root Finding Algorithm which uses a limited recursion to speed up convergence when  N  M  This assumes the requisite storage and processing cycles are available 3.1 Conservative Algorithm Theorem 1  Assume that x i  0 for all i  1      n that n  M  and that z 1  0  De\002ne g  z   zN z M and set z k 1  g  z k   k 2 N  i g  z  is concave and the equation g  z   z has a unique positive solution z 244  ii k 7 z k is monotonic and lim k 1 z k  z 244  iii k 7 N z k is monotonic and lim k 1 N z k  M  Based on the theorem we can infer the following is the conservative algorithm z k 1  z k max f  N  k  z k  1 g M 1 We illustrate the form of g and convergence of the sequence f z n g in Figure 1 As show in equation 1 every time we compute the value of z we have to scan the total set So it takes much time and resource during the recursive course Fortunately there is another algorithm to speed up convergence\226Root 002nding algorithm Figure 1 Iteration with g  with sequence f z n g converging to z 244 from below 3.2 Root Finding Algorithm Root Finding Algorithm is used to 002nd the root of equation N z  M  For X 261 z    267  270   de\002ne X 261 z  f x 2 X j x 261 z g Given 002xed set of sizes X  f x 1      x n g and a target volume M  we can 002nd the right z to pick out about M objects for further analyse Let N z  X    P X 267 z  z  j X z j  That is N z is our expected number of samples from X with threshold z  Our goal is to 002nd z 244  Z  X M  such that N z 244  X   M  We note that N z 244  X   j X j for z 267 min X  and that N z  X  is strictly decreasing for z 270 min X  Thus z 244 is uniquely de\002ned assuming M  j X j  The basic idea is to pick some value z and compare N z with M  If N z  M we are done If N z  M  we know z  z 244 and if N z  M  we know z  z 244  we wish to recurse on X  z  If z  z 244  we wish to recurse on X  z  Duf\002eld et N z  X B   B=z  N z  X  Also de\002ne z 244  Z  X B M  such that N z 244  XB   M  Then N z  X 0  N z  X  and Z  X 0  M   Z  X M   Note that if B  0  N z  X B  is strictly decreasing for all z  0  and hence z 244 is always unique So we 002rstly have to suppose that either B  0 or M  j X j  Lemma 1   If N z  X B   M  Z  X B M   Z  X z  B M 241 j X 270 z j  Lemma 2   If N z  X B   M  Z  X B M   Z  X z  B  P X x 267 z  M  
526 


The above lemmas immediately imply that the following recursive algorithm correctly determines Z  X B M  when B  0 or M  j X j  Algorithm Z  X B M    Assume that B  0 or M  j X j  1 IF X    return B=M  2 Pick a random z 2 X  a N z  X B   M  return z  b N z  X B   M  return Z  X z  B M 241 j X 270 z j   c N z  X B   M  return Z  X z  B  P X x 267 z  M  As stated above The Conservative Algorithm is based on the basic iteration de\002ned in Theorem 1 The Root Finding Algorithm can speed up convergence when  N  M  In some degree the latter is an improving algorithm of the former Section 4 will presents our experimental results of root 002nding algorithm 4 Entropy-based Scan Detection Entropy-based techniques are motivated by the observation that a majority of anomalous and interesting events induce a change in the distribution of traf\002c communication pattern which can be captured by the sample entropy We will explain in detail how sample entropy is computed and applied to portscan detection Let X be a discrete random variable that is observed N times and takes values from the set f x i g of cardinality M  Let n i denote the number of times it takes value x i during the observation window The sample entropy is then de\002ned as H  X   241 M X i 1 p  x i  log 2 p  x i   Where N  P M i 1 n i  and p  x i   n i N stands for the sample probability of X  x i  Note that 267 H  X  267 log 2 M  H  X   0 if X always takes the same value and H  X   log 2 M if X is uniformly distributed i.e p  x i   1 M  i  1      M  For traf\002c analysis purposes X represents the number of 003ows with a particular traf\002c feature or dimension Four typical 223dimensions\224 are the number of 003ows for a given source IP address SrcIP destionation IP address DstIP source port number SrcPORT and destination port number DstPORT respectively The Relative Uncertainty RU is then de\002ned as RU  X   H  X  H max  X   241 P M i 1 p  x i  log 2 p  x i  log 2 j M j RU is actually a relative entropy and normalizes the degree of uniformity of the distribution This is because 0 267 RU  X  267 1  with RU  X   0 if X takes a single value and RU  X   1 if X has a uniform distribution over the sample space 5 Experimental Results We implemented root 002nding algorithm for 002nding the host which launch a portscan Actually the data produced by the large installed base of Net\003ow has recorded frequency of each contact in other form That's the packet number of each 003ow Therefore the sampled attribute was the packet number of each 003ow which was got from the data of Net\003ow In this experiment we analyzed the actual Net\003ow reports which were captured on a 300Mbs link on the connection point of a university campus to the Internet on the 7 th of May 2008 On that day the host 192.168.2.48 launched portscan on the network segment from 136.56.45.53 to 136.56.44.86 We now review the whole process Firstly we employ threshold to select the typical 003ow Second we compute the entropy of each source IP address Third we sort the values of entropies to 002nd ports scanners We 002nd that the host with large value of entropies is probably a port scanner In this experiment if we can 002nd out the host 192.168.2.48 rightly that means our approach is effective We compute the entropies of each IP from the sample And table 1 show that the results are exactly what we expect As this portscan only scan only one port the entropy of 192.168.2.48 for destination port is zero However entropy for destination IP address is bigger than others clearly IP RU of port\(des RU of IP\(des 192.168.140.14 1.362845199 7.763616679 192.168.137.1 1.077875667 7.315554527 192.168.2.48 0 6.193149604 172.16.143.1 4.480420510 6.182974856 172.21.137.156 4.641020213 6.139337622 192.168.21.17 5.168705252 5.564100356 192.168.80.132 5.266353407 5.505689038 172.16.64.246 6.049228862 5.315450516 172.21.138.111 4.910392014 5.242436297 Table 1 entropies of sampled IP addresses 6 Conclusion We have presented an ef\002cient algorithm for identifying ports scanners As the data volume was often too large we select part of data to present the original data In a word we have a threshold sampling to get a reduced data set The sampling approach can control the resources consumed by adjusting the threshold Obviously the effect of this sampling is just contrary to what we expect As we want to select host with least packets So we compute the reciprocal of each attribute as the new attribute In a word we employ a mapping from the old attribute to the new one Then the following procedures are the same with that of threshold sampling Finally compute each IP address's entropy based on its destination IP addresses and destination ports Based on the result we got we will identify ports scanners easily 
527 


That's this sampling method are suitable for detecting port scanners as their entropies are much larger than the usual hosts References  N Duf\002eld C Lund and M Thorup,\223Learn more sample less Control of volume and variance in network measurement\224 IEEE Trans Inform Theory vol 51 pp 1756-1775 2005  hillip Gibbons and Yossi Matias 223Synopsis data structures for massive data sets\224 Proc 10th Annual ACM-SIAM Symposium on Discrete Algorithms pages 909-910 1999  Xenofontas Dimitropoulos Paul Hurley Andreas Kind 223Probabilistic Lossy Counting:An ef\002cient algorithm for 002nding heavy hitters\224 ACM SIGCOMM Computer Communication Review Volume 38 Number 1 January 2008  K Keys D Moore and C Estan 223A robust system for accurate real time summaries of Internet tra\002c\224 ACM SIGMETRICS Performance Evaluation Review 33\(1 2005  N Kamiyama and T Mori 223Simple and accurate identi\002cation of high-rate 003ows by packet sampling\224 In Proceedings of IEEE INFOCOM 2006  A Gilbert Y Kotidis S Muthukrishnan and M Strauss Surfing wavelets on streams 223One-pass summaries for approximate aggregate queries\224 In Proceedings of the 27th International Conference on Very Large Databases 2001  A Gilbert Y Kotidis S Muthukrishnan and M Strauss 223How to summarize the universe Dynamic maintenance of quantiles\224 In Proceedings of the 28th International Conference on Very Large Data Bases 2002  B.-Y.Choi J Park and Z.-L Zhang 223Adaptive packet sampling for 003ow volume measurement\224 University of Minnesota MA Tech Rep.TR 02-040 Dec 2002  N.G Duf\002eld C Lund M Thorup 223Flow Sampling Under Hard Resource Constraints\224 In Proc ACM SIGMETRICS 2004 New York NY June 12-16 2004  N.G Duf\002eld 223Sampling for Passive Internet Measurement A Review\224 Statistical Science 2004 to appear  J Jung V Paxson A W Berger and H Balakrishnan 223Fast Portscan Detection Using Sequential Hypothesis Testing,\224 in Proc of 2004 IEEE Symposium on Security and Privacy Oakland CA USA May 2004  A Sridharan T Ye and S Bhattacharyya 223Connection Port Scan Detection on the Backbone,\224 in Malware Workshop held in conjunction with IPCC Phoenix Arizona USA April 2006  K Xu Z.-L Zhang and S Bhattacharyya 223Pro\002ling Internet Backbone Traf\002c Behavior Models and Applications,\224 in Proc ACM SIGCOMM'05 Philadelphia PA USA Aug 2005  J Mai A Sridharan C.-N Chuah T Ye and H Zang 223Impact of Packet Sampling on Portscan Detection,\224 Sprint ATL Tech Rep RR06-ATL-043166 2006  223Snort,\224 http://www.snort.org  S Staniford J A Hoagland and J M McAlerney 223Practical automated detection of stealthy portscans,\224 J of Computer Security vol 10 no.1-2 pp 105-136 2002  K Xu Z.-L Zhang and S Bhattacharyya 223Reducing Unwanted Traf\002c in a Backbone Network,\224 in Proc of SRUTI'05 Cambridge MA USA July 2005 
528 


521 


Table 3 Performance Testing Time to Transfer File File Size Selected Range Time to Type kB Data Rate nm Transfer Mbps sec Text 2.1 1 5.2 3 File Still 120 1 5.2 33 Image Small 1280 1 5.2 85 Video Large 18000 11 2.3 32 Video __________ 5 CONCLUSION The test team performed seven formation test flights encompassing 35 flight hours during March 2007 to determine the reception envelope and the performance of an airborne 802.1 lb Wireless Fidelity WiFi data link as a function of range elevation azimuth data rate amplification level link configuration and noise level The data link envelope was defined in terms of azimuth angle elevation angle and slant range The performance of the data link was defined in terms of data rate TCP and UDP error statistics and network health statistics The 95 percent confidence interval for range with 11 Mbps and 5 W of amplification 1.58 W EIRP selected was 3.0 to 4.7 nautical miles with a maximum actual data rate of 4.4 Mbps The 95 percent confidence interval for range with 1 Mbps and 5 W 0.32 W EIRP selected was 6.2 to 11.3 nm with a maximum actual data rate of 0.7 Mbps Performance characteristics of the data link were measured while sending text files chat data still images pre-recorded video and streaming webcam video between the two aircraft Network health statistics were gathered for both TCP and UDP activities Overall the network health statistics reflected high network efficiency for all data rates and ranges the low noise environment The data rate selected was found to have an impact on the reception range achieved There were small differences between the range results of the automatic AUTO and 11 Mbps selected data rates However 1 Mbps yielded twice the reception range of AUTO The actual data rates did not match the selected data rates available to each physical configuration The selections available were AUTO 1 Mbps 2 Mbps 5.5 Mbps and 11 Mbps The observed data rates were much lower than the selected data rates Knowing the over-the-air data rate gives the user baseline information for developing potential applications for use across the data link REFERENCES 1 Limited Evaluation of an 802.1 lb Air-to-air Wireless Datalink Project Have HALO II Technical Report AFFTC-TIM-07-01 USAF Test Pilot School Edwards AFB June 2007 2 Haigh-Farr Blade Antenna Data Sheet Haigh-Farr Inc Bedford NH 31 Jan 2007 3 2.4 GHz High Power WiFI Amplifiers with Switchable Power Control Hyperlink Technologies 7 Jun 2007 4 SecNetl 1R Plus Secure Wireless LAN PC Card Harris Corp Melbourne FL 7 Feb 2007 Testing was performed on a WiFi network configured in three different ways Ad Hoc Infrastructure and Bridge The Ad Hoc configuration was found to be the most reliable and capable Hardware errors associated with the SecNetl 1 WiFi cards were encountered in the Infrastructure and Bridge modes which were frequent persistent and highly disruptive to the test The effect of background noise level on data link performance was investigated by comparing maximum data link range in high and low noise levels As expected the maximum data link range in the high noise environment was an order-ofmagnitude less than that obtained in the low noise environment An unexpected effect was the variation in noise level and corresponding data link maximum range in 7 


BIOGRAPHY Capt Robert Volesky is a Flight Test Engineer at the 411th Flight Test Squadron at Edwards AFB CA His research interest includes wireless communications Capt Volesky obtained a B.S degree in Electrical Engineering from the United States Air Force Academy in 2000 and an M.S in Electrical Engineering from Iowa State in 2001 He is a member of Tau Beta Pi the Association of Old Crows and the Society of Flight Test Engineers Lt Col Brian Kish is an instructor at the Air Force Test Pilot School His research interests include control theory and operations research He is the author L llllllll of one book chapter and 12 articles in  the areas indicated above Lt Col Kish 5 h~~~~as a B S degree i Aerospace I Engineering from Illinois Institute of Technology and he has an M.S and Ph.D from the Air Force Institute of Technology He is a member of AIAA and the Society of Flight Test Engineers Maj Douglas Crevistion is a Test Pilot at the 416th Flight Test Squadron at Edwards AFB CA His research interests include gas turbine engines and data links Maj Creviston has a Bachelor of Aeronautical Engineering from the United States Air Force Academy in 1997 and an MS in Aeronautical and Astronautical Engineering from the Massachusetts Institute of Technology in 1999 He is a member of the Society of Experimental Test Pilots Capt Jason Geitgey is a Flight Test Engineer at the 46th Test Squadron at Eglin AFB FL His research interest includes control theory and sensor and defensive aircraf systems Capt Geitgey obtained a B.S degree in Aerospace Engineering from the University of Cincinnati in 1998 and an M.S in Aeronautical Engineering from the Air Force Institute of Technology in 2006 He is a member of AIAA and the Society of Flight Test Engineers Maj Morikazu Kikuchi is a Test Pilot at the flight test squadron at Gifu AB in Japan His research interests include upgrading F-15J's avionics Maj Kikuchi obtained a B.S degree in mechanical engineering from Aoyama Gakuin University in 1994 He is a member of the Society of Experimental Test Pilots Capt Jason Vap is a Flight Test Engineer at the 417th Flight Test Squadron at Edwards AFB CA His research interests include semiconductor materials and devices Capt Vap obtained B.S and M.S degrees in Electrical Engineering from the University of Wyoming in 2002 and 2004 respectively He is a member of the Society of Flight Test Engineers 8 


 arctan   9 the longitude of the site at Cartesian coordinates \(x,y centered on the pole.  The equation uses the variable L1 for the longitude where the horizon mask crosses \226   L sin 0 0       212     212 002 else 0 1 1 1  xy 212 005  t 004   004 L  DTE L  002   t  005  002 212  Hp d R     7  Comparing these theoretical e quations with the computed illumination and DTE communications averages required using an adjusted lunar reference altitude at the poles.  The lunar reference geoid radius of 1738 km is not a good average value for the terrain at either pole.  The lunar south pole is part of the Aitken Basin, and the GSSR Digital Elevation Model elevations ha ve an average of -1880 m within 200 km of the south pole.  The lunar north pole region has an average elevation of -1673 m within 150 km of the north pole.  These averag es were subtracted from base site reference altitude to get the value of \221h\222 used in equation 2.  This effectively gaves the base sites a higher elevation relative to the local average elevation  For selected base sites, solar illumination and DTE communications averages were computed for tower heights from 2 m to 1500 m, and in some cases 3000 m.  Then these tower heights plus adjusted altitudes and base locations were used in equations 1 through 7 to get predicted values of the yearly average metrics.  The results are shown in figures 14 and 15.  Figure 14 shows black curves of equation 5 plotted parametrically with distance from the pole.  For the selected sites, the computed yearly average solar illumination is shown by squares, connected by a dashed line with the theoretical yearly average for the same location and tower heights The theoretical values are marked with X\222s.  South lunar Pole sites are in blue and the lunar north pole sites are in red.  The plots show reasonable agreement of computed values and theory, with the computed value never exceeding the theoretical.   Figure 15 shows black curves of equation 7 plotted parametrically with distance from the pole.  Th e value of L0 was set to zero for the parametric curves.  Fi gure 15 include computed and theoretical values of the yearly average DTE communications for the same sites as figure 14, using the same symbol and color conventions  At no site will a tower of 1500 m or less provide both 100 average yearly solar illumination and 100% average DTE communications.  Towers of 1500 m at sites NB and NC will raise the average yearly solar illumination to 100 But for the lunar south pole sites, like B1, towers of over 2500 m are required to rais e the average yearly solar illumination to 100%.  This is because the peaks Malapert 002 peaks  t\002 1  212  0 1 4 R      6  The yearly average Earth co mmunications, DTE, is then given by the equation        L L  L L Hm R  8  The obscuring effect of these p eaks is also shown in figure 5, where the peak Malapert t 006 002    L  2 cos 180 abs 180 sin 006 212 003 003  002 latitude These variables are   003  and Leibnitz 002 obscure the view of the sun from the lunar south pole.  Equation 8 gives the elevation, Hp, above a spherical surface needed to see the winter sun over a peak of elevation Hm at a distance, d from the pole.  Equation 8 provided values in Figures 4 and 14 for the Malapert 003 and Leibnitz 212 003 is at +10 degrees azimuth  Figure 15 shows the yearly average DTE communication varies more with distance fr om the pole toward the prime meridian that with tower height above the local terrain Towers up to 3000 m at the poles do not make significant improvements in the DTE co mmunications average.  The computed yearly average DT E communications for site NG exceed the predicted values fo r towers between 32 and 1500 meters tall.  This is because the view northward from site NG toward the Earth looks across the floor of Byrd Crater which averages about -2500 m elevation  Considerations for Photovoltaic Array Design  The lunar pole sites create some difficult challenges for designing a continuously operating photovoltaic power system.  A site with continuous solar illumination will see the Sun travel through 360 degrees of azimuth during 1 synodic month.  A photovoltaic power system would require several permanently mounted photovoltaic arrays pointed in several directions, or would have to continually track the Sun with a single array.  Sin ce a single array requires much less mass, the design of the solar tracking system is examined here  The requirement to continually track the Sun could be met by installing the photovoltaic array on a vertical axle oriented parallel to the lunar spin axis.  At the lunar south pole, this axle would rotate counterclockwise with the Sun to keep the array normal to the solar radiation.  This requires a foundation to support the axle cross beam structures to hold the array on the axle, and a drive system to turn the array.  This system also requires a solution to the \221cable wrap\222 problem, in order to continually track the Sun.  After 1 synodic month the array has turned through 360 degrees and needs to continue rotating in the same direction.  Power and control cables from the array need to go through multiple slip rings, or the array needs to rotate 360 degrees clockwise to unwrap the cables.  A slip ring design is further complicated by the requirement to tolerate the fine dust on    arccos 004  005  b t cos if 


  10 the lunar surface.  Using the \221cable unwrap\222 method means stopping power production for a short amount of time, once per synodic month  A heliostat design using a focusing mirror may provide a low-mass solution to the \221cable wrap\222 problem [Ref 10   Figure 16 shows a photovoltaic array installed horizontal to the local terrain.  A parabolic section mirror is installed above the array, angled at approximately 45 degrees to the local horizontal.  This mirror is suspended from the crossbar of a mast placed next to the array.  The mast could also be the structure for the Lunar Co mmunications Terminal \(LCT antennas.  The mirror is suspe nded from an axle that is oriented parallel to the lunar spin axis and rotates once per synodic month to continually reflect solar radiation onto the array.  The mirror can continue to track after 360 degrees revolution, since there are no cables attached to the moving part.  This heliostat \221periscope\222 design provides continuous solar tracking, but is partially shaded once per revolution when the Sun passes behind the support mast  Shaping the mirror into a para bolic arc concentrates solar power for a small increase in mass.  The tradeoffs should consider the relative mass-perunit area of the mirror and the photovoltaic panels, the reflectivity of the mirror material and the relative masses of an array-support axle versus a mirror heliostat axle plus mast  Additional flat \221periscope\222 mirrors mounted on the crossbar could be used to direct solar light to areas nearby.  This provides an efficient method of lighting work areas because it bypasses the inefficiencies of the photovoltaic system battery storage, and electric lighting.  If the photovoltaic power system is located on a crat er rim \(as in Figure 16\a flat \221periscope\222 mirror could provide continuous lighting to exploration crews in the perman ently shadowed areas within the crater.  Sufficiently large heliostat mirrors could redirect enough sunlight to run photovoltaic arrays at remote locations.  This would provide very efficient power transfer for operating within the permanently shaded areas  5  C ONCLUSIONS   Separating the lunar pole solar illumination problem into terrain horizon mask and solar motion computations simplified the production of illumination metrics.  Using a simplified model of average solar motion allowed quick comparisons between lunar south pole sites.  The results show that within 100 km of the lunar south pole, solar illumination is maximized at previously identified site locations.  These sites are small areas on the peaks of isolated mountains and crater rims.  No site provides 100 yearly average for both solar illumination and DTE communication.  Lunar north pole sites were also examined No site at either pole prov ides 100% yearly average for solar illumination unless a tower at least 1500 m is placed on one of the best lunar north pole sites  The best lunar south pole sites are on the rim of Shackleton crater, and the ridge west of Sh ackleton crater.  These 3 sites have yearly average of solar illumination between 93 and 97%.  The Sites have 100% solar power generation capability about 85 to 92% of the year.  For both of these metrics, Site B1 on the ridge West of Shackleton crater has the highest solar illumination values.  Site B1 has direct-toEarth visibility of the entire Earth disk about 51% of each month.  More detailed analysis of site B1 can use the terrain horizon masks presented here, coupled with more detailed true-of-date solar motion computations  Examination of the site solar illumination profiles at 40meter resolution shows the peaks of illumination are distributed over many points.  The locations with greater than 80% solar illumination are spread over 100s of meters This supports the conclusion that the Digital Elevation Model has adequate sampling to show the true terrain characteristics  The lunar north pole base sites NB and NC have yearly average solar illumination around 97%, and have 100 solar power generation capability about 88 to 92% of the time for the average year  The yearly average for 100% DTE communications at the best lunar north pole and south pole sites are all around 50%.  The yearly average DTE communications does not vary significantly with tower height, but does increase to 100% for sites about 100 km from the poles toward the lunar prime meridian 6  A CKNOWLEDGMENTS  This research was carried out at the Jet Propulsion Laboratory, California Institute of Technology, under a contract with the National Aeronautics and Space Administration  The author expresses thanks to Martin A. Slade of JPL\222s GSSR group for his time and assistance with the 2006 GSSR Digital Elevation Model data.  The author also wished to thank Charles Ruggier and Laif Swanson of the SCiP Study Team at JPL for their support of this work  R EFERENCES   1. Scott Hensley, Eric Gurrola Paul Rosen, Martin Slade Joseph Jao, Micheal Kobrick, Raymond Jurgens, Eric De Jong, and Barbara Wilson, \223RADAR generates highresolution topographic map of the Moon\224, Society of PhotoOptical Instrumentation Engineers Newsroom, June 16 2008  2.  J. L. Margot, D. B. Campbell, R. F. Jurgens, M. A Slade, \223Topography of the Lunar Poles from RADAR 


  11 Interferometry: A Survey of Co ld Trap Locations\224, Science Vol 284, pg 1658-1660, 4 June 1999  3.  NASA, \223The Vision for Sp ace Exploration\224,  Feb. 2004 http://www.nasa.gov pdf/55584main_vision_space_explorat ion-hi-res.pdf  4.  M. Kruijff, \223The Peaks of Eternal Light on the Lunar South Pole: How they were found and what they look like\224 4th International Conference on Exploration and Utilization of the Moon \(ICEUM4\ESA/ESTEC, SP-462, September 2000  5.  J. Fincannon, \223Lunar South Pole Illumination: Review Reassessment, and Power Sy stem Implications\224, 5 th  International Energy Conversion Engineering Conference and Exhibit \(IECEC\, 25-27 June 2007, AIAA 2007-4700  6.  J. Fincannon, \223Charact erization of Lunar Polar Illumination From a Power System Perspective\224, 56 th AIAA Aerospace Sciences Meeting and Exhibit, 7-10 January 2008, AIAA 2008-0447  7.  M. Zuber, I. Garrick-Be thell, \223What Do We Need to Know to Land on the Moon Again?\224, Science, Vol 310, pg 983-985, 11 November 2005  8.  Gazetteer of Planetary Nomenclature, International Astronomical Union, 03/31/2008  9.  Ewan A. Whitaker, \223The Lunar South Polar Regions\224 Journal of the British Astronomical Association, Vol. 64 No. 6, pp. 234-242  10. James D. Burke, \223Merits of A Lunar Polar Base Location\224, Lunar Bases and Space Activities of the 21st Century. Houston, TX, Lunar and Planetary Institute, edited by W. W. Mendell, 1985, p.77  B IOGRAPHY   Scott H. Bryant is a member of the senior staff at the Jet Propulsion Laboratory. He has a bachelor\222s in Aeronautics and Astronautics Engineering from MIT and a master\222s in Astronautics from USC.  He has worked for the Jet Propulsion Laboratory for over 10 years, working on several of JPL\222s Deep Space Network \(DSN\s.  His projects include the receivers, exciters, and spacecraft tracking subsystems.  He has been principally involved with software design and development for spacecraft tracking, including holding the position of cognizant design engineer for the current DSN Ranging system. Scott is currently the implementation and design lead for the spacecraft tracking and ranging portion of JPL\222s Network Simplification Project.  He has also work ed with the study groups examining communications and navigation issues for the Constellation system lunar studies.  The work presented here was performed for the SCiP Lunar Architecture study group  


  12  Figure 1:  Lunar South Pole Elevation Map from GSSR 2006 Digital Elevation Model  Figure 2:  Lunar North Pole Elevation Ma p from GSSR 1997 Digital Elevation Model 


  13  Figure 3:  Shackleton Crater T opographic Map, with Base Sites  Figure 4: Solar Lines-of-Si ght at Lunar South Pole 


  14  Figure 5:  Site B1 Terrain horizon ma sk with 1 degree azimuth spacing  Figure 6:  Site B1 Terrain horizon mask with 1 de gree azimuth spacing, in e quatorial coordinates 


  15  Figure 7: Lunar South Pole Solar Illumination Yearly Average  Figure 8:  Lunar South Pole DTE Visibility Yearly Average 


  16  Figure 9: Lunar North Pole Sola r Illumination Yearly Average  Figure 10:  Lunar North Pole D TE Visibility Yearly Average 


  17  Figure 11: Site A1 Elevation Topography  Figure 12: Site A1 Yearly Average Solar Illumination and DTE visibility, Medium Resolution 


  18   Figure 13:  Site LB Te rrain Horizon Mask  Figure 14:  Theory and Computed values of Average Yearly Solar Illumination 


  19  Figure 15:  Theory and Computed values of Average Yearly DTE Communication  Figure 16:  Heliostat Mirror Design to Eliminate Cable Wrap 


  20 Angeles, where he also received a B.S. in Applied Mathematics  Eric Fetzer is a Senior Member of the Technical Staff at the Jet Propulsion Laboratory, Pasadena, California specializing in satellite observations of the atmosphere.  His scientific interests include planetary boundary layer processes, tropical phenomena, upper tropospheric variability, and climatologies of temperature, water vapor and clouds.  His technical interests include analysis of large data sets, and of multi-sensor observations. He has over 20 peer-reviewed publications and given numerous scientific presentations, public lectures and media interviews about climate science. Eric received a B.A. in Physics from the University of California Berkeley, and a Ph.D. in Astrophysical, Planetary and Atmospheric Sciences from the University of Colorado, Boulder   Amy Braverman is a Senior Statistician at the Jet Propulsion Laboratory, California Institute of Technology She holds a B.A. in Economics from Swarthmore College an M.A. in Mathematics from UCLA, and a Ph.D. in Statistics also from UCLA. Prior to her current position in JPL's Science Data Understanding Group, she was a Caltech Post-doctoral Scholar at the Jet Propulsion Laboratory, and a Scientist in the Flight Sciences Experiments Section of the Science Division. Dr Braverman conducts research on information-theoretic methods for the analysis of massive data sets and streams statistical data fusion, high-dimensional data analysis, and statistical analysis for climate model evaluation and diagnosis. She has published in both the statistics and geoscience literature, and is active in both communities She is a member of the Multi-angle Imaging SpectroRadiometer Science Team, and serves as a member of the Atmospheric Infrared Sounder Science Integration Team. Her responsibilities on both missions include designing data reduction algorithms for massive, remote sensing data sets. Dr. Braverman also holds an appointment in the Department of Statistics at UCLA as Adjunct Associate Professor, and is active in UCLA\222s Center for Environmental Statistics. She is member of the Committee on Applied and Theoretical Statistics of the US National Academy of Science. She has refereed for the Journal of the American Statistical Association, the Journal of Computational and Gr aphical Statistics, IEEE Transactions on Geoscience and Remote Sensing, and the Journal of Applied Meteorology and Climatology Seungwon Lee is a senior member of the High Capability Computing and Modeling Group at Jet Propulsion Laboratory. She is conducti ng research on comet gas dynamics, nonlinear dynamics control, climate model parameterization, Earth science data analysis, parallel computing, and advanced numerical algorithms. She received her Ph.D in Physics fr om the Ohio State University and her M.S. and B.S. in Physics from the Seoul National University, Korea  Matthew Henderson is software engineer in the High Capability Computing and Mode ling group at JPL. His current work includes Web Services and Instrument Data Level 2 subsetting. He received a B.S. Computer Science from CSU Pomona, and is currently pursuing M.S Computer Science  Steven J. Lewis is a member of the Information System and Computer Science staff member at the Jet Propulsion Laboratory.  He received a BS in Mathematics from the University of California, Los Angeles in June 2001, and the MS and Ph.D. Degree from Claremont Graduate University in May 2004 and May 2007, respectively.  He worked as a post doctoral fellow at Keck Graduate Institute from June 2007 until he joined JPL in March of 2008.  During his graduate and post doctoral work, his studies focused on applications of Bayesian methods to hidden Markov models with particular interest and application to protein sequencing.  His work at JPL has focused on integrating web services into various programming platforms for the purposes of accessing NASA satellite data, as well as developing object tracking so ftware and contributing to image enhancement and restoration efforts Van Dang is a member of the Science Data Understanding Group at the Jet Propulsion Laboratory. She was responsible for the NEWS Level 2 processing that generated the formal merged Level 2 data from multiple A-Train instruments  Manuel de la Torre is a Physicist from the Universidad Complutense at Madrid \(Spain\. After finishing his Ph.D work at the University of Bayreuth \(Germany\ on pattern formation in turbulent flows and a 7 1/2 year stunt as Ass and Assoc. Prof. at the Escuela T\351cnica Superior de Ingenieros Aeron\341uticos in Madrid \(Spain\, he came to the Jet Propulsion Laboratory on a 1-year Sabatical leave in 1997 wanting to apply fundamental concepts of nonlinear systems and geophysical fluid dynamics to something that might be directly useful to soci ety. He discovered the JPL as a great place to achieve that goal and extende d his stay a bit longer, becoming Technical staff and working on different aspects of remote sensing, validation of satellite instruments, and data analysis of atmospheric processes and climate  


