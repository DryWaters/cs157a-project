A Data Mining Based Algorithm for Traffic Network Flow Forecasting Xiaoyan Gong Laboratory of Complex Systems and Intelligence Sicence, Institute of Automation, Chinese Academy of Sciences Beijing China gxylsh@hotmail.com Abstract  Recent development in ITS Intelligent Transportation Systems methods and technologies has moved trafic operating systems from passive to pro active control and management where real-time and accurate traflc J7ow information is critical to actual implementation So far many 
algorithms hove been proposed for trafic network flow forecasting but problems in accuracy and timeliness still remain to be the major obstacle for their successful applications For example presumed human travel habit and vehicle turning probabilities at intersections have greatly limited the use of dynamic assignment algorithm In order to improve the forecasting and real-time responsiveness a new algorithm based on data mining which can do association rules mining and association analysis is proposed here for predicting traffic network flow 
Simulation results using Corsim 5.0 have demonstrated effectiveness of the new algorithm in both accuracy and timeliness Keywords ITS Traflc Network Forecasting Dynamic Assignment Algorithm Data Mining Association Analysis; Association Rules Mining  1 Introduction With development of ITS Intelligent Transportation Systems it is now changing gradually from passive responding system to active behavior system which highly depends on precise and real-time traffic network flow forecasting and single point flow forecasting Xiaoyan Gong, 2001 So far most of research attention is mainly 
put into single point flow forecasting while little in network flow forecasting Dynamic traffic assignment is the main previous approache for traffic network flow forecasting M Papageorgiou,l990 But because it needs OD matrix prediction and some presumptions such as vehicle turning probability of each intersection and people\222s route selection methods it cannot give accurate traffic condition prediction especially when accidents occurs somewhere because it just give regards to statistical and average factors of the traffic network but no accidental factors In 
Xiaoming Liu Laboratory of Complex Systems and Intelligence Sicence Institute of Automation Chinese Academy of Sciences Beijing China Ixm@sina.com addition long computation time is needed for its optimizing computation which greatly confmes its real application, even just in small traffic networks. Although several advanced algorithms Zhaosheng Yang 2000 such as dynamic traffic assignment model based on genetic algorithm is proposed it still cannot meet real time system requirements Since dynamic traffic assignment considers little accidental factors then NPR Non-Parametric Regression algorithm mlsson 
and Yakowitz 19871 a kind of data mining approaches can he used for each link flow forecasting in traffic network because it needs no mathematical modelling and thus no data loss that is to say accidental factors has been concemed in NPR In essence the approach locates the state of the system defmed by the independent variables in a 221neighbourhood\222 of past similar states Once this neighbourhood has been established, the past cases in the neighbourhood are used to estimate the 
value of the dependent variable. Recent researches pavis and Nihan    Gong 20021 have shown nonparametric regression to hold high potential to accurately forecast short-term traffic flows But if each link of traffic network adopts NF\222R then it cannot assure real-time ability although with high accuracy So some measures must be taken to increasing its real-time ability and in this paper a kind of system dimension decreasing method based on data mining is given So in this paper a new traffic network forecasting 
approaches based on data mining is addressed in order to realize predict veracity real-time ability and practicability In section 2 scheme of the whole traffic network algorithm is given and then sections from 3 to 5 present each step of the new algorithm in detail with a simulation example by COrSim5.0 In section 6 simulation test result is analyzed and in the last section some problems and comments are discussed  0-7803-7952-7/03/%17.00 0 2003 IEEE 1253 


2 Traffic Network Flow Forecasting Scheme Scheme of the traffic network flow forecasting algorithm is shown in Fig I There are five steps in this algorithm 1 The whole traffic network is divided into some sub-networks through association analysis among adjacent links in the network 2 In each sub-network association analysis among adjacent links is used to locate key link which has great relativity with other links 3 In each sub-network association rules mining algorithm is adopted to get association rules bemeen key link and other links 4 Put all the key links of the whole network into a vector NF'R algorithm is used to predict traffic flow values of all the key links in the network 5 With rules from step 3 deduce predict flow values of other links in each sub-network from its key link's predict flow value 3 Sub-networks Formation and Dete rmination of Key Links Based on Association Analysis The whole traffic network is divided into some sub networks through association analysis with equation I z x my  B 1 6 n 1-1 S.YS Yn  E 1  F 2 Y  B i-l I Here x  Ex xi  x 1 is traffic flow vector including whole day average flow with period of 5 minutes of link Lx  and y  cy y  y,r 1 is traffic flow vector of adjacent link Lu  are arithmetic average value of X and Y respectively Here an example by Conim 5.0 is shown in Fig 2 in which there is a loop highway network which is divided into eight links from L to L  and correlation coefficients through association analysis between each of two consecutively adjacent links is shown in Fig 3 The first point stands for the correlation coefficients between link L and link L  and second point for the correlation coefficients between link L and link L  and so do others From Fig 3 some gaps can find in the curves and they can become boundaries for division of traffic network Therefore three sub networks are made L with low correlation coefficients with L and L becomes a single sub network S  L  L  L and L  constitute a sub network Sz  and L  L and L  constitute the last sub network s3 Fig 3 Correlation Coefficients between Adjacent Links  L L2 L3 b Fig 4 Correlation Coefficients Distribution Then key links in each suh-network should be determined with the same method In the first sub network SI since it includes only one link L  then L becomes its key link S'k  In the second sub network S2 which includes L  L  L and L8 association analysis is used again Fig 4 shows correlation coefficients between L and L  L  L respectively L and L  L  L respectively  L and L  L  L respectively and L and L  L  L respectively After summing up these correlation coefficients groups L with biggest correlation coefficient becomes key link S'k of this sub network With same method L becomes key link S'k of sub network S  4 Associasion rules mining among key links and other links in sub-networks Association rules mining algorithm is fust proposed by Agrawal in 1993\(Agrawal 1993 and often used in commercial data analysis especially in supermarket commodity management Through association rules 1254 


mining clients purchasing habit can he well known and thus these purchasing rules can be considered in commodity ordering In order to use this method some conceptions in traffic lield should be transforms corresponding to conceptions in association rules mining.\(Xiaoyan Gong 2002 a Traffic flow v of key li L should be interpreted as a fuzzy variable   and its universe of discourse is I\221  100 300 500 700 900 1100 1300 14W 1500 1600 1700 1800 2000  and it takes seven linguistic values v1 very high y2 high x3 little high v4 moderate x5 little low y6 low y7 very low shown as in table 1 Traffic occupancy 0 of key link L should be interpreted as a fuzzy variable 0 its universe of discourse is and it takes seven linguistic values 0 very high g2 high 0 little high g4 moderate 0 little low  os low g7 very low shown as in table 2 Traffic flow v\221 of one of the other links L\222 of L should also be interpreted as a fuzzy variable 222 Its universe of discourse is 0  IO 20 30 40 SO 60 70 75 80 85 90 95 V 222 100 300 500 700 900 1100  1300 1400 1500 1600 1700 1800 2000  And it takes seven linguistic values Ll very high 222 high f little high g2 moderate  little low L6 low f7 very low shown as in table 3 Then each linguistic value of and 222 can be regarded as a kind of commodity in association rules minmg algorithm That is to say that commodity I 9!!2 3 4 I 5 a 747 221I E2 222 E3 222 3-4 v\222 v\222 5 6 VI 9 d7 canhemade b Then concurrence of traffic conditions in L and L\222 in terms of linguistic value can be seen as one transaction T  For example if traffic flow of link L is v very low traffic flow\while traffic flow of link L\221 is  v16 low traffic flow Then in this transaction T  commodities x7 and v\222 are bought at the same time All the transactions T comprises D  set of transactions in association rules mining algorithm c In association rules mining algorithm minsupport and minconfidence should he preset And minsupport is preset to be 50 while minconfidence is ranges from 70 to 80 But here in traffic flow forecasting in order to improve reasoning accuracy minsupport is preset to be 60 and minconfidence is preset to be from 80 to 90 Based on a b and c des that is the relationship between two adjacent links can be dig out with classical priori algorithm\(Agrawal,1993 4 shows an example of association rules between key IinkL and li L\221  Tab 4 Association Rules between Adjacent Links 1255 


key link S'k during the previous five-minute interval t-1 v t  s t  o 2  traffic volume average speed and average time occupancy of key link Siki during the current time interval ofhistorical average l.'S'kl,h t  1  SSIkl 0  1  OS'kl,h 2  1  traffic volume average speed and average time occupancy of key link S'k during previous interval of historical  average So does other factors in the traffic state vector historical record i to the current conditions can be written Fig 5 Predict Flow and Real Flow of Key Link S'k Using the state vector above, Euclidean distance from  as Equ 2  2 dist J[vYkl t Y'SW t    o t 2 f 2 And the forecast generation function is I d I d  Y r,il t  1  c v j$lki I 3 Here,d   1  K is nearest state vector number Fig 6 Predict Flow and Real Flow of Key Link v Cb  I  of current state vector Fig 5 Fig 6 and Fig 7 shows prediction traffic flow and real traffic -flow of these three keylinks Sikl,S2ki and'S'k Then based on association rules and predict flow values from 3  predict flow values of other links can be deduced For example Link L predict flow values deduced from values of link L is shown in Fig 8 It can be seen that accuracy of reasoning algorithm based on association rules isn't as good as NPR 6 Summary and Conclusions Table 5 shows the performance comparison between Dynamic Assignment algorithm new algorithm of this paper and NPR AAE stands for average absolute error and APE is Average percent error The results presented are for an Intel  Pentium Ill 600 MHz computer with 64 MB RAM running Windows 98 in command prompt mode with no other system demands While individual results may vary the fmdings are indicative of general performance Not only AAE and APE decrease a lot than Dynamic Assignment Algorithm, but also does Ex Time from 15s to 8s.Although it seems that Ex time is approximately the same for new algorithm and NPR, with increasing size of the network new algorithm will show its superiority over NPR in time consuming However, its predict accuracy isn't as good as NPR  ___ qm ILm      L  I  0 IPOS ins5 ius ias ias ins id bn  5x1 rul I rrcerr  __    _ Fig 7 Predict Flow and Real Flow of Key Link L I Fig 8 Predict Flow and Real Flow of Key Link Ea 1256 


Index ME  Ex Time\(m Dynamic Assignment 12 15 Proposed Algorithm 9 1.44 NPR 7.5 1.56   4 G.A.Davis N.L.Nlhan 223Nonparametric Regression and Short Term Freeway Traffic Forecasting\224 ASCE Jonrnal of Transportation Engineering 117\(2 pp 178-188 March 1991 SI B.L.Smith M.J.Demetsky 223Traffic Flow Forecasting Comparison of Modeling Approaches\224 Journal of Transportation Engineering 123\(4 pp 261-266,1997 6 Xiaoym Gong, Shuming Tang and Feiyue Wang 223Three Improvements on KNN-NPR for Short time Traffic Flow Forecasting\224 Proceeding of the IEEE 5th International Conference on ITS Singapore, September 2002 7 R Agrawal A.N Swami 223Mining Association Rules between Sets of Items in Large Databases\224 SIGMOD Conference, pp 207-216,1993 8 Xiaoysn Gong 223Study of Relationship among Adjacent Road Segments\224,accepted by Journal of Highway and Transportation research and development July 2002 highway network Sub-Network 1 S\222kl and S\222L  Slkl and S\222L rules reasoning rules reasoning Fig.1 Scheme of traffic network flow prediction algorithm based on data mining 1257 


Tab1 Value of Linguistic Variable v 0.2 1 i6 E7 0.7 1 0.7 0.2 0 0 0 0 0 0 00 0.8 0.6 0.4 0.2 0 0 0 0 0 000 1258 


Proceedings of the Third IEEE Internati onal Conference on Data Mining \(ICDM\22203 0-7695-1978-4/03 $ 17.00 \251 2003 IEEE 


Proceedings of the Third IEEE Internati onal Conference on Data Mining \(ICDM\22203 0-7695-1978-4/03 $ 17.00 \251 2003 IEEE 


Figure 8 Visual interface for Moridou system Search EngineTest Page 0 UI 0 5 5 Keyword plealet Figure 9 Prototype system in hcterogeneous environment 283 


6 Conclusions We presented MAFIA an algorithm for finding maximal frequent itemsets Our experimental results demonstrate that MAFIA consistently outperforms Depthproject by a factor of three to five on average The breakdown of the algorithmic components showed parent-equivalence pruning and dynamic reordering were quite beneficial in reducing the search space while relative compressiodprojection of the vertical bitmaps dramatically cuts the cost of counting supports of itemsets and increases the vertical scalability of MAFIA Acknowledgements We thank Ramesh Agarwal and Charu Aggarwal for discussing Depthproject and giving us advise on its implementation We also thank Jayant R Haritsa for his insightful comments on the MAFIA algorithm and Jiawei Han for providing us the executable of the FP-Tree algorithm This research was partly supported by an IBM Faculty Development Award and by a grant from Microsoft Research References I R Agarwal C Aggarwal and V V V Prasad A Tree Projection Algorithm for Generation of Frequent Itemsets Journal of Parallel and Distributed Computing special issue on high performance data mining to appear 2000 2 R Agrawal T Imielinski and R Srikant Mining association rules between sets of items in large databases SIGMOD May 1993  R Agrawal R Srikant Fast Algorithms for Mining Association Rules Proc of the 20th Int Conference on Very Large Databases Santiago Chile, Sept 1994  R Agrawal H Mannila R Srikant H Toivonen and A 1 Verkamo Fast Discovery of Association Rules Advances in Knowledge Discovery and Data Mining Chapter 12 AAAVMIT Press 1995 5 C C Aggarwal P S Yu Mining Large Itemsets for Association Rules Data Engineering Bulletin 21 1 23-31 1 998 6 C C Aggarwal P S Yu Online Generation of Association Rules. ICDE 1998: 402-41 1 7 R J Bayardo Efficiently mining long patterns from databases SICMOD 1998: 85-93 8 R J Bayardo and R Agrawal Mining the Most Interesting Rules SIGKDD 1999 145-154 9 S Brin R Motwani J D Ullman and S Tsur Dynamic itemset counting and implication rules for market basket data SIGMOD Record ACM Special Interest Group on Management of Data 26\(2\1997 IO B Dunkel and N Soparkar Data Organization and access for efficient data mining ICDE 1999 l 11 V Ganti J E Gehrke and R Ramakrishnan DEMON Mining and Monitoring Evolving Data. ICDE 2000: 439-448  121 D Gunopulos H Mannila and S Saluja Discovering All Most Specific Sentences by Randomized Algorithms ICDT 1997: 215-229 I31 J Han J Pei and Y Yin Mining Frequent Pattems without Candidate Generation SIGMOD Conference 2000 1  12 I41 M Holsheimer M L Kersten H Mannila and H.Toivonen A Perspective on Databases and Data Mining I51 W Lee and S J Stolfo Data mining approaches for intrusion detection Proceedings of the 7th USENIX Securiry Symposium 1998 I61 D I Lin and Z M Kedem Pincer search A new algorithm for discovering the maximum frequent sets Proc of the 6th Int Conference on Extending Database Technology EDBT Valencia Spain 1998 17 J.-L Lin M.H Dunham Mining Association Rules: Anti Skew Algorithms ICDE 1998 486-493 IS B Mobasher N Jain E H Han and J Srivastava Web mining Pattem discovery from world wide web transactions Technical Report TR-96050 Department of Computer Science University of Minnesota, Minneapolis, 1996 19 J S Park M.-S Chen P S Yu An Effective Hash Based Algorithm for Mining Association Rules SIGMOD Conference 20 N Pasquier Y Bastide R Taouil and L Lakhal Discovering frequent closed itemsets for association rules ICDT 99 398-416, Jerusalem Israel January 1999 21 J Pei J Han and R Mao CLOSET An efficient algorithm for mining frequent closed itemsets Proc of ACM SIGMOD DMKD Workshop Dallas TX May 2000 22 R Rastogi and K Shim Mining Optimized Association Rules with Categorical and Numeric Attributes ICDE 1998 Orlando, Florida, February 1998 23 L Rigoutsos and A Floratos Combinatorial pattem discovery in biological sequences The Teiresias algorithm Bioinfomatics 14 1 1998 55-67 24 R Rymon Search through Systematic Set Enumeration Proc Of Third Int'l Conf On Principles of Knowledge Representation and Reasoning 539 550 I992 25 A Savasere E Omiecinski and S Navathe An efficient algorithm for mining association rules in large databases 21st VLDB Conference 1995 26 P Shenoy J R Haritsa S Sudarshan G Bhalotia M Bawa and D Shah: Turbo-charging Vertical Mining of Large Databases SIGMOD Conference 2000: 22-33 27 R Srikant R Agrawal Mining Generalized Association Rules VLDB 1995 407-419 28 H Toivonen Sampling Large Databases for Association Rules VLDB 1996 134-145 29 K Wang Y He J Han Mining Frequent Itemsets Using Support Constraints VLDB 2000 43-52 30 G I Webb OPUS An efficient admissible algorithm for unordered search Journal of Artificial Intelligence Research 31 L Yip K K Loo B Kao D Cheung and C.K Cheng Lgen A Lattice-Based Candidate Set Generation Algorithm for I/O Efficient Association Rule Mining PAKDD 99 Beijing 1999 32 M J Zaki Scalable Algorithms for Association Mining IEEE Transactions on Knowledge and Data Engineering Vol 12 No 3 pp 372-390 May/June 2000 33 M. J. Zaki and C Hsiao CHARM An efficient algorithm for closed association rule mining RPI Technical Report 99-10 1999 KDD 1995: 150-155 1995 175-186 3~45-83 1996 452 


