Spatio-temporal Relationships and Video Object Extraction Yining Deng and B S Manjunath Department of Electrical and Computer Engineering University of California, Santa Barbara CA 93 106-9560  deng manj  iplab.ece.ucsb.edu Abstract An object-based representation for video data can facilitate video search and content analysis Detecting physical meaningful video object is a challenging open issue and requires intelligent spatio-temporal segmenta tion and tracking. Normally this is done through spatio temporal segmentation and region tracking In this work 
some of the practical issues of segmentation and tracking problems are addressed. Due to the limitation of using low level visual features in the segmentation the tracked regions are more likely to be fragmented parts of some meaningful objects. Howevel if a collection of video shots that contain a particular object of interest are given, spa tio-temporal correlations would exist between the neigh boring regions of the object A method of mining association rules is used to discover these patterns and thus to find possible objects in the scene. Initial experimen tal results of this approach are shown 1 Introduction 
The rapid developments in multimedia and internet applications allow us to conveniently access large amounts of video data in the new digital format One can now download news and movie clips directly from the internet and watch the movies on digital versatile discs DVD which provide much clearer pictures than the traditional video tapes While there is significant progress in compres sion to represent the video in compact form for storage and transmission, functionalities that come with the digital video have not been fully exploited For example, finding desired information in a video clip or 
in a video database is still a difficult and laborious task There is a growing need for new representations of video that allow not only com pact storage of data but also content-based functionalities such as search and manipulation of objects semantic description of scenes, detection of unusual events or rec ognition of objects A video clip whether in raw format or in one of the current compression standards, is a binary stream not well organized in terms of its clontent As a first step toward bet 
ter organization of data, the video clip is parsed in tempo ral domain into short video shots. Within each shot the visual appearance of the scene is consistent and the parti tioning points are often camera breaks or editing cuts A video shot can be considered as a basic unit of video data Global image features such as color, texture and motion can be extracted and used for search and retrieval of similar video shots Most of the video content-based retrieval sys tems have been using this kind of approach I 6 9 IO 
The above approach however provides very limited video information and can not answer simple questions such as 223what kind of things are in the video\224 In order to further exploit the video content a video shot needs to be decomposed into objects so that search, retrieval and con tent manipulation based on object characteristics activi ties and relationships is possible Although this could be done manually such as in the work of 2 the lengthy and tedious laboring makes it impossible in many applications In our 
previous work 7 an object-based representation is proposed for search and retrieval of video objects. Practical issues of using automatic spatio-temporal segmentation and region tracking to extract video objects are addressed There are a few systems reported recently that have also proposed similar approaches  141  161 However the disad vantage problem arises due to the limitation of using low level visual features in the segmentation The extracted components are more likely to be segments of meaningful objects and their direct usefulness is limited It is possible to extract the meaningful objects given the knowledge 
of a constraint environment. For example in  121 knowledge of a player\222s size and the color of a soccer field is assumed to identify the players and the ball in a soccer video database In 8 moving objects are extracted 111[131[151 based on the assumption that the background is static and the objects are relatively small compared to the back ground. These facts allow the background registration This work was supported in part by an award from Samsung Electronics 0-7803-5 148-7/98/$10.0001998 IEEE 895 


when the camera is moving and also imply motion coher ence for each object. Although a similar motion coherence constraint can be used on those fragmented regions it is in general not true that parts of a non-rigid object will undergo the same motion when the object appears large in the scene. Moreover if the objects are in a changing back ground, the task of identify objects in the video scene is very difficult In this work we approach the problem from a database perspective If a collection of video shots that contain a particular object of interest are given spatio-temporal cor relations would exist between the neighboring regions of the object A method of mining association rules 4 is pro posed to discover these patterns and thus find possible objects in the scene. This kind of approach has also been used in image retrieval 3 It is to be noted that although the approach is to explore the spatio-temporal relationships in the video our objective is different from the traditional sense where the objects are known and relationships among the objects are being sought, such as in 2 5 and 121 In the next section a summary of our previous work on spatio-temporal segmentation and region tracking is given Section 3 describes the method of mining association rules and the application to the object extraction problem Sec tion 4 provides results and discussions 2 Segmentation and Tracking 2.1 Spatio-temporal Segmentation General Scheme Reliable spatio-temporal segmenta tion of objects is a difficult problem One of the popular approaches is to use optical flow method which has the following drawbacks It does not work well with large motion Regions of coherent motion may contain multiple objects and need further segmentation for object extraction for example a person riding a horse To overcome these drawbacks it is important to incor porate spatial information into motion segmentation One feasible approach is to spatially segment the first frame to obtain initial segmentation results and then motion seg ment subsequent frames using affine region matching There are several advantages of doing this  Multiple objects with the same motion are separated by spatial segmentation These objects can still be merged together for analysis if necessary after motion estimation Affine region matching is a more reliable way of esti mating motion than optical flow methods and there are some fast numerical methods proposed to estimate the affine motion parameters Problems remain for this approach to work in practice The new objects entering the scene and the propagation error due to affine region matching must be handled In the following we propose to use a group processing scheme similar to the one employed in MPEG-2 to refresh the spa tial segmentation and ensure the robustness of the algo rithm Video data is processed in consecutive groups of frames These groups are non-overlapping and independent of each other The best value for the number of frames in a group depends on object motion activities in the video data There is one I-frame in each group which is spatially segmented first. Starting from the I-frame, the rest of the frames in the group are segmented consecutively by affine matching the segmented regions to their next frame. These motion segmented frames are called P-frames Motion Segmentation After spatial segmentation a 6 parameter 2D affine transformation is assumed for each region in the frame and is estimated by finding the best match in the next frame Consequently segmenta tion results for the next frame is obtained The follow ing functional f is to be minimized for each region R where a is a six-parameter affine motion vector g is a robust error norm to reject outliers I and Z are the current frame and the next frame respectively x and y are pixel locations x  x  dx and y  y  dy  dx and dy are dis placement vectors The minimization off can be carried out iteratively by gradient based methods This requires the cost function to be convex in affine space to guarantee convergence to the global minimum We assume this to be true in the vicinity of the actual affine parameter values Thus a good initial ization is needed before starting the iterations In the case that affine parameters of the previous frame are known we can make a first-order assumption that the region is going to keep the same motion and use the affine parameters of the previous frame as the initial values for the current frame For the first frame to be segmented by motion pre diction in each group, whose previous frame is an I-frame a hierarchical search is performed to obtain the best initial affine parameters 2.2 Region Tracking After segmentation, regions in the video frames are tracked to locate object movements The processes of tracking and local feature extraction are closely related One advantage of using the proposed segmentation scheme is that the problem of region tracking is simplified There 896 


are two types of region tracking intra-group region track ing and inter-group region tracking. Within each group region tracking is already done during the segmentation This accoucts for most of the frames in the video and reduces the complexity of tracking The remaining prob lem is to track regions across two adjacent groups. Because the regions could differ significantly in two groups due to large object motion it is impossible to match all the regions between the two groups. Therefore we do not attempt to match every region in the current group to the regions in the next group The I-frame is the representing frame of each group The tracking is performed between consecutive I-frames by comparing similarity between regions in the two frames using extracted local features including color, texture size and location. Motion features are used to predict region locations For a region R in the current I-frame, the steps for finding the matching region in the next I-frame are as follows Correlations would exist between the neighboring seg mented regions such that certain regions tend to appear together at the same time If this kind of pattern is found it can be inferred that these regions could belong to the same object Several conditions are required for this idea to work in practice The visual appearance of the object such as the color information, remains the same in the database The visual appearance of the background on the other hand varies from shot to shot The object is distinguishable from the background i.e the background does not have the same color or texture as the object To find the spatio-temporal correlations of the neigh boring regions the method of mining association rules is used. In the following, the concept of association rules and how to discover the rules will be explained 3.1 Mining Association Rules For every region in the next I-frame the size and tex ture differences with R are calculated If they are less than the preset thresholds the region is considered as a candidate match Affine motion is estimated to predict the approximate location of R in the next I-frame The distance between the location of a candidate region and the predicted location of R is calculated and is denoted by d  The color feature distance between a candidate region and R is weighted by 1  W,d where W is a con stant That is the further away a candidate region the less likely that it will be the true match The particular weighting by location difference is needed because there might be some objects nearby with similar color Let I  il i  im be a set of items. Let D be a texture, and size The candidate regions are ranked in terms of d  The region having the minimum value is determined to be the match for R 3 Spatio-temporal Relationships The problem of the above approach is that segmenta tion based on low-level visual features usually results in many fragmented regions As can be seen from the exam ples in Fig 1 one cause of fragmentation is that an object contains multiple parts of different colors, for example Miss America\222s body in a and the table in b\Another cause is due to the shades created by the lighting condi tions for example the hair in a and the arm in b The also makes the tracking results less useful In this work we approach this problem from a database perspective Suppose the database consists of a collection of video shots that contain a particular object of interest fragmentation not only causes difficulty in tracking but b Fig 1 Segmentation results of a 223Miss America\224 sequence frame 130 b 223table tennis\224 sequence frame 0 897 


set of events where each event Tis a set of items such that T D Let X be a set of items An event Tis said to con tain X if and only if X  T An association rule is an implication of the form X  Y  where X c I Y E I and X n Y   The rule X 3 Y holds in the event set D with conjidence c if c of events in D that contain X also contain I The rule X  Y has supports in the event set D ifs of events in D contain X v Y Conjidence denotes the strength of implication and support indicates the fre quencies of the occurring patterns in the rule Confidence c is in fact a measure of conditional probability P Y IX  Rules with high confidence and strong support are referred as strong rules Although it is quite a simple concept discovering strong rules in large databases is not an easy task The problem is usually decomposed into two steps 1 Discover the large itemsets i.e the itemsets that have strong support in the database 2 Use the large itemsets to generate the association rules Clearly Step I is much more critical and algorithms have been proposed 4 for efficient counting of large itemsets A common approach is to start with large 1-itemsets i.e the itemsets that contain only 1 item, and then increase the number of items to k to discover large k-itemsets 3.2 Application to Object Extraction In order to discover the spatio-temporal correlations of the neighboring regions the method of mining association rules is first applied to the segmented regions within each video shot The discovered rules are then verified over a collection of shots in the database Shot Level The procedures for rule discovery at shot level are summarized as follows 1 obtaining the database items  The segmented regions can not be used directly yet because they are not in the sense of database items mentioned earlier These regions need to be classified and each class of regions is considered as an item The k-means algorithm is used to cluster the regions based on their low-level fea tures The average number of regions per frame in the video shot is chosen as the initial number of classes. An agglomerative clustering algorithm is used later to fur ther merge close clusters 2 finding the large I-itemsets  To remove outliers due to segmentation failure or over-segmentation if the dis tance between the region feature and its cluster centroid is too large the region is removed and the centroid is recalculated to obtain the feature for that class The class size is defined to be the number of the regions in the class This number is counted for each class. Simul taneous occurrences of a class in a video frame are counted only once If the number exceeds 70 sup port of the number of frames in the video shot the class is considered as a large 1-itemset otherwise the class is discarded 3 jinding the large 2-itemsets  The neighboring relation ships of the classes are determined here The number of occurrences of two classes being neighboring to each other is counted. Again simultaneous occurrences in a video frame are counted once If the number exceeds 70 support of the number of the frames in the video shot the two classes are considered to be neighbors to each other and a large 2-itemset is found 4 discovering the strong rules  For each class, the size of each neighboring class is checked to see if it exceeds 80 of the size of that class. If true an association rule is stored. Else, that neighbor is removed from the list of the neighbors DatabaseLevel It is quite likely that within a given video shot the background may remain constant In such cases, the discovered association rules can imply false cor relations between the objects and the background This can be verified and removed by analyzing over a collection of video shots where the background is different 1 jinding the classes in interest  For each class in a video shot if similar classes can be found in other shots the class is considered as a possible part of an object in interest The similarity is measured based on class fea tures calculated at shot level 2 verifying the association rules  For each class of inter est, its neighboring classes are compared with the ones of similar classes in other video shots. If the number of classes containing a similar neighbor exceeds 60 of the number of video shots the association rule is con sidered to be significant. Regions that possibly belong to a same object are then identified 4 Results and Discussions Initial experiments have been carried out on a collec tion of 9 cartoon video shots, which all contain a specific animal The video is at a rate of 30 frame/sec and the aver age number of frames in the video shots is about 114 There are a total of 28821 segmented regions and 124 classes with strong support in the entire collection. Region color features are used in the mining association rule dis covery There are 11 rules discovered in 6 of these 9 shots Table 1 summarizes the results where in the third case a background region with similar colors is merged into the same class of an object part such that the class contains both the object part and the background region It can be seen from the results that the discovered rules capture a certain degree of spatio-temporal correlations between the object regions Fig 2 shows two examples of 898 


Table 1  Discovered Strong Associated Rules both are parts of the object correct rules a part of the object  a background region number lof rules I actual relationships between the classes 4 2 I a part of the object  object and background I 2 I I both are background regions 131 discovered associated regions In a a correct associated rule that identifies the main and the front bodies of an ani mal is found In b the same rule is discovered but the front body is mixed up with a background region as the same class The false alarms and the misses are mainly due to the fact that required conditions mentioned before are not met The object appearance actually varies from shot to shot under different lighting conditions Some of the back ground colors appear almost in all the video shots. Also there are cases where the background regions are very sim b Fig 2 Pairs of the associated regions The two object parts discovered are the main and the front bodies of an animal ilar to the object parts Note that these situations happen in practice and will cause problems in object extraction even when the prior knowledge of the object such as the color information is known Adding the region motion informa tion to cross check the results could possibly eliminate some of the false alarms 5 References I E Ardizzone, M.L C.ascia 223Multifeature image and video content-based storage and retrieval\224 Proc of SPIE vol 291 6 p 2 A.B Bimbo E Vicario and D Zingoni, \223Symbolic descrip tion and visual querying of image sequences using spatio-tempo ral logic\224 IEEE Trans on knowledge and Data Engineering vol 7 no 4 p 609-22 Aug 1995 3 M Bouet and C Djer\(aba 223Powerful image organization in visual retrieval systems\224 Proc ACM Multimedia 1998  M.-S Chen J Han arid P.S Yu 223Data mining an overview from a database perspective\224 IEEE Trans on Knowledge and Data Engineering vol 8 n0.6 p 866-83, Dec., 1996 5 Y E Day et al 223Spatio-temporal modeling of video data for on-line object-oriented query processing\224 Proc of IEEE Intl Con Multimedia Computing und Systems p 98-105, 1995 6 Y Deng and B.S Manjunath 223Content-based Search of Video Using Color, Texture and Motion\224 Proc. of ICIP vol 2 p 7 Y Deng and B.S Manjunath 223NeTra-V: toward an object based video representation\224 IEEE Trans on Circuits and Systems for Video Technology vol 8 no 5 p 616-27 Sep 1998 8 G Halevi and D Weinshall 223Motion of disturbances: detec tion and tracking of multi-body non-rigid motion\224 Proc of 191 A Hampapur et. al 223Virage video engine\224 Proc of SPIE IO G Iyengar and A.B.Lippman, \223Videobook an experiment in characterization of Video\224 Proc of ICIP 01.3 p 855-58, 1996 I I V Kobla, D Doermann and K Lin 223Archiving, indexing and retrieval of video in the compressed domain\224 Proc of SPIE  121 A Yoshitaka et.al 223Content-based retrieval of video data based on spatiotemporal correlation of objects\224 Proc of IEEE Intl Cant Multimedia Computing and Systems p 208 13 1998 I31 H.J Zhang J Wu D Zhong and S.W Smolliar 223An inte grated system for content-based video retrieval and browsing\224 Pattern Recognition vol 30 no 4 p 643-58, 1997 I41 H.J Zhang J Y.A Wang and Y Altunbasak 223Content based video retrieval and compression a unified solution\224 Proc ofICIP vol 1 p 13-16, 1997 I51 D Zhong H.J. Zhang and S-E Chang, \223Clustering methods for video browsing and annotation\224 Proc SPIE vol 2670 p I61 D Zhong and S.F Chang 223Spatio-temporal video search using the object based video representation\224 Proc of ICIl vol 1 265-276, 1996 534-37, 1997 CVPR p 897-902, 1997 vol 3022 p 188-200, 1997 vol 2916 p 78-89 1996 239-40, 1996 p 21-24, 1997 899 


504 CONCLUSION Development of a Fuzzy Expert System on the design of ARD remediation plans has been successful. The system has the following benefits     Future expansion of this system will include ARD predictions based on expertise derived from case studies of existing sites. These predictions will be used as inputs to the existing system a comprehensive, logical organization of the design methodologies has been developed a consistent design philosophy can be generated by use of this system a training tool has been created to assist in the transfer of ARD technology to the industry economic and effective procedures to use for a wide variety of site problems are available ACKOWLEDGEMENT The authors acknowledge financial support from the National Research Council through IRAP Grant No 304695 We are also gratehl for travel support from the Faculty of Graduate Studies and Research at UBC REFERENCES  1 2 3 4  5 6 7 8 R.W. Lawrence A MacG. Robertson 1994 Acid rock drainage Understanding the problems  finding solutions CIM District 6 Annual General Meeting, Workshop No 1 L Filipek, A. Kirk, W. Schafer 1996. Control Technologies for ARD Mining Environment Management, Dec, 4-8 A. Bowen 1995 Expert systems Truth and Rumors Canadian Mining J Mining Sourcebook, 8-12 J.A Meech C.A Harris 1992 Expert Systems for Gold Processing Plants Randol Gold Forum Vancouver B.C 3 1-39 J.A Meech 1995 AI Applications in the Mining Industry into the 21 Century APCOM XXV Conference 93 10 1 MEND 1995 Economic Evaluation of Acid Mine Drainage Technologies. MEND Report 5.8.1 Marshall, Swift, 1999. Marshall  Swift Equipment Cost Index. Chemical Engineering 106\(3 170 M Ghomshei A Holmes E. Denholm R Lawrence T Carriou 1997. Acid Rock Drainage from the Samatosum Waste Dump, B.C Canada Proc 4'h Inter Conf on Acid Rock Drainage 1 35 1-366 


Any Course introduction lntmductian Programming Information Artificial Programming Unix Data Design and Analysis User Neural Compilers tu Computers to Unix in rascal Systems Intelligence in C Platform Communications of Algon\222thms Interfaces Nehvorkr Figure 4 Course hierarchy It should be noted that sometimes considerable amounts of rules remain even when the user has found the desired focus with the described methods Automatic pruning sorting and structuring methods should at this point be available for invocation by the user especially for removal of redundancy see e.g 15 for rule covers statistical methods and cluster ing 5 Application Experience TASA has been in prototype iise in foiir telecom munication companies since the beginning of 1995 and experiences are encouraging A telecommunica tion network manager can use episode rules as correl ation patterns after possibly editing them and assign ing them appropriate correlation actions Discovered patterns can be used for filtering uninformative alarms for combining alarms to construct hypothesis of faults or for prediction of faults Episode and association rules are also useful for providing different views to the analyzed alarms as in Example 3 Although the discovery algorithms are not directly applicable for on-line analysis TASA has turned out to be useful also in network surveillance The analysis can be rerun or augmented e.g every day or every hour Recent patterns may point to yet unnoticed problems in the network The fault management experts in the telecommunic ation companies have found the approach and TASA useful in, e.g 0 finding long-term, rather frequently occurring de 0 creating an overview of a short-term alarm se 0 evaluating the alarm data base consistency and pendencies quence and correctness On the other hand many of the rules discovered by TASA are deemed trivial by the network managers Luckily much of the trivial knowledge can be ex pressed and removed with templates Example 4 Consider an alarm correlation system which operates in real time and is also able to handle delayed alarms and slightly inaccurate time stamps In the correlation patterns delays are handled with a spe cial wait function Episode and assocaataon rules can be applaed an this system in a rather straightforward way The episode rule IF THEB high fault rate WITH SI SO conf\(0.70 freq\(700/1000 link alarm  link failure discovered by TASA can be coded in the system as fol lows  if 223alarm type  link alarm\224 then start time wait until \223alarm type  link failure\224 or LLtime  5 sec\224 f 223alarm type  link failure\224 then display warning \223high fault rate with 70 probability in 60 sec\224 else forward the original alarm That is if a link alarm occurs and a link failure follows within 5 seconds the rule right-hand side information is sent and the original alarms are suppressed If a link failure does not follow 221wzthin 5 seconds the 07.2 ginal link ularm is forwarded The correlation procedure can be enhanced using as sociation rules For example assume that we have de tccted that if the alarm type is link alarm the time of the day is ofice hours and alarm severity is I then with probability of 95 the alarming element type is BS After expert evaluation of the rule we know that such alarms from network elements of type BS can be ignored However if an element of any other type sends that alarm it is an interesting one The following correlation function removes such alarms  if 223alarm type  link alarm\224 and 223office hours\224 and 223severity  1\224 and 221\221element type  BS\224 then exit forward the original alarm 0 Unexpected but useful dependencies have been found e.g between network elements which are not immediately connected in the network topology Be ginning from the first tests discovered rules have been applied in alarm correlation systems 676 


6 Conclusion We have described a knowledge discovery method ology that can be used to automate knowledge acquis ition The methodology has the following two distinct ive characteristics 1 a large collection of potentially relevant rules is discovered at once and 2 different views can be formed on the discovered rules iteratively and interactively The motivation is that after the dis covery of all potentially interesting rules iteration is very efficient As an example application area we descibed tele communication networks alarm data The flow of alarms should be correlated automatically to a more in telligible form in order to facilitate identification and correction of faults Unfortunately the construction of an alarm correlation system requires a lot of both expertise and time and is a process that never is com plete Our experience in this field with both association and episode rules supports the claim that the meth odology is useful in practice For formalisms stronger than association and episode rules strong focus in the pattern discovery phase may be essential for keeping the computation tractable For well-defined problems this is probably fine but for exploring regularities in large data sets the interaction may be cumbersome References 1 R Agrawal T Imielinski and A Swami Mining as sociation rules between sets of items in large data bases In Proceedings of AGM SIGMOD Conference on Management of Data SIGMOD\22293 pp 207  216 May 1993 a R Agrawal H Mannila R Srikant H Toivonen and I Verkamo Fast discovery of association rules. In Advances in Knowledge Discovery and Data Mining pp 307  328 AAAI Press Menlo Park CA 1996 31 R Brachman and T Anand The process of know ledge discovery in databases A first sketch. In Know ledge Discovery in Databases, Papers from the 1994 AAA I Workshop IcDD\22294 July 1994 4 U Fayyad G Piatetsky-Shapiro and P Smyth The KDD process for extracting useful knowledge from volumes of data Communications of the ACM 39\(11  34 November 1996 5 U Fayyad G Piatetsky-Shapiro and P Smyth From data mining to knowledge discovery An overview In Advances in Knowledge Discovery and Data Mining pp 1-34 AAA1 Press Menlo Park CA 1996 6 R Goodman B Ambrose H Latin and C Ulmer Noaa  an expert system managing the telephone network In Integrated Network Management IV pp 316  327 Chapman  Hall London 1995 7 K Hatonen M Klemettinen H Mannila P Ronkainen and H Toivonen Knowledge discov ery from telecommunication network alarm data bases In 12th Int\222l Conference on Data Engineering ICDE\22296 pp 115  122 New Orleans Louisiana February 1996 SI G Jakobson and M. Weissman Alarm correlation. In IEEE Network 7\(6  59 November 1993 9 W Kloesgen Efficient discovery of interesting state ments in databases Journal of Intelligent Informa tion Systems 4\( 1  69 1995 lo M Klemettinen H Mannila P Ronkainen H Toivonen and I Verkamo Finding interesting rules from large sets of discovered association rules In Pro ceedings of the Third Int\222l Conference on Information and Knowledge Management CIKM\22294 pp 401  407 Gaithersburg MD November 1994 ACM 111 C Matheus G Piatetsky-Shapiro and D McNeill Selecting and reporting what is interesting In Ad vances in Knowledge Discovery and Data Mining pp 495  515 AAA1 Press Menlo Park CA 1996 121 H Mannila and H Toivonen Discovering generalized episodes using minimal occurrences In Proceedings of the Second Int\222l Conference on Knowledge Discovery and Data Mining \(KDD\22296 pp 146  151 Portland Oregon August 1996 AAAI Press 13 H Mannila and H Toivonen On an algorithm for finding all interesting sentences In Cybernetics and Systems Volume II The Thirteenth European Meet ing on Cybernetics and Systems Research pages 973  978 Vienna Austria April 1996 Austrian Society for Cybernetic Studies 14 H Mannila H Toivonen and I Verkamo Discov ering frequent episodes in sequences In Proceedings of the First Int\222l Conference on Knowledge Discovery and Data Mining I<DD\22295 pp 210  215 Montreal Canada August 1995 AAA1 Press 15 H Toivonen M Klemettinen P Ronkainen K Hatonen and H Mannila Pruning and grouping of discovered association rules In Workshop Notes of the ECML-95 Workshop on Statistics Machine Learning and Knowledge Discovery in Databases pp 47  52 Heraklion Greece April 1995 MLnet 16 R Zembowicz and J Zytkow From contingency tables to various forms of knowledge in databases In Advances in Knowledge Discovery and Data Mining pp 329  349 AAAI Press Menlo Park CA 1996 677 


In Figures 10 and 11 we see MAFIA is approximately four to five times faster than Depthproject on both the Connect-4 and Mushroom datasets for all support levels tested down to 10 support in Connect-4 and 0.1 in Mushroom For Connect-4 the increased efficiency of itemset generation and support counting in MAFIA versus Depthproject explains the improvement Connect 4 contains an order of magnitude more transactions than the other two datasets 67,557 transactions amplifying the MAFIA advantage in generation and counting For Mushroom the improvement is best explained by how often parent-equivalence pruning PEP holds especially for the lowest supports tested The dramatic effect PEP has on reducing the number of itemsets generated and counted is shown in Table 1 The entries in the table are the reduction factors due to PEP in the presence of all other pruning methods for the first eight levels of the tree The reduction factor is defined as  itemsets counted at depth k without PEP   itemsets counted at depth k with PEP In the first four levels Mushroom has the greatest reduction in number of itemsets generated and counted This leads to a much greater reduction in the overall search space than for the other datasets since the reduction is so great at highest levels of the tree In Figure 12 we see that MAFIA is only a factor of two better than Depthproject on the dataset Chess The extremely low number of transactions in Chess 3196 transactions and the small number of frequent 1-items at low supports only 54 at lowest tested support muted the factors that MAFIA relies on to improve over Depthproject Table 1 shows the reduction in itemsets using PEP for Chess was about an order of magnitude lower compared to the other two data sets for all depths To test the counting conjecture we ran an experiment that vertically scaled the Chess dataset and fixed the support at 50 This keeps the search space constant while varying only the generation and counting efficiency differences between MAFIA and Depthproject The result is shown in Figure 13 We notice both algorithms scale linearly with the database size but MAFIA is about five times faster than Depthproject Similar results were found for the other datasets as well Thus we see MAFIA scales very well with the number of transactions 5.3 Effects Of Compression To isolate the effect of the compression schema on performance experiments with varying rebuilding threshold values we conducted The most interesting result is on a scaled version of Connect-4, displayed in Figure 14 The Connect-4 dataset was scaled vertically three times so the total number of transactions is approximately 200,000 Three different values for rebuilding-threshold were used 0 corresponding to no compression 1 compression immediately and all subsequent operations performed on compressed bitmaps\and an optimized value determined empirically We see for higher supports above 40 compression has a negligible effect but at the lowest supports compression can be quite beneficial e.g at 10 support compression yields an improvement factor of 3.6 However the small difference between compressing immediately and finding an optimal compression point is not so easily explained The greatest savings here is only 11 at the lowest support of Conenct-4 tested We performed another experiment where the support was fixed and the Connect-4 dataset was scaled vertically The results appear in Figure 15 The x-axis shows the scale up factor while the y-axis displays the running times We can see that the optimal compression scales the best For many transactions \(over IO6 the optimal re/-threshold outperforms compressing everywhere by approximately 35 In any case both forms of compression scale much better than no compression Compression on Scaled ConnectAdata Compression Scaleup Connectldata ALL COMP 0 5 10 15 20 25 30 100 90 80 70 60 50 40 30 20 10 0 Min Support  Scaleup Factor Figure 14 Figure 15 45 1 


6 Conclusions We presented MAFIA an algorithm for finding maximal frequent itemsets Our experimental results demonstrate that MAFIA consistently outperforms Depthproject by a factor of three to five on average The breakdown of the algorithmic components showed parent-equivalence pruning and dynamic reordering were quite beneficial in reducing the search space while relative compressiodprojection of the vertical bitmaps dramatically cuts the cost of counting supports of itemsets and increases the vertical scalability of MAFIA Acknowledgements We thank Ramesh Agarwal and Charu Aggarwal for discussing Depthproject and giving us advise on its implementation We also thank Jayant R Haritsa for his insightful comments on the MAFIA algorithm and Jiawei Han for providing us the executable of the FP-Tree algorithm This research was partly supported by an IBM Faculty Development Award and by a grant from Microsoft Research References I R Agarwal C Aggarwal and V V V Prasad A Tree Projection Algorithm for Generation of Frequent Itemsets Journal of Parallel and Distributed Computing special issue on high performance data mining to appear 2000 2 R Agrawal T Imielinski and R Srikant Mining association rules between sets of items in large databases SIGMOD May 1993  R Agrawal R Srikant Fast Algorithms for Mining Association Rules Proc of the 20th Int Conference on Very Large Databases Santiago Chile, Sept 1994  R Agrawal H Mannila R Srikant H Toivonen and A 1 Verkamo Fast Discovery of Association Rules Advances in Knowledge Discovery and Data Mining Chapter 12 AAAVMIT Press 1995 5 C C Aggarwal P S Yu Mining Large Itemsets for Association Rules Data Engineering Bulletin 21 1 23-31 1 998 6 C C Aggarwal P S Yu Online Generation of Association Rules. ICDE 1998: 402-41 1 7 R J Bayardo Efficiently mining long patterns from databases SICMOD 1998: 85-93 8 R J Bayardo and R Agrawal Mining the Most Interesting Rules SIGKDD 1999 145-154 9 S Brin R Motwani J D Ullman and S Tsur Dynamic itemset counting and implication rules for market basket data SIGMOD Record ACM Special Interest Group on Management of Data 26\(2\1997 IO B Dunkel and N Soparkar Data Organization and access for efficient data mining ICDE 1999 l 11 V Ganti J E Gehrke and R Ramakrishnan DEMON Mining and Monitoring Evolving Data. ICDE 2000: 439-448  121 D Gunopulos H Mannila and S Saluja Discovering All Most Specific Sentences by Randomized Algorithms ICDT 1997: 215-229 I31 J Han J Pei and Y Yin Mining Frequent Pattems without Candidate Generation SIGMOD Conference 2000 1  12 I41 M Holsheimer M L Kersten H Mannila and H.Toivonen A Perspective on Databases and Data Mining I51 W Lee and S J Stolfo Data mining approaches for intrusion detection Proceedings of the 7th USENIX Securiry Symposium 1998 I61 D I Lin and Z M Kedem Pincer search A new algorithm for discovering the maximum frequent sets Proc of the 6th Int Conference on Extending Database Technology EDBT Valencia Spain 1998 17 J.-L Lin M.H Dunham Mining Association Rules: Anti Skew Algorithms ICDE 1998 486-493 IS B Mobasher N Jain E H Han and J Srivastava Web mining Pattem discovery from world wide web transactions Technical Report TR-96050 Department of Computer Science University of Minnesota, Minneapolis, 1996 19 J S Park M.-S Chen P S Yu An Effective Hash Based Algorithm for Mining Association Rules SIGMOD Conference 20 N Pasquier Y Bastide R Taouil and L Lakhal Discovering frequent closed itemsets for association rules ICDT 99 398-416, Jerusalem Israel January 1999 21 J Pei J Han and R Mao CLOSET An efficient algorithm for mining frequent closed itemsets Proc of ACM SIGMOD DMKD Workshop Dallas TX May 2000 22 R Rastogi and K Shim Mining Optimized Association Rules with Categorical and Numeric Attributes ICDE 1998 Orlando, Florida, February 1998 23 L Rigoutsos and A Floratos Combinatorial pattem discovery in biological sequences The Teiresias algorithm Bioinfomatics 14 1 1998 55-67 24 R Rymon Search through Systematic Set Enumeration Proc Of Third Int'l Conf On Principles of Knowledge Representation and Reasoning 539 550 I992 25 A Savasere E Omiecinski and S Navathe An efficient algorithm for mining association rules in large databases 21st VLDB Conference 1995 26 P Shenoy J R Haritsa S Sudarshan G Bhalotia M Bawa and D Shah: Turbo-charging Vertical Mining of Large Databases SIGMOD Conference 2000: 22-33 27 R Srikant R Agrawal Mining Generalized Association Rules VLDB 1995 407-419 28 H Toivonen Sampling Large Databases for Association Rules VLDB 1996 134-145 29 K Wang Y He J Han Mining Frequent Itemsets Using Support Constraints VLDB 2000 43-52 30 G I Webb OPUS An efficient admissible algorithm for unordered search Journal of Artificial Intelligence Research 31 L Yip K K Loo B Kao D Cheung and C.K Cheng Lgen A Lattice-Based Candidate Set Generation Algorithm for I/O Efficient Association Rule Mining PAKDD 99 Beijing 1999 32 M J Zaki Scalable Algorithms for Association Mining IEEE Transactions on Knowledge and Data Engineering Vol 12 No 3 pp 372-390 May/June 2000 33 M. J. Zaki and C Hsiao CHARM An efficient algorithm for closed association rule mining RPI Technical Report 99-10 1999 KDD 1995: 150-155 1995 175-186 3~45-83 1996 452 


