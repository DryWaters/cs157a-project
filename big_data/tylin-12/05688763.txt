A Study of Intrusion Detection System Based on Data Mining Chunyu Miao College of Xingzhi Zhejiang Normal University Jinhua Zhejiang  China E-mail: netmcy@zjnu.cn Wei Chen College of Mathematics , Physics and Information Engineering Zhejiang Normal University Jinhua Zhejiang  China E-mail: chen_wei@zjnu.cn Abstract In this paper, classifications of intrusion detection and methods of data mining appl ied on them were introduced Then, intrusion detection system design and implementation of based on data mining were presented. Such a system used APRIORI algorithm to analyse data association, which is the most influencing algorithm in mining Boolean association rules continuity item muster, with recurrence arithmetic based on idea of two period continuity item muster as core Experiments showed that new type of attack can be detected effectively in the system, and knowledge base can be updated automatically, so the efficiency and accuracy of the intrusion detection were improved, and security of the network was enhanced Keywords-network security; data mining; intrusion detection II NTRODUCTION With the network playing more and more important effect in the modern society, crimes using computer network are presenting the obvious trend of escalation. How to establish a safe and strong network system and guarantee the security of important information has already become research focus. Formerly, ma ny ways used is the firewall policy, it might prevent from many kinds of attacks, such as using the protocol weakness, the source route, the address counterfeited, and so on, and provide safe data channel. But it could do nothing about the back door in application layer the attack or stealing caused by authority exceeding of internal user and the information damaging. Moreover because the firewall was at the network boundary, its own design flaws are ine vitably exposed to attackers, firewall only is hard to resist the variety of attacks. Therefore, in order to guarantee the security of network system, one kind of technology that able to discover and report unauthorized or abnormal behavior was needed in the system, namely invasion detection system \(IDS\ake IDS more efficiently and more fully and improve the efficiency and accuracy of intrusion detection, the data mining technology was introduced II I NTRUSION DETECTION TECHNOLOGY INTRODUCTION Intrusion detection technology was divided into two categories A Misuse Detection Misuse Detection: Misuse Detection identify illegal invasion by the known attack methods and system vulnerabilities.. The main disadvantages of the methods is because all known intrusion model have been implanted in the system, once any form of unknown intrusion appear, it cannot be detected. But detection efficiency of this method is high B Anomaly Detection Anomaly Detection: Anomaly detection identify illegal invasion or authority exceeding by checking whether the current user behavior has been deviated from normal behavior profile established. The advantage of this method is no needing on understanding the defect of system, good adaptability. But the possibility of error is high The user behavior of intrusion detection system was showed by data form mainly. According to different sources of data, intrusion detection system can be divided into those ___________________________________ 978-1-42446943 7 10/$26.00 ©2010 IEEE  


based on the host and those based on the network. The formerês data comes from the audit data of operating system and the latterês data comes from packets through the network. Because the user's actions were showed by data how to deal with the collected data correctly and effectively and draw conclusions are the core of problem III THE DATA MINING TECHNOLOGY A Data mining Data Mining is to extract knowledge interested by people from large database or data warehouse, the knowledge is implied, unknown and potentially useful information Extracted knowledge is represented as concept, rule, law and model. The purpose of data mining is to help the decision-maker to find potential association between data found neglected elements which are perhaps very useful for trends and decision-making behavior B Common data mining method and technology a\ Correlation Analysis: correlation analysis was also called association rules, it is to find item set model knowledge frequently appeared from given data set, the purpose is to excavation the relationship that was hidden in data, for example, the customers that buy computer will buy some software, this is an association rules b\ Sequential patterns: it is similar with correlation analysis, the purpose is also to excavate connection that between data, however, time series analysis focused more on the relationship of data in times, for example, 80% people among printer buyer will buy printing paper after three months c\ Classification: classification is to find model or function that can describe the typical characteristics of data set, so that it can identify ownership or categories of unknown data. Typical classify models have the linear regression model, the decision tree model, the model based on rule and the neural network model d\ Clustering: Data was divided into a series of meaningful subset according to certain rules. In the same cluster, the gap between the individual is smaller, and in the different cluster, the gap is greater e\ Deviation analysis: to find abnormal data from the database f Forecast: to find law according historical data establish model, and to predict types, characteristics of the future data, etc based on the model IV INTRUSION DETECTION SYSTEM BASED ON THE DATA MINING TECHNOLOGY A Implementation process The data mining technology was used in intrusion detection system, userês behavior character was extracted and disciplinarian of intrusion behavior was summarized through the analysis for the historical data. Complete rules database established was used in intrusion detection. This process mainly divided into the following steps  Data of test system that data collection based on network comes from network, the tools can be used have TCPDUMP etc  Accuracy of that userês characteristics was extracted and rules was deduced was affected directly by quality of training data of data preprocessing in data mining, if behavior of intrusion was included in data that be used to establish model where in intrusion system, then, latter detection system was established can not make any behavior for this intrusion behavior, so causing omission. Therefore , data that be used train must not contain any intrusion, and was formatted into the form that could be dealt with by data mining algorithm  Data mining is the character or rules of user behavior was extracted from data was preteatmented following to incorporate and update the rules that was gained, so the rules storeroom was established  The behavior of current user was detected by rules in rules storeroom that intrusion detection based on and different handle means was adopted according to the results of getting B Implementing case Intrusion detection system was constructed based on correlation analysis method of data mining, this system is mainly used for anomaly detection. Steps are as follows 


a  The data sources of this system is based on network userês data packet would be fetched through sniffer was emplaced in the network, then the protocol analysis method was introduced, the packet is discar ded, the only header section was saved, data that was acquired after pretreatment according to specific methods include seven fields: time source IP, the source port, purpose, the destination port connect IP of ID, connection status b Because of three times handshake process was included of the TCP connection establishment, so some connection that was established unsuccessfully was included in all training data was collected , it would produce negative impact for the process of data mining later, so should be removed, and only save those of data that can reflect normal network. There is not exist this problem for UDP, only each UDP packets was regarded as a connection c APRIORI algorithm was used for data mining APRIORI algorithm is used in the analysis of shopping basket; it was used to find rules about that the "90% of customer when purchase goods A and also can buy goods B It was usually divided into two series: the form for output of rules is I1 & 12aI5 \(support=2%, confidence=60  d  Before the network traffic data that was collected was formated the input formats of APRIORI algorithm, with connection ID instead of customer ID , other attributes alternative goods purchased.  After be given support and confidence, can get a set of rules: 192.168.0.50 202.117.80.8 a80 \(support=6 confidence 95  Meaning of rules is that IP of the source and destination is respectively 192.168.0.50 and 202.117.80.8 port of purpose is 80, support of the rules is 6% and credibility is 95 e Sampling of a period could not completely user behavior, so multiple sampling and repeat the process is necessary, then the merger method was used to incorporated rules set of many times get up until no longer generate new rules. The method was used and can extract more than 100 rules \(support 2%, credibility and found 85 percent\rom the data of network flow \(28.8M\,but many of them was found meaningless obviously, it needs administrator to streamline through personal experience, finally get the rules that can be used to test. So far, the rules generated can describe fully behavior of users. The rules were used for intrusion detection. For example, one rule of the rule is 192.168.0.50 202.117.80.8 a80 \(support=6 confidence 95  in the process of test found source IP address connection in network data is 192.168.0.50 and purpose IP address is 202.117.80.8, access ports is 1000, this was explained violation of the rules of low probability events occurred suspicious degree of the connection is increase. In the actual process, abnormal connection from the same IP address may violate many rules, when the number of suspicious degrees more than a threshold the alarm is produced by system Two groups of data were discussed for the system. One group is normal data that be known does not contain any attack \(50M ,approximately 40 million record\his data was used for training system, and the introduced method above was adopted, in the confidence of setting that support is1 and credibility is 85% , the 17 inspection rules were got Then the rules was used to detect another group data known containing attacks \(5 4M, including 63 million records\the experimental results showed that the method can effectively detect PROBING attack V CONCLUSION With the rapid growth of the network bandwidth, means of hacker attacks have become increasingly diverse, existing intrusion detection system the reaction slower and less real time when network was intrusion. Therefore, how to instantly process the mass data in network and timely discover attack will become the next studying focus of intrusion detection system. The data mining technology was applied to the intrusion detection system, analysis based on historical data, the behavior of users was extracted, and the rule of intrusions behavior was summarized, more comprehensive knowledge base was established to intrusion detection. Experiments have proved that new attack type was detected effectively by intrusion detection system that data was data mining through APRIORI arithmetic knowledge base was updated automatically, reliability of created rules is more high, so the efficiency and accuracy of the intrusion detection system was improved, and security of the network was enhanced 


R EFERENCE  Denning D E   An intrusion detection m odel IEEE T r an s on  Software Engineering ,1987 ,13 \(2\2 - 232 doi:10.1109/TSE.1987.232894  Lane T and Brodl ey  C E An Application of Machine Lear n i n g to  Anomaly Detection,é USA :Pur due Universit y ,1997  Hoang Xuan Dau ,Hu Ji anku n and Bertok P  A M u lti - la y e r  Model  for Anomaly Intrusion Detection Using Program Sequencesof System Calls,é Australia :RMIT Universit y ,2001  B a laj inath B and R a ghav an S V, çIntru s i on  D e tec tion through  learning behavior model,é Computer communications ,2001 ,24 8\ :1202 - 1212. doi:10.1016/S0140-3664\(00\364-9  L e e W and Stol fo S J D ata M i ning Approaches f o r Intru sion Detection,é USA :Columbia Universit y ,1999 


 usually called large k itemset L k,m be the m th of the set consisting of large k itemsets L k,m  i  i th item of the m th element of large k-itemset X be the number of elements that X includes X.Set be the set of all items composing the itemset X  X.Se be the i th item of itemset X in which i 0  X  SupTidSet be the i th Tid number of itemset X s support Tid set X.sup be the supports of itemset X namely the number of elements belonging to X.SupSet  X.Tid be the Tid number which records X in database X.Level  be the level number, namely X  X.NearOffspring be the proper sub frequency set nodes queue of X  Theory 1  X is any a k itemset and Y, Z are two different itemsets. If Y,Z X Y Z there are Y Z=X  X.SupTidSet  Y.SupTidSet  Z.SupTidSet  Theory 2 If the frequency sets in k 1 level are in ascending order, all the items included by the every frequency set will also be in ascending order. When the frequency itemsets in k level are found, we use dual cycle to matching mine the two itemsets in k 1 level from small to large. The generated items included by the frequency sets sort ascending and then the large itemset L k in k level will sort ascending Theory 3 For nonempty itemset X and Y the number of both X.set and Y.set s items is m and X Y  X.Set   X.Set    X.Set  m  Y.Set 1  Y.Set 2 Y.Set  m  If the sam e  ite m   is deleted from \(or inserted into X and Y simultaneously obtaining X and Y the size relationship of X and Y  is the same as the size relationship of X and Y  4.2 Data structure The core data structure of the algorithm is a multi dimensional list. The vertical list stores the frequency set nodes. Each node includes X.Set X.SupTidSet X.Sup X.Level X.NearOffspring The horizontal list consists of queues pointed by each frequency set nodeís NearOffspring each node of which store a pointer pointing to a proper sub frequency set node of X.Set These pointers re-point to frequency set in the vertical list and the node store three fields Rules-Route Off-Set and Con-Set  Rules-Route is a path pointer, generating rule s. When mining rules, we depend on breadth-first search to expand the queue to deduce all the rules Off-Set stores extra items that proper sub frequency set Y is bigger than current frequency set X  Con-Set stores ruleís consequent of association rules, namely the conclusion part. The major structure of the list is shown in Figure 2 Where L 1,1 L 1,2 L 1,m L 2,1 L 2,2 L 2,n L 3,1 L 3 represents respectively frequency set node from each level, composing vertical queue X  expresses the pointer pointing to node X    Figure 2. The Structure of Multi Dimensional List The feature of data structure is that each frequency set node is adjacent to its proper sub frequency itemset sequence, and through the widely used list operation, breadth-first sear ch, we can conveniently get all the child frequency set of any a frequency set As breadth-first search is used, the obtained child frequency set sequence has been arranged as from low to high level, of which we can make use to increase the efficiency of algorithm in the course of algorithm design 4.3 Algorithm description Let Tid number of a record in database be unique in the whole database and the records in database sort ascending as Tid In this condition, the algorithm EARS can be parted into three steps Step1 By scanning database once, it generates all the order frequency set L 1 and X.SupTidSet and X.Sup  are recorded. If we set minsup to 0.5, the process of L 1 s generation is shown as table 1 and table 2  Step 2 By multiple cycles based on L 1 it generates all the large itemset L k in level k k 2     


 Table 1  Database Table Tid Items 001 a c d 002 b c e 003  a b c e 004 b e Table 2. The List Structure After  Big Itemset of Level L 1 Is Obtained  X  X  L 1  X.Sup X.SupTidSet a} 2 001 003 b 3 002 003 004 c 3 001 002 003 e 3 002 003 004 In this process, it matching mine two large itemsets in k-1 level from small to large via dual cycles. For any two frequency sets L k-1,m and L k-1,n  m<n  k-1 if the conditions are satisfied that L k-1,m 1 L k-1,n 1 L k-1,m   L k-1,n 2 L k-1,m k-2 L k-1,n kL k-1,m k L k-1,n k-1 X.Set=L k-1 m.Set  L k-1 n.Set  is respectively a k itemset According to theory 1, there is X.SupTidSet L k-1,m SupTidSet L k-1,n SupTidSet  If X.Sup minsup D in which X.Sup belongs to k itemset X  X is frequency set in level k otherwise X is a weak itemset  We can use theory 2 to accelerate dual cycle scanning for this process For any a frequency in level k, it can be obtained by matching the least two frequency sets in level k 1 consisting of k 1 elements from L k,x namely L k-1,m  L k-1,1 L k-1,2  L k-1,k-3 L k-1,k-2 and L k-1,n  L k-1,1 L k-1,2  L k-1,k-3 L k-1,k-1  When deducing frequen cy set in level k if the first k 2 items of L k-1, m and L k-1,n are different, the smaller frequency neednít to match the following other frequency sets, in other words, the inner cycle can be stopped. After deducing a frequency set L k,x by using L k-1,m and L k-1,n  m<n  L k,x is added into the vertical list and the support set and support number of L k,x are written into corresponding domain. The pointer node pointing to L k,x is added into the proper sub nodes sequences pointed by respective NearOffspring of frequency L k-1,m and L k-1,n  and the item obtained from L k,x L k-1,m  is recorded into the off-set domain of proper sub node newly added into L k-1,m meanwhile, the item obtained from L k,x L k-1,n  is recorded into the off-set domain of proper sub node newly added into L k-1,n It searches the frequency sets which also regard L k,x as its proper sub frequency set in the frequency sets sequence at level k-1 after L k-1,n Table 3 describes the storage structure of mu ltiple list generated by example1 through step2  Table 3. The Storage Structure of Ultiple List Generated By Example  L X. Sup X. SupTidSet X. NearOffspring a 2 001 003 a c b 3 002 003 004 b c b e c 3 001 002 003 a c b c  c e e 3 002 003 004 b e  c e a c 2 001 003  b c 2 002 003 b c e b e 3 002 003 004 b c e c e 2 002 003 b c e b c e 2 002 003  Step 3 By using the information of current data structure, it gets the association rules meeting the minconf. In other words, it regards any a frequency set in vertical list as the antecedent  of association rules, and then mines out the conclusion meeting minconf, namely the ruleís consequent. When frequency set X is a ruleís antecedent, first, the next pointer of each node in NearOffspring is copied into Rules-Route pointer of current node and the value of Off-Set is copied into Con-Set forming an initial Rules-Route which generates rules. Through scanning this list to get a node, the Con-Set value Y of this node is the ruleís consequent and the support of corresponding frequency set Z can be obtained from the pointer of this node, in which according to the generation process, we know that Z=X Y If confidence X Y   Z.Sup  X.Sup  minconf it is a strong rule meeting the requirement, otherwise, itís a weak rule. If confidence X Y a weak rule apparently the child nodes of Z donít combine with X to generate a strong ru le. Otherwise, the NearOffspring list of Z is scanned. If it is not null each node in the list is fetched one by one and Y is copied into the Con-Set domain of the node in the list Simultaneously, the item of Off-Set domain is inserted into Con-Set making the item of Con-Set  sort ascending to form ruleís consequent M  


 Comparing M with ruleís consequent N of the last node in Rules-Route if N  M or N  M and N  M Theory 3\node will be linked to the end of Rules-Route Scan the next node of Rules-Route and repeat the above pro cess until to the last node. When example 1 uses frequency set c as ruleís antecedent Table 4 lists the Rules-Route queue and its corresponding association rules generated by the derivations. As long as the minconf is given, it could judge which are the strong rules meeting the requirement  Table 4. The Rules-Route Queue And Its Association Rules The node point  to freq-set Off Set Con Set Sup.of freq-set Asso Rules Conf a c A a 2 c a 0. 667 b c B b 2 c b 0. 667 c e E e 2 c e 0. 667 b c e E b e 2 c b e 0. 667  5. The results and analysis of experiment   To verify the efficiency of EARSís expansion function in searching and retrieval, we test on a computer with CPU 2.4 G, Memory 2GB and Windows XP operating system. The original documents are from the TREC-7 document set downloaded from the Internet, including 23251 documents. Choosing ten thousand words as feature word, the documents are carried on the feature extraction and word frequency counting, forming word frequency matrix stored in the Oracle9i database. When minsup 0.04 minconf 0.4, the number of records in the database increases from 2,000 to 10,000 and the execute efficiency of EARS and Apriori is shown as Figure 3.From Figure 3, we can see that as records increasing, both of the runtime are prone to increase, while, from the perspective of data, the increment speed of EARSí runtime is slower than Aprioriís. In addition, the runtime of EARS is less than Aprioriís at any time                        Theoretically speaking  EARS scans the database once only when discovering the large 1-itemset in the whole process of mining, whic h solves the problem about the heavy load of I/O With the help of Tid sets recorded in the memory the algorithm doesnít generate candidate large itemset C k  The advantage of using the data structure multiple dimensional po inters, is that when generating association rules, the expenditure of matching time is decreased as much as possible by making the best use of previous work  The design of the algorithm makes use of the ordered data structure and set operations Therefore, the execute efficiency of EARS is improved effectively 6. Conclusion In the current developing process of network search engine technology, how to using web data mining technology is a ke y point. In the research process of the web search engine technology, this paper analyses in depth on the query expansion technology based on the association rules. We propose an association rul es mining algorithm EARS based on multiple dimensional list. The results of experiment indicate that the efficiency of EARS is higher than Aprioriís and the runtime of EARS varies within a small range, namely having a good flexibility. It thus is concluded that EARS is an effective and scalable association rules algorithm which can be widely used to query expansion in web information retrieval  


 7. Reference    Fetzer C,Hagstedt, K,Felb er P  Autom atic Deteciton  and Masking of Non-Atomic Exception Handling International Conference On Dependable Systems and Networks, \(DSN2003\10-116    Y e n S J, Lee Y S. ìMining Interesting  Associatio n  R u l es  and Sequential Patternsî. International Journal of Fuzzy Systems, 2004-6 \(4   Alasf f ar A  H, Deogun J S. ìConcept-b a sed Retr iev a l with Minimal Term Setsî. Foundations of Intelligent Systems: 11th Intíl Symposium, Springer, Poland, 2004 114- 122   Qiu Y ong gang,Frei H P  Concept B a sed Quer y   SIGIRí03,2003:16 0-169   Saltom G  W ong A, Y a ng C  S. ìA V ector Sp ace Model for Automation Indexingî. Communications of the ACM 2005, 18\(5\-620   Agrawal R, Srikant R. ìFast Algorithm f or Mining Association Rules in Large Databases.î Proceedings of the 20th International Conference on Very Large DataBases Santiago , Chile , 2004   Park J S. ìUsing A Hash-Based Method with Transaction Trimming forMining Association Rules.î IEEE Transactions on Knowledge and Data Engineering, 2007   Savasere A, Omiecinski E Navathe S  An Ef ficient Algorithm for Mining Association Rules in Large Databases.î Proceedings of the 21st International Conference on Very large Database, Switzerland, 2002  


              


   


                        





