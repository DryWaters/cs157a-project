Comparing Frequent Patterns A Study Case of Apriori and Singleton Implementations in a Diabetes Type 2 Data Set Purnomo Husnul Khotimah 1  Masatoshi Yoshikawa 1  Akihiro Hamasaki 2  Osamu Sugiyama 3  Kazuya Okamoto 3  and Tomohiro Kuroda 3 1 Graduate School of Informatics Kyoto University Japan 2 Center for Diabetes  Endocrinology Kitano Hospital Japan 3 Div of Medical IT  Admin Plan Kyoto University Hospital Japan Email 1  hkhotimah  db.soc.i.kyoto-u.ac.jp,informatika.lipi.go.id   yoshikawa@i.kyoto-u.ac.jp Email 2  hamasaki@kuhp.kyoto-u.ac.jp Email 3   sugiyama kazuya tomo  kuhp.kyoto-u.ac.jp Abstract Frequent sequential pattern FSP mining has become an effective tool to explore the pattern sequence occurrences in many elds The methods developed in FSP is mainly based on Apriori algorithm This algorithm looks for frequent sequence of itemset which need not to be consecutive In addition the itemset that supports the cardinality of a frequent sequence can be a partial itemset However in the case of medication for diabetes type 2 the selection of patient medication is considered essential A combination of medications represents the clinical conditions of the patients Therefore we considered a medication combination as one full item sets i.e singleton We are interested in the transition events from one medication episode to the next As such we consider consecutive sequence of singleton This paper studies the result characteristic of Apriori-based FSP and singleton mining The result of this study shows that the singleton mining results set is the subset of Apriori-based algorithm with 0.203 of ratio value However Apriori-based algorithm results set contains frequent sequence pattern of medication transition event which is unlikely to happen in real clinical conditions with high frequency By contrast the singleton mining results set represents the true medication transition event Keywords frequent sequence pattern rank based similarity measure multitherapy diabetes type 2 medical history I I NTRODUCTION Frequent sequential pattern FSP mining was developed for application to solve the market basket that is to study customer behavior FSP mining utilizes a sequence database of customer transactions to look for the maximal sequence of itemset patterns that have a support value greater than a threshold value deìned by the user The support value is counted based on the occurrences of the pattern in the sequence database The maximal sequence pattern is the sequence that is not contained in other super sequential patterns FSP approach is a practical method of nding frequent sequence event and has been applied many elds For example in the medical eld in the area of postcare report an application regarding patients in the follow-up of liver transplantation reports a study on the ICU patients to detect recent events and in the eld of pharmacovigilance  presents an in v estigation of adv erse drug reaction using FSP mining And recently in the area of chronic diseases such as diabetes type 2 the FSP approach is also used to mine electronic medical records EMR Diabetes type 2 is a typical chronic disease associated with its high numbers of risk factors and parameters that affect the therapy FSP mining enable user to yield new insights from existing therapy data regarding the medication trend or guideline adherence In ne w clinical condition of diabetes type 2 patients were found compared to the medical guidelines and uses FSP mining to predict the next prescribed medicine in monotherapeutically medicated diabetes type 2 patients Our interest is in observing the medication transition events to learn about physicianês strategy in managing the illness Current method demonstrate FSP mining on monotherapy  whereas in reality  p hysician s prescriptions may v ary from monotherapy to multitherapy Furthermore in the case of diabetes the selection of pharmacotherapy is considered essential The appropriate combination of medications should be selected in accordance with the patient conditions Thus using Apriori as it is may result in patterns that do not represent the actual medications This is because Aprioribased FSP mining nds frequent sequence of items set that can be a partial item sets In addition Apriori-based algorithm considers sequences that may not occur consecutively By contrast we consider the consecutive order of the sequence In order to solve the type of problem considered here we introduced singleton mining in The dif ference between singleton mining and Apriori-based FSP mining is as shown as follows In Apriori algorithm the sequence of  1  6  is contained in  1  3  3  5  3  6   whereas in singleton mining it is not considered as an instance of sequence In this paper we present a comparative study between singleton mining and Apriori-based FSP mining to investigate the pattern results produced by both methods in order to survey the characteristic of both methods results The 2016 International Conference on Computer Control Informatics and its Applications 978-1-5090-2323-3/16/$31.00 c  2016 IEEE 163 


structure of the rest of the paper consists of as follows  In Section II we introduce the theoretical background including that on diabetes medication episode reconstruction frequent sequence mining and singleton mining Section III provides an explanation of the methods used used to compare both mining result Then we will discuss the result in Section IV and nally we conclude the results in section V II T HEORY B ACKGROUND A Diabetes Diabetes is a progressive chronic diseases It may lead to increases in risk factors for other conditions such as heart disease amputation and kidney failure The treatment is patient centered and span the patientêS life time The disease must be managed through comprehensive longitudinal medical care In treating diabetes patients a physician considers the patient condition when prescribing medication Thus for one patient a physician may recommend only a change of lifestyle whereas for others the physician may recommend pharmachotherapy Such pharmacotherapy also varies taking the form of either monotherapy or multitherapy Prescriptions also may differ from one physician to the other For example one physician may consider a patient as slim so the physician prescribes medicine with certain dosage But other physician may feel the same patient as a little bit fatty so he may prescribe medicine with different dosage Hence different combinations of diabetes medication represent different patient conditions Although prescription practices for diabetes medication seems to be varied greatly medical societies published medical guidelines as standard recommendation for treating diabetes Based on these medical guidelines the recommended therapy is begin with diet therapy and monotherapy and then proceed to dual therapy triple therapy a combination therapy with injection drugs or switching to insulin therapy In a sense a patientês sequence of medications reîects the phases of that patientês conditions Thus both medications and their sequence are relevant to diabetes treatment B Medication Episode Reconstruction In order to give an illustration of the data set in this section we brieîy explain the process of reconstructing medication episodes from prescription data A Prescription P  pid s e m  d  is a tuple of pid patient id s starting time e end time m  array of medicine label and d  array of medicine dosages w.r.t the medicine label Table I shows the prescription data set for the physicianês prescription for a patient with pid 7 from January 2014 until December 2015 Figure 1 illustrates the prescription diagram for Table I Figure 1\(a displays the prescription durations and medicine labels In Figure 1\(a we can see that a prescription can have a short duration due to regulation and that it occasionally overlaps another or has a gap This happens because a patient may come earlier or later than the physician appointment time We also observe is that some prescriptions are simply continuations of the previous medication TABLE I P RESCRIPTION DATA SET FOR A PATIENT WITH PID 7  P n pid s e m d P 1 7 2014-01-01 2014-01-13 A d a P 2 7 2014-01-14 2014-02-02 A d a P 3 7 2014-02-01 2014-02-12 B d b P 4 7 2014-02-14 2014-03-14 A,B d a d b P 5 7 2014-03-22 2014-05-30 A,B d a d b P 6 7 2014-05-31 2014-07-15 A,B d a d b P 7 7 2014-09-01 2014-12-14 A,B d a d b P 8 7 2014-12-15 2015-03-04 A,B d a d b P 9 7 2015-03-01 2015-04-15 B d b P 10 7 2015-04-16 2015-05-30 C d c P 11 7 2015-05-07 2015-08-02 C d c P 12 7 2015-08-01 2015-10-14 C d c P 13 7 2015-10-15 2015-12-31 C d c To reconstruct a continuous medication episodes such as those shown in Figure 1\(b we identify the near prescriptions and concatenate near prescriptions which have the combination of medications to assemble a medication episode The term near is used in the sense of  P i 1 s  P i e    Here  is the notion of the time error margin which was introduced by and used by 10 in temporal pattern mining to relax the left side of Allenês temporal sho wn in Figure 2 We use these temporal relations to determine the prescription relations which later used for assigning the reconstruction rules The complete rules of reconstruction have been reported in Example 1 Using P 2  P 3  P 4  and P 5 of Table II and   7 days we have two prescription relations as follows  P 3 s P 2 e   P 1 meets P 2 P 7 s P 6 e   P 6 bef ore P 7 For an  value of 14 days we identify six medication episodes after prescriptions reconstruction as shown in Figure 1\(b Afterward a minimum period is used to distinguish the medication episode types and identify stable period as shown in Figure 1\(c The minimum period is chosen based on the recommendation given in the medical guideline which state a physician must wait some amount of time to observe the effectiveness of a given medication Figure 1\(b illustrates the use of a minimum period of 3 months as the threshold value for a medication episode to be regarded as a stable period An unstable period corresponds to short medication changes that may occur when the physician tried to adjust the medication or because of hospitalization Thus to nd the effective medication pattern in the long term we consider stable periods to be essential for further analysis Deìnition 1 Medication Episode ME is a concatenation of meets prescriptions that have the same medicine label and dosage ME shows the period of time when the physician does not change the prescription An ME data set is a sequence of ME s  ME 1 ME 2 ME m   where ME s are ordered by starting time Example 2 From Table II P 1 meets P 2 and P 1 m   P 2 m  and P 1 d   P 2 d   ME 1  hence the concatenation of P 1 and P 2 makes an ME  164 


Fig 1 Physicianês prescription diagram as shown in Table I Fig 2 Allenês left-side temporal relation using epsilon Deìnition 2 Threshold  is the minimum period in days for the physician to view the medication as effective Deìnition 3 Medication Episodes can be classiìed into Stable Period SP and Trial/Short Period TP according to their duration An ME is an SP if ME.e  ME.s    and is a TP otherwise Unstable period UP is a single TP or an aggregation of consecutive TPs The data set of SP of an ME data set is the subset of the ME data set comprising of all MEs which are SPs Deìnition 4 Blank period BP is a period of time when there was no medication recorded in the medical history more than  days C Frequent Sequential Pattern Mining A sequential pattern is a set of itemsets that is structured in a sequence database which occurs sequentially with a speciìc order A sequence database is a set of ordered elements or events stored either with or without a concrete notion of time Each itemset contains a set of items associated the same transaction time One example of such pattern as described in can be found in a video rental transactions Customers may typically rent Iron Man followed by Iron Man 2 and then Iron Man 3 The sequence of the rentals need not be consecutive and partial itemset also support the sequential pattern An itemset is denoted by i 1 i 2  i n   where i is an item and n is the number of items A sequence of  x 1 x 2  x i  is contained in other sequence  y 1 y 2  y j  if there exists integers i 1 i 2    i n such that x 1  y i 1 x 2  y i 2  x n  y i n 1 Example 3 The sequence  3,4  3  1,4  is contained in  3,4  3,5  1,3,5  1,4  1,4,6   because  3,4   3,4    3  3,5  and  1,4  1,4   However the sequence  1  4  is not contained in  1  4   Apriori principle is that if a sequence is frequent then the itemsets which constructed it must be also frequent An itemset is considered frequent if it has a support value equal or greater than the minimum support value that is previously deìned Using the Apriori principle itemsets that are not frequent and their super sequences will be pruned An implementation of Apriori algorithm is SPADE Sequential Pattern Discovery using Equivalence classes SPADE transforms the horizontal database i.e conventional database based on the user id which consists of tuples of user id transaction time and set of items into a vertical database i.e database consist with tuples of item id user id and transaction times This strategy proposed by makes sequential pattern mining more efìcient The current version of SPADE is cSPADE which is available in R in arulessequences D Singleton Mining Pattern Model As stated in the previous section we are interested in investigating the transition events between stable periods Stable periods represent medications that have proven effective for the patientês conditions We deìne a medication pattern as a repeated consecutive of medication found in the SP sequence data set We consider two types of medication patterns as follows  1 A singleton pattern is the pattern of a single SP The singleton pattern may be stated based on the medicine name medicine type or medicine label In the case of diabetes it may take the form of monotherapy dual therapy triple therapy or more 2 n sequence pattern is a sequence pattern consisting n 1 consecutive singletons The support of the pattern is calculated as the ratio of number of patients who exhibit the pattern at least once in their longitudinal medical history to the total number of patients Sup  T heraphy    patient  with therapy     patient   Example 4 Table II presents the medication type transitions of the stable periods from six patients medical record The number inside the bracket denote the medicine type and the arrow represents the transition For example the patient with pid 1 has medication transition from dual therapy with medicine types 1 and 3 to dual therapy with medicine types 3 and 5 and then followed by the subsequent transition to dual therapy with medicines types 3 and 6 Hence from Table IV with a minimum support value of 0.2 we can nd four singleton pattern as follows  1    1  4    3  5    1  4  6   The 1-sequence patterns are as follows   1  1  4   and  1  4  1  4  6   165 


TABLE II M EDICATION TYPE TRANSITIONS OF SIX PATIENTS  pid medType Transition 1  1,3  3,5  3,6  2  3,4  3,5  1,3,5  1,4  1,4,6  3  1  1,4  1,4,6  4  1  5  5  4,5  4  6  1  1,4  1,3,4  1,3,4,6  TABLE III M EDICATION TYPES No Medication Type 1 Sulfonylurea SU 2 Rapid-acting insulin secretagogues RaIS 3  Glucosidase inhibitors 4 Biguanides 5 Thiazolidinediones 6 DPP-4 inhibitors This pattern deìnition is different from that used to generate Apriori-based FSP results In Apriori it considers that the occurrences of a subset of the singleton support the frequent sequence and the even though the sequence does not in a consecutive manner it will add the cardinality of the pattern Example 5 For the data in Table II and a minimum support value of 0.2 Apriori-based FSP mining will indicate  4  6  as a frequent pattern with support value of 0.5 and  1  4   1  4  6  as another frequent pattern with a support value of 0.5 By contrast when singleton mining is applied  4  6  is not considered as a frequent pattern because it is not a full itemset where as for  1  4  1  4  6  pattern the calculated support value is only 0.33 because the patient with pid 6 is not counted as supporting the pattern support III M ETHOD A Data set We used a stable-period data set of 53,444 records originating from prescription data for 2,816 diabetes type 2 patients provided by Kyoto University Hospital The data set contains information about the pid start time end time and the combination of medication types The medication types are listed in Table III based on B Setting We conducted an experiment of nding frequent sequence patterns out of the data set using cSPADE R-arulessequences which is the implementation of Apriori-based FSP mining and our own method of singleton mining Afterward we inspected the result and compared the patterns set The comparison was performed by measuring the similarity score Figure 3 summarizes the experimental setting C Similarity Measurement A common similarity function is proposed to compute the ratio between the number of rules from one rule set that occur Fig 3 Experiment Setting in another rule set Suppose that there are tw o rule sets R 1  r 1 r 2   r i and R 2  r 1 r 2   r j  where i and j repectively are the number of rules in the two rule sets The overlapping of rules between sets is a basic measure to investigate the common properties of rule sets The overlapping ratio as similarity function between a pair of rule sets is typically deìned as Overlap  R 1 R 2   R 1 012 R 2    R 1  R 2  15 However this similarity function is not appropriate for measuring the similarity between the mining results of the methods considered here Since the Apriori algorithm does not require consecutive order of sequence or full itemset the results of cSPADE  FP cspade  will be a superset of the singleton mining results  FP singleton  Moreover because FP singleton  FP cspade  the overlap score between FP singleton and FP cspade will be Overlap  FP singleton FP cspade    FP singleton    FP singleton  FP cspade   Hence the overlap score will always be the ratio of FP singleton and FP cspade  We obtain value of 0.203 for the ratio value of FP singleton and FP cspade  A different similarity measure can be calculated using the Kendal rank correlation coefìcient commonly referred to as Kendallês Tau coefìcient This quantity is a statistic used to measure rank correlation i.e the similarity of the orderings of the data when ranked by each of two K endall s Tau represents the difference between the probability that the observed data will appear in the same order versus the probability that the observed data will not appear in the same order The equation of Kendallês Tau is the ratio between of the difference and the sum of the numbers of the concordant pairs and the discordant pairs   C  D    C  D   A concordant pair is when the rank of the second variable is greater that the rank of the former variable As a discordant pair is when the rank is equal to or less that the rank of the rst variable Because Kendallês Tau is used to measure the order similarity between two rank sets of the same data but FP singleton and FP cspade differ in numbers as FP singleton  FP cspade  there exist FP singleton  FP cspade   x  FP cspade  x  166 


Fig 4 Kendallês Tau solution FP singleton   For this case we propose an alternative solution as follows Prior to the calculating of the Kendallês Tau we prune out the result members of FP cspade that are the complement of FP singleton  such that FP  cspade  FP cspade 012 R singleton  In this way we obtain two rank sets which have the same members  FP singleton  FP  cspade  Figure 4 illustrates the pruning of FP cspade  IV D ISCUSSION In this section we do not evaluate the performances of the two methods because our interest lies in the pattern results Instead we inspect the pattern results by ranking the pattern sets based on the support value in descending order In addition our study limitation is that it is a single hospital not multi-centered study Table IV shows the top 20 results with the highest support values among the patterns identiìed by the singleton mining algorithm and the Apriori-based mining algorithm The numbers combination inside the bracket represent the medication typeês number as listed on Table III From Table IV we can observe that three patterns have the same rank such as pattern no 1,2 and 5 However the rankings of other patterns are jumbled Some patterns appear in the same order in both sets of results for example the set of  1    1  1    1,4    1,4  1,4  has the same order in both FP singleton and FP cspade  By contrast the pattern  3  comes after pattern  1,4  in FP singleton  where as in FP cspade  the ordering of these patterns is the opposite Furthermore patterns with the same base stem antecedent and consequent may have different ranks when ordered based on the base stem For example the pattern with the base stem  1,4  and consequent  1,4  is ranked rst in FP singleton but third in FP cspade after  1,4  1  and  1,4  4   We also consider the deviations in the support values as shown in Table V From Table V we observe that Aprioribased algorithm produces higher support value than singleton mining and that there are 13 patterns have support deviation  0  1 out of 20 patterns For the rank similarity analysis Kendallês Tau takes values between minus one and plus one A positive correlation signiìes that the rankings in both lists are increasing By contrast the negative correlation signiìes that as the ranking TABLE IV T OP 20 MOST FREQUENT PATTERN SETS IDENTIFIED THROUGH SINGLETON MINING AND APRIORI BASED MINING  No FP singleton FP cspade 1  1   1  2  1  1   1  1  3  1,4   6  4  1,3   4  5  3   3  6  1,4  1,4   4  4  7  4   1  6  8  1,6   3  3  9  2   6  6  10  6   1  4  11  1  1,4   1,4  12  3  3   4  1  13  1,3  1,3   1  1,4  14  1,4,6   1,6  15  4  4   1,4  1  16  1,6  1,6   1,4  4  17  1,3,4   4  1,4  18  2  2   1  1,6  19  4,6   1,4  1,4  20  1  1,6   3  1  TABLE V S UPPORT VALUE DEVIATIONS FOR THE 20 MOST FREQUENT PATTERNS IN THE SINGLETON MINING SET THAT INTERSECT A PRIORI BASED MINING SET no P attern sup cspade  sup singleton 1  1  0.220864 2  1  1  0.284434 3  1,4  0.088019 4  1,3  0.069275 5  3  0.244499 6  1,4  1,4  0.10106 7  4  0.312959 8  1,6  0.13692 9  2  0.072535 10  6  0.344744 11  1  1,4  0.167075 12  3  3  0.229829 13  1,3  1,3  0.080685 14  1,4,6  0.022819 15  4  4  0.318663 16  1,6  1,6  0.114914 17  1,3,4  0.015485 18  2  2  0.067644 19  4,6  0.123064 20  1  1,6  0.199674 in one list increases that in other list decreases The Kendallês Tau score for FP cspade and FF singleton is 0.42 which means that although FP cspade and FP singleton do have a positive correlation in both result sets the ranking increases this correlation is moderately low In addition to general characteristic of both result sets we are able to yield a nding from the medical point of view Our nding is that by inspecting Table IV the domain expert identify that the transition from medication type 1 Sulfonylurea,SU to medication type 6 DPP4i as shown in row7of FP cspade  is unlikely to happen in high frequency In the case of the characteristics of Kyoto University Hospital a 167 


physician usually used medication which is the rst medication prescribed to the patient as a basic medication And when the medication progress the physician will use the basic medication and combine it with other medication This behavior is demonstrated by FP singleton pattern in row 11   1  1,4   and row 20   1  1,6   where SU are changed into a dual therapy of  1  1   The support value of  1  6  pattern yields a high number in FP cspade set It is because Apriori algorithm permits partial itemsets and not consecutive order of sequences to support the pattern Thus the sequence  1    6  supports  1   6  pattern Considering this fact to make use of FP cspade set as it is for a suggestion application based on the support rank value may lead to biased interpretation For example in the case of pattern  1  6  in FP cspade  the user may infer that there are medication transition with high frequency from medication SU to DPP4i whereas in contrast it has much lower frequency as recorded in the patient medical history Compared to FP singleton set the support value deviation of the transition is 0.320293  sup cspade  sup singleton  V C ONCLUSION In this paper we have demonstrated that FSP mining based on the Apriori algorithm yields a superset of the results of singleton mining However the two methods rank intersection members in different order based on the support value in the case of the multitherapy of diabetes type 2 patients This nding is conìrmed by the rank based similarity score between the frequent pattern sets which is calculated using Kendallês Tau coefìcient  Kendall  sT au  FP cspade FP singleton   42  We also proposed the solution on measuring similarity order using Kendal Tau between two rules set that is originally have different numbers of rules and have the relation R 1  R 2  In the medical eld one of our nding is that Apriori produce pattern medication transition which is unusually high in frequency considering the characteristic of Kyoto University Hospital for example medication transition from SU to DPP4i Thus using Apriori mining result may leads to bias interpretation for a suggestive-type of application which leverages the support value ranking However Apriori produces a more complete medication combination possibly done by the physician For future work it is interesting to combine the singleton feature of full item set and the Apriori feature of not consecutive sequence Possible application for such method is to understand better of medication evolution patterns for example the correlation between the start medication and later medication A CKNOWLEDGMENT The rst author is supported by Indonesian Endowment Fund for Education LPDP This work was partially supported by JSPS KAKENHI Grant Number 15H02705 R EFERENCES  Agra w al Rak esh and Ramakrishnan Srikant Mining sequential patterns Data Engineering 1995 Proceedings of the Eleventh International Conference on IEEE 1995  Berlingerio Michele et al Mining clinical data with a temporal dimension a case study Bioinformatics and Biomedicine 2007 BIBM 2007 IEEE International Conference on IEEE 2007  Batal Iyad et al Mining recent temporal patterns for e v ent detection in multivariate time series data Proceedings of the 18th ACM SIGKDD international conference on Knowledge discovery and data mining ACM 2012  Huang Jingshan et al Semantics-dri v e n frequent data pattern mining on electronic health records for effective adverse drug event monitoring Bioinformatics and Biomedicine BIBM 2013 IEEE International Conference on 18 Dec 2013 608-611  T oussi Massoud et al Using data mining techniques to e xplore physicians therapeutic decisions when clinical guidelines do not provide recommendations methods and example for type 2 diabetes BMC medical informatics and decision making 9.1 2009 28  Wright Aileen P   e t al The use of sequential pattern mining to predict next prescribed medications Journal of biomedical informatics 53 2015 73-80  T reatment Guide for Diabetes 2012-2013 Japan Diabetes Society   Khotimah Purnomo Husnul et.al Re v ealing Oral Medication P atterns from Reconstructed Long-Term Medication History of Type 2 Diabetes EMBC 2016  P apapetrou P anagiotis et al Disco v ering frequent arrangements of temporal intervals Data Mining Fifth IEEE International Conference on 27 Nov 2005 8 pp  Mosk o vitch Robert and Y u v a l Shahar  Medical temporal-kno wledge discovery via temporal abstraction AMIA 2009  Allen James F  Maintaining kno wledge about temporal interv als  Communications of the ACM 26.11 1983 832-843  Slimani Thabet and Amor Lazzez Sequential Mining P atterns And Algorithms Analysis IJCER 2.5 2013 639-647  Zaki Mohammed J SP ADE An ef cient algorithm for mining frequent sequences Machine learning 42.1-2 2001 31-60  Buchta C Hahsler M Buchta MC P ackage arulesSequences 2016  Banaee Hadi and Amy Lout Data-Dri v e n Rule Mining and Representation of Temporal Patterns in Physiological Sensor Data IEEE journal of biomedical and health informatics 19.5 2015 1557-1566  Bichindaritz Isabelle and Stef ania Montani eds Case-Based Reasoning 18th International Conference ICCBR 2010 Alessandria Italy July 19-22 2010 Proceedings Vol 6176 Springer 2010  Ste v enson W  K endall-tau Statistical-Research.com 2012 September 5 Retrieved from http://statistical-research.com/wpcontent/uploads/2012/09/kendall-tau1.pdf  Nelsen R B 2001 K endall tau metric Haze wink el Michiel Enc yclopaedia of Mathematics Springer ISBN 978-1556080104  PennState Eberly Colle ge of Science Lesson18.3 Kendall Tau-b Correlation Coefìcient Retrieved from https://onlinecourses.science.psu.edu/stat509/node/158 168 


mining process The GDF algorithm still suffers the generateand-test approach to mine the MFFIs in a level-wise way When the dataset is a very dense one the designed fuzzylist structure becomes larger more memory usage is required to keep more MFFIs which can be observed in Fig 5\(a Overall the memory usage of the designed approaches have better performance than that of the GDF algorithm in most cases VI C ONCLUSION In the past a level-wise GDF algorithm was presented to mine the MFFIs which takes more computations to generateand-test candidates at each level In this paper an efìcient fuzzy-list structure is presented to keep the necessary information for mining MFFIs Two pruning strategies are also designed to reduce the search space thus speeding up computations and reducing memory usage to mine MFFIs From the conducted results it can be observed that the proposed approaches outperform the state-of-the-art GDF algorithm in terms of runtime and memory usage in both real-world and synthetic datasets A CKNOWLEDGMENTS This research was partially supported by the National Natural Science Foundation of China NSFC under grant No.61503092 by Ministry of Science and Technology Taiwan R.O.C under grant no MOST 104-2632-S-424-001 and MOST 104-2221-E-230-019 R EFERENCES  R Agra w al T  Imielinski and A Sw ami Database mining A per formance perspective IEEE Transactions on Knowledge and Data Engineering  Vol 5\(6 pp 914-925 1993  R Agra w a l and R Srikant F ast algorithms for mining association rules in large databases The International Conference on Very Large Data Bases  pp 487-499 1994  R Agra w a l and R Srikant Mining sequential patterns The International Conference on Data Engineering  pp 3-14 1995  K C C Chan and W  H Au Mining fuzzy association rules International Conference on Information and Knowledge Management  pp 209-215 1997  M S Chen J Han and P  S Y u  Data mining An o v ervie w from a database perspective IEEE Transactions on Knowledge and Data Engineering  Vol 8\(6 pp 866-883 1996  SPMF An Open-Source Data Mining Library  http://www  philippe-fournier-viger.com/spmf  J Han J Pei Y  Y in and R Mao Mining frequent patterns without candidate generation A frequent-pattern tree approach Data Mining and Knowledge Discovery  Vol 8\(1 pp 53-87 2004  T  P  Hong C S K uo and S C Chi Mining association rules from quantitative data Intelligent Data Analysis  Vol 3\(5 pp 363-376 1999  T  P  Hong C W  Lin and Y  L W u  Incrementally f ast updated frequent pattern trees Expert Systems with Applications  Vol 34\(4 pp 24242435 2008  T  P  Hong G C Lan Y  H Lin and S T  P an An ef fecti v e gradual data-reduction strategy for fuzzy itemset mining International Journal of Fuzzy Systems  Vol 15\(2 pp 170-181 2013  C M K uok A Fu and M H W ong Mining fuzzy association rules in databases ACM SIGMOD Record  Vol 27\(1 pp 41-46 1998  C W  Lin T  P  Hong and W  H Lu Linguistic data mining with fuzzy fp-trees Expert Systems with Applications  Vol 37\(6 pp 4560-4567 2010  C W  Lin T  P  Hong and T  C Lin An ef cient tree-based fuzzy data mining approach International Journal of Fuzzy Systems  Vol 12\(2 pp 150-157 2010  C W  Lin T  P  Hong and W  H Lu An ef fecti v e tree structure for mining high utility itemsets Expert Systems with Applications  Vol 38\(6 pp 7419-7424 2011  C W  Lin T  P  Hong and W  H Lu Mining fuzzy frequent itemsets based on UBFFP trees Journal of Intelligent  Fuzzy Systems  Vol 27\(1 pp 535-548 2014  L A Zadeh Fuzzy sets Information and Control  8 pp 338-353 1965 2016 IEEE International Conference on Fuzzy Systems FUZZ 2119 


115 A This work was funded by the Enterprise Ireland Innovation Partnership Programme with   upported by the N ational N atural  Science Foundation of China \(No. 61373131  PAPD and CICAEET funds References   Z. J Fu, X M. Sun, Q Liu, L. Zhou, and J G. Shu 223Achieving Efficient Cloud Search Services Multi-keyword Ranked Search over Encrypted Cloud Data Supporting Parallel Computing,\224 IEICE Transactions on Communications, vol E98-B, no. 1, pp.190-200, 2015   S. D Xie, Y X W ang 223Construction o f T r ee Net work with Limited Delivery Latency in Homogeneous Wireless Sensor Networks,\224 Wireless Personal Communications, 2014, 78\(1 3   P  Gu o  J  W a n g  B L i S Y  L ee  223 A V a r ia b le  Threshold-value Authentication Architecture for Wireless Mesh Networks,\224 Journal of Internet Technology, 2014, 15\(6 4   T H. Ma, J J Zhou, M. L. T ang, Y Tian, A. ALDHELAAN, M. AL-RODHAAN, and S. Y. LEE, \223Social network and tag sources based augmenting collaborative recommender system,\224 IEICE transactions on Information and Systems, vol E98-D, no.4, pp. 902-910, Apr. 2015   B. Gu V  S. Sheng K Y  T ay  W  R omano and S Li, \223Incremental Support Vector Learning for Ordinal Regression,\224 IEEE Transactions on Neural Networks and Learning Systems, 2014, 26\(7 1403-1416 6   Du b lin Cit y U n iv e r sit y a n d E r ic sso n  E S t r e a m  Project, 2014. http:// www.estream-project.com  quency Counts over Data Streams,\224 In: Proceedings of the 28th International Conference on Very Large Databases \(VLDB Endowment 2002 pp. 346-57, 2002   J  H. Chang and W  S Lee 224Finding R ecent Fr equent Itemsets Adaptively over Online Data Streams,\224 In: Proceedings of the ninth ACM SIGKDD international conference on Knowledge discovery and data mining \(SIGKDD 2003 487-492, 2003 9   H. F Li and H. C hen, \224Mi ni ng Non-D eri v abl e  Frequent Item Sets over Data Stream,\224 Data Knowledge Engineering, vol. 68, no. 5, May 2009, pp. 481-498 10   S. K. T anbeer C. F Ahmed, B. S. Jeong and Y   K. Lee, \224Efficient Single-Pass Frequent Pattern  es, 2008, 179\(5 and architecture was presented to support automatic network management by discovering interesting patterns from Telecom Network Monitoring data. The architecture enables discovery or interesting patterns with data from different domains related to Telecom Network Monitoring. The architecture is composed of five sub-modules: Data Analyzer, Mining Controller, Data Miner, Combiner, and Episode Analyzer. Each sub-module is described in detail along with implementation approach  functions in turn. The approach leverages and combines frequent itemset discovery over data streams, association rule learning, frequent sequential pattern mining, and frequent temporal pattern mining techniques while also making use of distributed processing platforms to achieve high-volume throughput. To test the functionality of the model, three classic pattern mining algorithms, namely, NewMoment PrefixSpan, and HTPM, are implemented Their performances are compared in terms of different parameter settings by executing the algorithms with a simulated streaming dataset Fig.10  


116 ings of Second International Conference on Data Warehousing and Knowledge Discovery Springer, London, UK, pp. 317-326, 2000 21    S. de Amo, W P. Junior and A. Giacometti, MIL PRIT*: a constraint-based algorithm for mining temporal relational patterns, International Journal of Data Warehousing and Mining, 2008 4\(4 22    S Y. Wu and Y. L. Chen, Discovering hybrid temporal patterns from sequences consisting of point- and interval-based events, Data and Knowledge Engineering, 2009, 68\(11\: 13091330 23    Y L. Chen, S. Y. Wu and Y. C. Wang, etc, Discov ering multi-label temporal patterns in sequence database, Information Sciences, 2011, 181\(3 398-418 24    Ha doop Map/Reduce tutorial, http://hadoop apache.org/docs/r1.2.1/mapred tutorial.html 25    M Zaharia and M. Chowdhury, Spark: cluster computing with working sets in cloud comput ing, In: Proceeding of HotCloud 2010, \(2010 26    C Lucchese, S. Orlando, R. Perego, Fast and memory efficient mining of frequent closed itemsets, IEEE Transactions on Knowledge and Data Engineering, 2006, 18\(1    MSCgen-Based Control Plane Trace Emulator for Communication Networks, 2014. http openmsc.blogspot.com Biographies Zhiguo Qu received his PhD in Information Security from Beijing University of Posts and Telecommunica tions, China, in 2011. From 2012 to 2014, he worked as a post-doc researcher fellow at Dublin City Univer sity in Ireland. In July 2011, he joined Nanjing Univer sity of Information and Technology in China, where he is currently a lecturer in the College of Computer and Software. His research interests include quantum secure communication, quantum information hiding  hh@126.com    ment: Maintaining Closed Frequent Itemsets over a Stream Sliding Window,\224 In: Proceedings of Data Mining \(ICDM \22204 12    H. F Li, C. C. Ho and S. Y. Lee, \224Incremental Updates of Closed Frequent Itemsets over  Applications, 2009, 36\(2 13    P T. La, B. Le and B. Vo, \224Incrementally Building   2014, 41: 2703-2712 14    S Brin, R. Motwani and C. Silverstein, Beyond  to correlations,\224 In: Proceedings of the 1997 ACM SIGMOD international conference on Management of data \(SIGMOD 1997\, New York, NY, USA, pp. 265-276, 1997 15    R Srikant, R. Agrawal, Mining sequential  improvements, In: Proceedings of the 5th In  Technology, Avignon, France, pp. 3-17, 1996    Dayal, and M.-C. Hsu. Freespan: Frequent pat tern-projected sequential pattern mining, In Proceedings of 2000 International Conference on Knowledge Discovery and Data Mining KDD00\on, MA, pp. 355-359, 2000      pattern growth, In: Proceedings of the 17th International Conference on Data Engineering Heidelberg, Germany, pp. 215-226, 2001 18    M. J Zaki, SPADE: an efficient algorithm for mining frequent sequences, Machine Learning 2001, 42\(1 19    S. Y Wu and Y. L. Chen, Mining non-ambiguous temporal patterns for interval-based events IEEE Transactions on Knowledge and Data Engi neering, 2007, 19\(6 20    P S. Kam and A. W. C. Fu, Discovering temporal patterns for interval-based events, In: Proceed  


1856 IEEE TRANSACTIONS ON INFORMATION FORENSICS AND SECURITY VOL 11 NO 8 AUGUST 2016 TABLE V E XPERIMENTAL S ETTINGS B Security Under Data Owners Attacks Attack Via Chosen Random Ingredients In our solutions data owners are not required to exchange any plaintext or ciphertext i.e encryption of their private data In addition due to the use of the underlying homomorphic encryption scheme and secure comparison scheme the exact supports and conﬁdences are concealed from any data owner However there is still a possible attack via chosen random ingredients A data owner may use ERVs random ingredients to tag some transactions and verify whether such a transaction contains a given itemset or not For example the data owner could compute an ERV with a customized random ingredient The random ingredient’s bit length is longer than any other random ingredient’s in the preprocessing stage For each received seemingly frequent itemset the data owner decrypts its ESVR and obtains the ESVR’s random ingredient If the random ingredient matches the pattern of the customized random ingredient’s most signiﬁcant bits it is an indication that the ERV with the customized random ingredient has been used to compute the ESVR Thus the data owner knows the transaction associated with the ERV contains the itemset To prevent such an attack we carefully conﬁgure the bit lengths of random ingredients An example is presented in Table V The random ingredients in  1  2  t are used to mask chosen random ingredients in ERVs Also in the preprocessing stage each data owner must verify c s  c z  c e and that ERVs are generated honestly with random ingredients of the right bit lengths In the last step of preprocessing stage the random ingredients of ERVs are veriﬁed in an aggregated manner By examining the sum of these random ingredients data owners can be assured that any chosen random ingredient will be masked C Security of Underlying Homomorphic Encryption Scheme The security of underlying homomorphic encryption scheme depends on the hardness of solving nonlinear systems In the proposed mining solutions a number of plaintexts and their corresponding ciphertexts i.e c s  c z    i  t  i  1   are disclosed to the cloud Therefore the underlying homomorphic encryption scheme should be secure under known-plaintext attacks In our homomorphic encryption scheme to encrypt a plaintext m i and obtain the corresponding ciphertext c i  we require the use of two secrets q  s and a random ingredient r i  From a known  m i  c i  pair the attacker can get a nonlinear equation of three unknowns q  s  r i  s  q  r i  m i   c i From w known pairs the attacker can generate an underdetermined nonlinear system of w equations and the number of unknowns are w  2 If the attacker can solve this system he can learn the secret key of the encryption scheme Security Can Be Achieved by Increasing Hardness of Solving Above Nonlinear System Solving underdetermined nonlinear systems is NP-hard while solving overdetermined systems can be done in polynomial time The attacker may attack a nonlinear system by guessing the values of some unknowns  i f gues s i ng t h e c orrect v a l u es i s not v e ry hard The attacker can generate many overdetermined systems from the targeted underdetermined nonlinear system by xing some unknowns 3 unknowns for the system above to all possible values These unknowns will be viewed as constants in the generated systems By solving the generated overdetermined systems the attacker nds the solution to the targeted underdetermined nonlinear system To prevent such attacks we can conﬁgure large ranges or bit lengths for q  s  r i to compound the challenges of guessing the correct values An example of the conﬁguration is presented in Table V D Security of Underlying Secure Comparison Scheme The proposed secure comparison scheme is used in our solutions to conceal the exact support values and conﬁdence values from the data owners From the correctness proof in Section IV-C we know that m i  0   q  1  2     m i  1  q       q  1  2 


LI et al  PRIVACY-PRESERVING-OUTSOURCED ASSOCIATION RULE MINING ON VERTICALLY PARTITIONED DATABASES 1857 Fig 4 Running time comparison  t  4and k  12 If  q  1  2 m could be any value in the range  0    Otherwise m couldbeanyvaluein   0   By observing   a data owner knows whether m  0 or not but m s range cannot be deduced As our design goal is to conceal exact supports it is sufﬁcient to conceal m s value in many possible values In other words we do not need a secure comparison scheme to conceal more information VII P ERFORMANCE E VA L UAT I O N In this section we evaluate the computational complexity communication complexity and storage cost of our association rule mining and frequent itemset mining solutions In the evaluation we choose one of s s o l u t i ons and c l a s s i c nonprivacy-preserving algorithms as the baseline The former is chosen because it and our solutions achieve the same privacy level In contrast other solutions achieve lower privacy levels Classic algorithms are chosen as baselines because they are the most efﬁcient known solutions A Computational Complexity 1 Comparing With Classic Algorithms We used the running time to evaluate the computational complexity To demonstrate the feasibility of our solutions we compare our solutions with classic non-privacy-preserving algorithms which are the most efﬁcient known solutions We evaluated our solutions and three classic non-privacypreserving algorithms Apriori Eclat and FP-growth using two datasets retail and pumsb from 26  T h e r e tail d a taset from Tom Brijs contains anonymous retail market basket data in a Belgian retail store while the pumsb dataset contains census data for population and housing The retail and pumsb datasets contain 88,162 and 49,046 transactions respectively To simulate t data owners we vertically partitioned each dataset into t databases randomly Our solutions are implemented in JAVA and we use a JAVA implementation  of A p ri ori  Ecl a t a nd F P gro w t h algorithms in our experiments All implementations are singlethreaded implementations To ensure a fair comparison in all experiments machines playing the roles of cloud or data owner have the same hardware and software settings The settings and the parameters of our solutions are shown in Table V The results are shown in Figs 4 5 and 6 As the running time of association rule mining is only slightly higher than Fig 5 Running time under different data owner count t  k is xed to 16 Fig 6 Running time under different k  t is xed to 2 that of frequent itemset mining only the results of association rule mining are presented We show our solutions running time at the cloud’s end i.e running time of mining and data owner owner side i.e running time of preprocessing and decrypting separately As expected our solutions are not as efﬁcient as the most efﬁcient algorithms  solutions of low privacy levels However they achieve a higher privacy level with an acceptable running time Compared with the fastest algorithm’s running time the cloud’s running time is about one order higher for most cases while data owner’s running time is very low This is the classic trade-off between privacypreserving and efﬁciency From Figs 5 and 6 we also observe that running time changes with increasing values of k and t  The cloud’s running time increases with t as d max increases with t and a larger d max results in larger ciphertext size and more computations The cloud’s running time increases with k for the retail dataset but barely changes for the pumsb dataset The increase in running time for retail dataset is due to the increase in ctitious data However the pumsb dataset is very dense and the supports are already very high without including ctitious data Thus adding more ctitious data hardly changes the number of seemingly frequent itemsets and their supports We can also observe that data owner’s running time decreases 


1858 IEEE TRANSACTIONS ON INFORMATION FORENSICS AND SECURITY VOL 11 NO 8 AUGUST 2016 TABLE VI E STIMATED R UNNING T IME OF  s S OLUTION when t increases The reason is simple If the same joint database is vertically partitioned to more data owners each data owner’s dataset is smaller Preprocessing a smaller dataset requires less time Data owner’s running time doesn’t increase with k either Such a phenomenon can also be explained using 16  s alg o r ith m f o r ad d i n g ctitio u s tr an sactions Speciﬁcally data owner’s running time is dominated by the time to run this algorithm which is hardly affected by changes in the values of k  In summary increasing t and k usually results in a higher running time at the cloud end without resulting in an increase in data owner’s running time 2 Comparing With the Solution Achieving the Same Privacy Level To the best of our knowledge the only existing privacy-preserving solution that does not leak sensitive information of the raw data is one of s frequent itemset mining solutions hereafter referred to as  s strong solution in this paper This solution cannot be used for association rule mining whilst we have solutions for both association rule mining and frequent itemset mining Similar to our solutions  s s t rong s o l u t i o n u s e s homomorphic encryption However it needs to use asymmetric homomorphic encryption scheme which is computationally expensive Reference  s s t rong s o l u t i o n r equi res a bout n  F encryptions as well as  n  T s   F homomorphic additions and scalar multiplications F is the number of frequent itemsets This solution’s running time is dominated by these expensive operations We evaluate its running time by estimating the required time to undertake the operations  see Table VI To estimate the running time we measure the speeds of two popular asymmetric additive homomorphic encryption schemes i.e Paillier Paillier and ElGamal implemented in Java and we r emark that ElGamal is the scheme suggested by T he s p eeds a re meas ured us i n g a machine of the same speciﬁcations in our evaluations see Table V and so are the datasets and parameters Compared with the result of our solution in Fig 4 the running time of  s s t rong s o l u t i o n i s s e v eral orders of magnitude B Communication Complexity and Storage Cost Similar to most other solutions our solutions require constant communication rounds In the preprocessing stage some keys and parameters are shared among t data owners These keys and parameters can be sent to data owners in parallel In the mining stage all mining results can be sent to data TABLE VII T RANSACTION C OUNT OF J OINT D ATABASE R ETAIL  TABLE VIII T RANSACTION C OUNT OF J OINT D ATABASE P UMSB  owners in a communication round Therefore the number of communication rounds does not grow if t  frequent itemsets or association rules increases The communication trafﬁc and storage cost in our solutions are dominated by the joint database size and the size of all ERVs Let n and n 012 be the transaction count of the joint database with and without ctitious transactions respectively Tables VII and VIII list the joint database size of two datasets under different settings of k and t  The joint database in our solutions contains ctitious transactions while the one in class algorithms does not We can observe from Tables VII and VII that the joint database size in our solutions is a few times larger and the size grows with k and t  The number of ERVs is at most n 012  t  O  n  t   A ciphertext’s size is O   d max   O   t  where  is the security parameter typically 80 Normally d max can be viewed as a small constant d max is not larger than 4 for most settings in the above experiments and the largest d max observed in the above experiments is 6 Let m be the average transaction size Then the communication trafﬁc and and storage cost in our solutions are both O  n  m  n    t  d max   The trafﬁc and cost in classic algorithms are O  n  m   For most reasonable transaction sizes our solutions resulted in an in communication trafﬁc and storage cost only by a few times The storage cost in  s s t rong solution is O  n  m   while the communication trafﬁc is O  T s  t  F  C  where F is the number of frequent itemsets C is the ciphertext size in 13  s str o n g so lu tio n  wh ich i s at least 2048 2048 bits In many settings our solutions trafﬁc is not any higher than the trafﬁc of s s t rong solution VIII R ELATED W ORK A Privacy-Preserving Association Rule Mining and Frequent Itemset Mining on Vertically Partitioned Databases In t h e  rs t w ork t o i dent i f y a nd addres s p ri v a c y i s s u es in vertically partitioned databases a secure scalar product protocol is presented and used to build a privacy-preserving frequent itemset mining solution Association rules can then be found given frequent itemsets and their supports Since 


LI et al  PRIVACY-PRESERVING-OUTSOURCED ASSOCIATION RULE MINING ON VERTICALLY PARTITIONED DATABASES 1859 the publication of this seminal work a number of privacypreserving association rule mining or frequent itemset mining solutions have been published in the literature see 11   1 3   28]–[31 The most relevant work is the privacy-preserving association rule mining solution presented in I n t hi s s ol ut i on a d at a owner known as the master is responsible for the mining The other data owners known as slaves insert ctitious transactions to their respectiv e datasets and send the datasets to the master Each data owner will also send his set of real transactions IDs to a semi-trusted third-party server The third-party server is assumed not to be colluding with any data owner but it cannot be trusted to hold the raw data The master generates association rule candidates from the joint database containing ctitious data For each rule candidate X  Y  the master sends the ID lists of the transactions containing X  Y and the transactions containing X to the third-party server The server veriﬁes if the rule is qualiﬁed or not Similar to our solutions a semi-trusted third-party is utilized for the mining However unlike our solutions a data owner i.e the master does the majority of the computational work Therefore we can hardly say that such a solution is an outsourced mining solution Though ctitious data are added in datasets to lower data usability the master is able to learn signiﬁcant information about other data owners raw data from the received datasets In cont rast our solutions do not leak such information as we do not rely on one particular data owner to undertake the computations and we also encrypt the datasets All existing solutions with the exception of  d o not utilize a third-party server to server to compute the mining result Some solutions  13 us e a s y mmet r i c encryption to compute the supports of itemsets while other solutions 28]–[30 us e a s ecure s cal ar product p rot o col  a s et intersection cardinality protocol or a secret sharing scheme to perform these computations A majority of these solutions expose exact supports to all data owners resulting in the leakage of information about the data owners raw data  The only exception is one of s s o l u t i ons  I n  13 t here are two privacy-preserving solutions for frequent itemset mining The rst solution exposes exact supports which is not desirable The second solution does not expose exact supports However association rules cannot be mined based on the result of second solution because conﬁdences cannot be computed without the exact supports In addition this solution’s method cannot be used to mine association rules because securely computing conﬁdence is more complicated than computing support In comparison with this solution our frequent itemset mining solution’s computational complexity is signiﬁcantly lower Our solutions do not expose exact supports or conﬁdences to data owners Different from existing solutions based on homomorphic encryption we use symmetric homomorphic encryption instead of asymmetric homomorphic encryption and the manner in which we use homomorphic encryption also differs from existing solutions In our approach we use homomorphic encryption to create ERVs and build our secure outsourced comparison scheme B Privacy-Preserving Outsour ced Association Rule Mining and Frequent Itemset Mining Privacy-preserving outsourced frequent itemset mining and association rule mining have been studied in the setting of a single data owner  19]–[21 I n e xi s t i n g s ol ut i ons  the data owner outsources thei r data and the mining task to the cloud but at the same time wish to keep the raw data secret from the cloud Generally data items in the database are encrypted using a substitution cipher prior to outsourcing Reference  propos ed a s ol ut i o n t o c ount er frequency analysis attack on substitution cipher However a later work demons t r at ed t h at 19 s s o l u t i o n i s not s ecure Giannotti et al proposed a solution based on k anonymity frequency   21 T o c ount er frequenc y a nal y s i s a t t ack the data owner inserts ctitious transactions in the encrypted database to conceal the item frequency After inserting the ctitious transactions any item in the encrypted database will share the same frequency with at least k  1 other items The data owner sends the encrypted database of both the real and ctitious transactions to the cloud The cloud runs a classic frequent itemset mining algorithm and returns the result frequent itemsets and their supports to the data owner The data owner revises these itemsets supports by subtracting them with these itemsets corresponding occurrence counts in the ctitious transactions respectively Finally the data owner decrypts the received itemsets with the revised supports higher than the frequency threshold an d generates association rules based on found frequent itemsets Our solutions use their techniques to conceal the raw data from the cloud and mitigate frequency analysis attack that can be undertaken by the cloud Using these techniques alone however is not sufﬁcient to protect data privacy in the vertically partitioned database setting To cancel out ctitious transactions both 21 an d  1 6  require the data owner to count itemset occurrences in ctitious transactions In the vertically partitioned database setting data owners are unable to perform such calculation using the techniques described in and  16 I n our s o l u t i ons  the cloud rather than the data owners cancels out ctitious transactions in a privacy-preserving manner and the underlying techniques are our homomorphic encryption secure comparison and ciphertext tag schemes Another recent work  propos ed a p ri v a c y pres e rving outsourced association rule mining solution based on predicate encryption This solution is resilient to chosen-plaintext attacks on encrypted items but it is vulnerable to frequency analysis attacks Applying this solution to vertically partitioned databases will also result in the leakage of the exact supports to data owners In this paper our adversary model is different We assume the cloud has knowledge of the item frequencies instead of chosen plaintext-ciphertext pairs and our solutions are resilient to frequency analysis attacks C Other Related Work Other than the settings of vertically partitioned databases and cloud/third-party-aided mining privacy-preserving frequent itemset mining and association rule mining have 


1860 IEEE TRANSACTIONS ON INFORMATION FORENSICS AND SECURITY VOL 11 NO 8 AUGUST 2016 been studied in the settings of horizontally partitioned databases   33]–[35 d at a publ i s hi ng 36 and d i f ferent i a l privacy  T hes e s e t t i ngs are b e yond t h e s cope of t h i s paper  IX C ONCLUDING R EMARKS In this paper we proposed a privacy-preserving outsourced frequent itemset mining solution for vertically partitioned databases This allows the data owners to outsource mining task on their joint data in a privacy-preserving manner privacypreserving manner Based on this solution we built a privacypreserving outsourced association rule partitioned databases Our solutions protect data owner’s raw data from other data owners and the cloud Our solutions also ensure the privacy of the mining results from the cloud Compared with most existing solutions our solutions leak less information about the data owners raw data Our evaluation has also demonstrated that our solutions are very efﬁci ent therefore our solutions are suitable to be used by data owners wishing to outsource their databases to the cloud but require a high level of privacy without compromising on performance To realize our solutions an efﬁcient homomorphic encryption scheme and a secure outsourced comparison scheme were presented in this paper Both schemes have potential usage in other secure computation applications such as secure data aggregation beyond the data mining solutions described in this paper Demonstrating the u tility of the p roposed homomorphic encryption scheme and outsourced comparison scheme in other settings will be the focus of future research A PPENDIX I NSERTING F ICTITIOUS T RANSACTIONS  s A LGORITHM  An algorithm to counter frequency analysis attacks on the outsourced database encrypted with a substitution cipher was proposed in F or the purpos e o f c oncealing t he item frequency this algorithm inserts ctitious transactions in the database to be oursourced The goal is to ensure that each item share the same frequency with at least k  1 items The algorithm is summarized as follows also see  Firstly the data owner scans the database to count each individual item’s support  Secondly the data owner groups items considering the supports and co-occurrence of items The data owner sorts items in decreasing order of support Starting from the rst of the sorted item list i.e the item with the highest support the data owner assigns every k adjacent items to a new created group If there are less than k unassigned items remaining these items will be assigned to the last created group The data owner swaps items from different groups to ensure that all items in the same group do not occur together in the same transaction  Thirdly for each item in each group the data owner calculates the difference between the item’s support and the highest support in the group The difference is deﬁned as the noise of the item  Fourthly to achieve k anonymity frequency the data owner generates ctitious transactions based on the result of the third step The number of an item’s occurrences in the ctitious transactions is equal to its noise calculated in the third step After inserting the ctitious transactions all items in the same group share the same support A CKNOWLEDGMENT The authors would like to thank Quach Vinh Thanh the Associate Editor and the three anonymous reviewers for providing constructive and gen erous feedback Despite their invaluable assistance any erro rs remaining in this paper are solely attributed to the authors R EFERENCES  T  B rijs  G  S winnen K V a nhoof a nd G W e ts   Us ing a s s o ciation r ules for product assortment decisions A case study in Proc SIGKDD  1999 pp 254–260  S  E  B ros s e tte A  P  S prague J  M  H ardin K B W a ites  W  T  J ones  and S A Moser Association rules and data mining in hospital infection control and public health surveillance J Amer Med Inform Assoc  vol 5 no 4 pp 373–381 1998 3 B  M obas h er  H  D ai T  L uo and M  N akaga w a E f f ecti v e p er s onalization based on association rule discovery from Web usage data in Proc WIDM  2001 pp 9–15  C  C reighton and S  H anas h Mining g ene e xpres s i on databas e s f or association rules Bioinformatics  vol 19 no 1 pp 79–86 2003 5 X  Y in and J  H an  CP A R  C las s i  cation b as ed on pr edicti v e as s o ciation rules in Proc SIAM SDM  2003 pp 1–5 6 R  A gr a w al and R  S r i kant  F a s t algor ithm s f o r m ining a s s o ciation rules in Proc VLDB  1994 pp 1–13 7 M  J  Z aki S calable algor ithm s f o r a s s o ciation m ining  IEEE Trans Knowl Data Eng  vol 12 no 3 pp 372–390 May/Jun 2000  J  H an J  P ei a nd Y  Y i n Minin g frequent patterns without candidate generation in Proc ACM SIGMOD  pp 1–12 2000 9 J  V aidya and C  C lif ton P r i v a c y pr es er ving as s o ciation r ule m ining i n vertically partitioned data in Proc SIGKDD  2002 pp 639–644  M Kantarcioglu a nd C Clifton Pri vacy-preserving distributed mining of association rules on horizontally partitioned data IEEE Trans Knowl Data Eng  vol 16 no 9 pp 1026–1037 Sep 2004  B Rozenber g and E  G udes   A s s o ciation r ules m i ning in v e rtically partitioned databases Data Knowl Eng  vol 59 no 2 pp 378–396 2006  J  Z h an S  M atwin and L  C hang Pri v a c y pres e rving c ollaborati v e association rule mining in Proc DBSEC  2005 pp 153–165  S Z hong Pri v a c y pres e rving a lgorithm s for d is trib uted m i ning of frequent itemsets Inf Sci  vol 177 no 2 pp 490–503 2007  P  P a illier  P ublick e y cr yptos ys tem s bas e d o n c om pos ite de gr ee r e s i duosity classes in Proc EUROCRYPT  1999 pp 223–238  R Cram er  R  G ennaro a nd B Schoenm ak ers   A s ecure and optim ally efﬁcient multi-authority election scheme Eur Trans Telecommun  vol 8 no 5 pp 481–490 1997  F  G i annotti L  V  S  L a ks hm anan A  M onr eale D  P e dr es chi and H Wang Privacy-preserving mining of association rules from outsourced transaction databases IEEE Syst J  vol 7 no 3 pp 385–395 Sep 2013  B Dong R L i u and H  W ang Res ult i nte g rity v e riﬁcation o f outsourced frequent itemset mining in Proc 27th Annu IFIP WG Conf Data Appl Secur Privacy DBSec  Newark NJ USA Jul 2013 pp 258–265 O A v a ilable http://dx doi o r g 10 1007/978-3-64 239256-6_17  R L i u a nd H W a ng Res ult i nte g rity v e riﬁcation o f outs ourced pri v ac ypreserving frequent itemset mining in Proc SIAM Int Conf Data Mining  Vancouver BC Canada Apr./May 2015 pp 244–252 Available http://dx.doi.org/10.1137/1.9781611974010.28  W  K W ong D W  Cheung E  Hung B Kao and N  M am oulis  Security in outsourcing of association rule mining in Proc VLDB  2007 pp 111–122  I  M o llo y  N  L i  a nd T  L i   O n the  in s ecur ity and  im  p r acticality of outsourcing precise association rule mining in Proc ICDM  Dec 2009 pp 872–877  F  G i annotti L  V  S  L a ks hm anan A  M onr eale D  P e dr es chi and W Wang Privacy-preserving data mining from outsourced databases in Proc CPDP  2011 pp 411–426 


LI et al  PRIVACY-PRESERVING-OUTSOURCED ASSOCIATION RULE MINING ON VERTICALLY PARTITIONED DATABASES 1861 22 FIPS Publication 180-1 Secure Hash Standard  Nat Inst Standards Technol Gaithersburg MD USA 1995 23 FIPS Publication 180-2 Secure Hash Standard  Nat Inst Standards Technol Gaithersburg MD USA 2002  T  E l Gam a l  A public k e y c ryptos ystem and a signature scheme based on discrete logarithms IEEE Trans Inf Theory  vol 31 no 4 pp 469–472 Jul 1985 O A v a ilable http://dx doi o r g 10 1109 TIT.1985.1057074  N  Cour tois  A  K lim o v  J  P atar in a nd A  S h am ir   E f  c ient algor ithm s for solving overdeﬁned systems of multivariate polynomial equations in Proc EUROCRYPT  2000 pp 392–407  P  F ournier V iger  Real-life Datasets in SPMF Format  accessed on Apr 6 2016 O A v a ilable http://w w w  philippe-fournier viger.com/spmf/index.php?link=datasets.php  P  F ournier V iger  A  G om ariz T  G ueniche A Soltani C  W  W u and V S Tseng SPMF A Java opensource pattern mining library J Mach.Learn.Res  vol 15 no 1 pp 3389–3393 2014  J  V a idya and C  C lif ton S ecur e s e t i nter s ection car dinality w ith application to association rule mining J Comput Secur  vol 13 no 4 pp 593–622 2005  X Ge L  Y an J  Z hu and W  S hi  Pri v ac y-pres erving dis t rib u ted association rule mining based on the secret sharing technique in Proc SEDM  Jun 2010 pp 345–350  R K h ar at M  K um bhar  and P  B ham r e E f  cient p r i v a c y pr es er ving distributed association rule mining protocol based on random number in Intelligent Computing Networking and Informatics  Raipur Chhattisgarh India Springer 2014 pp 827–836  C Dong and L  C hen  A f a s t s ecure dot product p rotocol with application to privacy preserving association rule mining in Proc 18th Paciﬁc-Asia Conf Adv Knowl Discovery Data Mining PAKDD  Tainan Taiwan May 2014 pp 606–617 Available http://dx.doi.o rg/10.1007/978-3-319-06608-0_50  J  L a i Y  L i  R  H  D eng J  W e ng C Guan a nd Q Y a n T o w ards semantically secure outsourcing of association rule mining on categorical data Inf Sci  vol 267 pp 267–286 May 2014  T  F ukas a w a  J  W ang T  T a kata a nd M  M i yazaki  A n e f f ecti v e distributed privacy-preserving data mining algorithm in Proc 5th Int Conf IDEAL  2004 pp 320–325  C Su and K  S akurai  A d is trib ut ed privacy-preserving association rules mining scheme using frequent-pattern tree in Proc ADMA  2008 pp 170–181  M  G  K a os ar  R  P aulet and X  Y i S ecur e tw opar t y a s s o ciation r ule mining in Proc ACSW-AISC  2011 pp 15–22  J  L  L in and J  Y  C L i u Pri v a c y pres erving item s et m i ning through fake transactions in Proc ACM Symp Appl Comput SAC  Seoul South Korea Mar 2007 pp 375–379 A v a ilable http://doi.acm.org/10.1145/1244002.1244092  B N K e s h a v am urthy  A M Khan a nd D T o s hniw a l Pri v a c y preserving association rule mining over distributed databases using genetic algorithm Neural Comput Appl  vol 22 no 1 pp 351–364 2013 Lichun Li received the bachelor’s degree in information engineering from the Beijing University of Posts and Telecommunications in 2002 the master’s degree in communication and information systems from the China Academy of Telecommunication Technology in 2006 and the Ph.D degree in computer science from the Beijing University of Posts and Telecommunications in 2009 He is currently a Postdoctoral Research Fellow with the INFINITUS Laboratory School of Electrical and Electronic Engineering Nanyang Technological University Singapore His research interests include privacy and security in cloud and big data Rongxing Lu S’09–M’11–SM’15 received the Ph.D degree in computer science from Shanghai Jiao Tong University Shanghai China in 2006 and the Ph.D degree in electrical and computer engineering from the University of Waterloo Waterloo ON Canada in 2012 From 2012 to 2013 he was a Postdoctoral Fellow with the University of Waterloo Since 2013 he has been an Assistant Professor with the School of Electrical and Electronic Engineering Nanyang Technological University Singapore His research interests include computer network security mobile and wireless communication security and applied cryptography He was a recipient of the Ca nada Governor General Gold Metal Kim-Kwang Raymond Choo SM’15 received the Ph.D degree in information security from the Queensland University of Technology Australia in 2006 He is currently a Cloud Technology Endowed Associate Professor with the University of Texas at San Antonio an Associate Professor with the University of South Australia and a Guest Professor with the China University of Geosciences He was named one of 10 Emerging Leaders in the Innovation category of The Weekend Australian Magazine Microsoft’s Next 100 series in 2009 and is a recipient of the ESORICS 2015 Best Research Paper Award the 2015 Winning Team of Germany’s University of Erlangen-Nuremberg Digital Forensics Research Challenge the 2014 Australia New Zealand Policing Advisory Agency’s Highly Commende d Award the 2010 Australian Capital Territory Pearcey Award the Fulbright Scholarship in 2009 the 2008 Australia Day Achievement Medallion and the British Computer Society’s Wilkes Award Anwitaman Datta is an Associate Professor with the School of Computer Science and Engineering NTU Singapore He lead s the Self and Algorithmic aspects of Networked Distributed Systems Research Group at NTU Jun Shao received the Ph.D degree from Shanghai Jiao Tong University Shanghai China in 2008 He was a Postdoctoral Fellow with the School of Information Sciences and Technology Pennsylvania State University State College PA USA from 2008 to 2010 He is currently a Full Professor with the Department of Information Security Zhejiang Gongshang University Hangzhou China His research interests include network security and applied cryptography 


